2025-06-28 07:06:20,293 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:06:20,293 - __main__ - INFO - Initializing data loader...
2025-06-28 07:06:20,293 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:06:20,293 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:06:20,325 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:06:20,379 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:06:20,379 - data.data_loader - INFO - Total files found: 84
2025-06-28 07:10:14,497 - data.data_loader - INFO - Successfully loaded 83457 samples
2025-06-28 07:10:14,510 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:10:14,561 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:10:14,586 - data.data_loader - INFO - Filtered data: 83457 -> 15054 samples
2025-06-28 07:10:14,586 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:10:17,102 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:10:18,327 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:10:18,379 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:10:32,200 - data.data_loader - INFO - Found 86 static columns
2025-06-28 07:10:32,201 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:10:32,201 - __main__ - INFO - Data info: {'total_samples': 15054, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['landfrac', 'deadstemc', 'Y_HR', 'PCT_CLAY_4', 'Y_COL_FIRE_CLOSS', 'H2OSOI_10CM', 'SCALARAVG_vr_10', 'PCT_CLAY_5', 'COL_FIRE_CLOSS', 'cwdc_vr', 'PCT_SAND_0', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_0', 'SNOWDP', 'SCALARAVG_vr_7', 'SCALARAVG_vr_6', 'NPP', 'Y_cwdc_vr', 'PCT_NAT_PFT_7', 'HR', 'Y_soil4c_vr', 'Y_AR', 'AREA', 'PCT_CLAY_6', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_15', 'SOIL_ORDER', 'PCT_SAND_3', 'PCT_CLAY_3', 'PCT_SAND_8', 'SCALARAVG_vr_8', 'LANDFRAC_PFT', 'PCT_SAND_5', 'PCT_NAT_PFT_11', 'peatf', 'SOIL_COLOR', 'PCT_SAND_1', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_5', 'PCT_CLAY_0', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_1', 'OCCLUDED_P', 'LABILE_P', 'AR', 'PCT_CLAY_8', 'SCALARAVG_vr_13', 'GPP', 'APATITE_P', 'PCT_CLAY_2', 'Y_deadstemc', 'Y_NPP', 'soil4c_vr', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_2', 'Y_tlai', 'tlai', 'Y_GPP', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_9', 'Longitude', 'PCT_SAND_6', 'PCT_SAND_4', 'SECONDARY_P', 'PCT_CLAY_9', 'abm', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_4', 'Latitude', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_3', 'PCT_CLAY_1', 'PCT_NATVEG', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_14', 'PCT_SAND_2', 'SCALARAVG_vr_5', 'PCT_SAND_9', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_3'], 'target_columns': ['Y_cwdc_vr', 'Y_AR', 'Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_soil4c_vr', 'Y_deadstemc', 'Y_NPP', 'Y_tlai'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:10:32,202 - __main__ - INFO - Normalizing data...
2025-06-28 07:10:32,202 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:10:32,203 - data.data_loader - INFO - Found 86 static columns
2025-06-28 07:10:32,203 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:10:32,203 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:10:33,009 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:10:33,047 - __main__ - ERROR - Training failed: setting an array element with a sequence.
2025-06-28 07:13:31,127 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:13:31,128 - __main__ - INFO - Initializing data loader...
2025-06-28 07:13:31,128 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:13:31,128 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:13:31,128 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:13:31,128 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:13:31,128 - data.data_loader - INFO - Total files found: 84
2025-06-28 07:15:20,503 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:15:20,503 - __main__ - INFO - Initializing data loader...
2025-06-28 07:15:20,503 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:15:20,503 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:15:20,503 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:15:20,504 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:15:20,504 - data.data_loader - INFO - Total files found: 84
2025-06-28 07:18:48,208 - data.data_loader - INFO - Successfully loaded 83457 samples
2025-06-28 07:18:48,221 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:18:48,272 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:18:48,300 - data.data_loader - INFO - Filtered data: 83457 -> 15054 samples
2025-06-28 07:18:48,300 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:18:50,739 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:18:51,969 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:18:52,014 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:19:04,440 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,443 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,448 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,453 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,458 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,461 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,465 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,470 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,471 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_7', 'PCT_NAT_PFT_4', 'PCT_SAND_8', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'Y_GPP', 'SOIL_ORDER', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_14', 'PCT_SAND_3', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_HR', 'HR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'peatf', 'PCT_NAT_PFT_12', 'AR', 'Longitude', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'SCALARAVG_vr_3', 'PCT_SAND_4', 'NPP', 'GPP', 'LABILE_P', 'PCT_CLAY_5', 'abm', 'PCT_SAND_5', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_6', 'Y_COL_FIRE_CLOSS', 'landfrac', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_10', 'OCCLUDED_P', 'AREA', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SECONDARY_P', 'APATITE_P', 'SCALARAVG_vr_6', 'PCT_SAND_2', 'SCALARAVG_vr_9', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'COL_FIRE_CLOSS', 'PCT_CLAY_9', 'PCT_CLAY_6', 'Latitude', 'Y_AR', 'Y_NPP', 'PCT_NAT_PFT_11', 'SNOWDP', 'SCALARAVG_vr_4']
2025-06-28 07:19:04,471 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:19:04,471 - __main__ - INFO - Data info: {'total_samples': 15054, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_2', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_7', 'PCT_NAT_PFT_4', 'PCT_SAND_8', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'Y_GPP', 'SOIL_ORDER', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_14', 'PCT_SAND_3', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_HR', 'HR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'peatf', 'PCT_NAT_PFT_12', 'AR', 'Longitude', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'SCALARAVG_vr_3', 'PCT_SAND_4', 'NPP', 'GPP', 'LABILE_P', 'PCT_CLAY_5', 'abm', 'PCT_SAND_5', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_6', 'Y_COL_FIRE_CLOSS', 'landfrac', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_10', 'OCCLUDED_P', 'AREA', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SECONDARY_P', 'APATITE_P', 'SCALARAVG_vr_6', 'PCT_SAND_2', 'SCALARAVG_vr_9', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'COL_FIRE_CLOSS', 'PCT_CLAY_9', 'PCT_CLAY_6', 'Latitude', 'Y_AR', 'Y_NPP', 'PCT_NAT_PFT_11', 'SNOWDP', 'SCALARAVG_vr_4'], 'target_columns': ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_tlai', 'Y_soil4c_vr', 'Y_AR', 'Y_NPP', 'Y_deadstemc', 'Y_HR', 'Y_cwdc_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:19:04,471 - __main__ - INFO - Normalizing data...
2025-06-28 07:19:04,471 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:19:04,474 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,476 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,477 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,480 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,481 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,483 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,485 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,487 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:19:04,488 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_7', 'PCT_NAT_PFT_4', 'PCT_SAND_8', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'Y_GPP', 'SOIL_ORDER', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_14', 'PCT_SAND_3', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_HR', 'HR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'peatf', 'PCT_NAT_PFT_12', 'AR', 'Longitude', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'SCALARAVG_vr_3', 'PCT_SAND_4', 'NPP', 'GPP', 'LABILE_P', 'PCT_CLAY_5', 'abm', 'PCT_SAND_5', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_6', 'Y_COL_FIRE_CLOSS', 'landfrac', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_10', 'OCCLUDED_P', 'AREA', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SECONDARY_P', 'APATITE_P', 'SCALARAVG_vr_6', 'PCT_SAND_2', 'SCALARAVG_vr_9', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'COL_FIRE_CLOSS', 'PCT_CLAY_9', 'PCT_CLAY_6', 'Latitude', 'Y_AR', 'Y_NPP', 'PCT_NAT_PFT_11', 'SNOWDP', 'SCALARAVG_vr_4']
2025-06-28 07:19:04,488 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:19:04,488 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:19:05,504 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:19:05,513 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_2', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_7', 'PCT_NAT_PFT_4', 'PCT_SAND_8', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'Y_GPP', 'SOIL_ORDER', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_14', 'PCT_SAND_3', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_HR', 'HR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'peatf', 'PCT_NAT_PFT_12', 'AR', 'Longitude', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'SCALARAVG_vr_3', 'PCT_SAND_4', 'NPP', 'GPP', 'LABILE_P', 'PCT_CLAY_5', 'abm', 'PCT_SAND_5', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_6', 'Y_COL_FIRE_CLOSS', 'landfrac', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_10', 'OCCLUDED_P', 'AREA', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SECONDARY_P', 'APATITE_P', 'SCALARAVG_vr_6', 'PCT_SAND_2', 'SCALARAVG_vr_9', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'COL_FIRE_CLOSS', 'PCT_CLAY_9', 'PCT_CLAY_6', 'Latitude', 'Y_AR', 'Y_NPP', 'PCT_NAT_PFT_11', 'SNOWDP', 'SCALARAVG_vr_4']
2025-06-28 07:19:05,626 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:19:05,646 - __main__ - ERROR - Training failed: setting an array element with a sequence.
2025-06-28 07:21:43,916 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:21:43,916 - __main__ - INFO - Initializing data loader...
2025-06-28 07:21:43,916 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:21:43,916 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:21:43,917 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:21:43,917 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:21:43,917 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:21:43,917 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:21:50,762 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:21:50,763 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:21:50,765 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:21:50,766 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:21:50,766 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:21:50,795 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:21:50,806 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:21:50,808 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:21:51,208 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,210 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,211 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,212 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,212 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,213 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,214 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,214 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,216 - data.data_loader - INFO - Found 78 static columns: ['AREA', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_SAND_9', 'PCT_CLAY_9', 'SCALARAVG_vr_8', 'SCALARAVG_vr_5', 'PCT_SAND_1', 'PCT_NAT_PFT_2', 'Longitude', 'PCT_NAT_PFT_5', 'NPP', 'PCT_NAT_PFT_11', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_CLAY_0', 'Y_HR', 'PCT_CLAY_6', 'PCT_SAND_3', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'HR', 'PCT_SAND_4', 'PCT_SAND_5', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Latitude', 'AR', 'PCT_NAT_PFT_10', 'Y_AR', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_3', 'PCT_NATVEG', 'PCT_SAND_7', 'SECONDARY_P', 'PCT_CLAY_2', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_1', 'GPP', 'OCCLUDED_P', 'LABILE_P', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'PCT_CLAY_8', 'Y_NPP', 'PCT_CLAY_5']
2025-06-28 07:21:51,216 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:21:51,216 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['AREA', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_SAND_9', 'PCT_CLAY_9', 'SCALARAVG_vr_8', 'SCALARAVG_vr_5', 'PCT_SAND_1', 'PCT_NAT_PFT_2', 'Longitude', 'PCT_NAT_PFT_5', 'NPP', 'PCT_NAT_PFT_11', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_CLAY_0', 'Y_HR', 'PCT_CLAY_6', 'PCT_SAND_3', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'HR', 'PCT_SAND_4', 'PCT_SAND_5', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Latitude', 'AR', 'PCT_NAT_PFT_10', 'Y_AR', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_3', 'PCT_NATVEG', 'PCT_SAND_7', 'SECONDARY_P', 'PCT_CLAY_2', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_1', 'GPP', 'OCCLUDED_P', 'LABILE_P', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'PCT_CLAY_8', 'Y_NPP', 'PCT_CLAY_5'], 'target_columns': ['Y_deadstemc', 'Y_soil4c_vr', 'Y_tlai', 'Y_AR', 'Y_cwdc_vr', 'Y_NPP', 'Y_HR', 'Y_GPP', 'Y_COL_FIRE_CLOSS'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:21:51,216 - __main__ - INFO - Normalizing data...
2025-06-28 07:21:51,216 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:21:51,217 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,218 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,220 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,220 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,220 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,221 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,222 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,222 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:21:51,223 - data.data_loader - INFO - Found 78 static columns: ['AREA', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_SAND_9', 'PCT_CLAY_9', 'SCALARAVG_vr_8', 'SCALARAVG_vr_5', 'PCT_SAND_1', 'PCT_NAT_PFT_2', 'Longitude', 'PCT_NAT_PFT_5', 'NPP', 'PCT_NAT_PFT_11', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_CLAY_0', 'Y_HR', 'PCT_CLAY_6', 'PCT_SAND_3', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'HR', 'PCT_SAND_4', 'PCT_SAND_5', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Latitude', 'AR', 'PCT_NAT_PFT_10', 'Y_AR', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_3', 'PCT_NATVEG', 'PCT_SAND_7', 'SECONDARY_P', 'PCT_CLAY_2', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_1', 'GPP', 'OCCLUDED_P', 'LABILE_P', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'PCT_CLAY_8', 'Y_NPP', 'PCT_CLAY_5']
2025-06-28 07:21:51,223 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:21:51,223 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:21:51,253 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:21:51,259 - data.data_loader - INFO - Normalizing 78 static columns: ['AREA', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_SAND_9', 'PCT_CLAY_9', 'SCALARAVG_vr_8', 'SCALARAVG_vr_5', 'PCT_SAND_1', 'PCT_NAT_PFT_2', 'Longitude', 'PCT_NAT_PFT_5', 'NPP', 'PCT_NAT_PFT_11', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_CLAY_0', 'Y_HR', 'PCT_CLAY_6', 'PCT_SAND_3', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'HR', 'PCT_SAND_4', 'PCT_SAND_5', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Latitude', 'AR', 'PCT_NAT_PFT_10', 'Y_AR', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_3', 'PCT_NATVEG', 'PCT_SAND_7', 'SECONDARY_P', 'PCT_CLAY_2', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_1', 'GPP', 'OCCLUDED_P', 'LABILE_P', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'PCT_CLAY_8', 'Y_NPP', 'PCT_CLAY_5']
2025-06-28 07:21:51,260 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:21:51,261 - __main__ - ERROR - Training failed: setting an array element with a sequence.
2025-06-28 07:26:12,131 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:26:12,131 - __main__ - INFO - Initializing data loader...
2025-06-28 07:26:12,131 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:26:12,131 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:26:12,132 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:26:12,132 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:26:12,132 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:26:12,132 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:26:19,466 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:26:19,467 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:26:19,469 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:26:19,471 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:26:19,471 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:26:19,498 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:26:19,510 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:26:19,511 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:26:19,936 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,937 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,937 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,938 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,940 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,940 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,941 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,942 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,943 - data.data_loader - INFO - Found 78 static columns: ['LANDFRAC_PFT', 'PCT_SAND_1', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_6', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'AR', 'PCT_CLAY_1', 'PCT_CLAY_7', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NAT_PFT_12', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'PCT_CLAY_2', 'GPP', 'Latitude', 'PCT_CLAY_4', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'Y_AR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_CLAY_9', 'SOIL_COLOR', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'LABILE_P', 'Y_HR', 'SCALARAVG_vr_10', 'SCALARAVG_vr_14', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'PCT_CLAY_8', 'Y_NPP', 'Longitude', 'H2OSOI_10CM', 'PCT_CLAY_5', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'AREA', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'peatf', 'PCT_SAND_9', 'SECONDARY_P', 'PCT_SAND_6', 'PCT_SAND_3', 'NPP', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_9', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_2', 'SOIL_ORDER', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'abm', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'HR']
2025-06-28 07:26:19,943 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:26:19,943 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['LANDFRAC_PFT', 'PCT_SAND_1', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_6', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'AR', 'PCT_CLAY_1', 'PCT_CLAY_7', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NAT_PFT_12', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'PCT_CLAY_2', 'GPP', 'Latitude', 'PCT_CLAY_4', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'Y_AR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_CLAY_9', 'SOIL_COLOR', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'LABILE_P', 'Y_HR', 'SCALARAVG_vr_10', 'SCALARAVG_vr_14', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'PCT_CLAY_8', 'Y_NPP', 'Longitude', 'H2OSOI_10CM', 'PCT_CLAY_5', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'AREA', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'peatf', 'PCT_SAND_9', 'SECONDARY_P', 'PCT_SAND_6', 'PCT_SAND_3', 'NPP', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_9', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_2', 'SOIL_ORDER', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'abm', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'HR'], 'target_columns': ['Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_cwdc_vr', 'Y_soil4c_vr', 'Y_AR', 'Y_HR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:26:19,945 - __main__ - INFO - Normalizing data...
2025-06-28 07:26:19,945 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:26:19,946 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,947 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,947 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,948 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,949 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,949 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,950 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,951 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:26:19,952 - data.data_loader - INFO - Found 78 static columns: ['LANDFRAC_PFT', 'PCT_SAND_1', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_6', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'AR', 'PCT_CLAY_1', 'PCT_CLAY_7', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NAT_PFT_12', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'PCT_CLAY_2', 'GPP', 'Latitude', 'PCT_CLAY_4', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'Y_AR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_CLAY_9', 'SOIL_COLOR', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'LABILE_P', 'Y_HR', 'SCALARAVG_vr_10', 'SCALARAVG_vr_14', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'PCT_CLAY_8', 'Y_NPP', 'Longitude', 'H2OSOI_10CM', 'PCT_CLAY_5', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'AREA', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'peatf', 'PCT_SAND_9', 'SECONDARY_P', 'PCT_SAND_6', 'PCT_SAND_3', 'NPP', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_9', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_2', 'SOIL_ORDER', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'abm', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'HR']
2025-06-28 07:26:19,952 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:26:19,952 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:26:19,988 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:26:19,995 - data.data_loader - INFO - Normalizing 78 static columns: ['LANDFRAC_PFT', 'PCT_SAND_1', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_6', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'AR', 'PCT_CLAY_1', 'PCT_CLAY_7', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NAT_PFT_12', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'PCT_CLAY_2', 'GPP', 'Latitude', 'PCT_CLAY_4', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'Y_AR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_13', 'PCT_CLAY_9', 'SOIL_COLOR', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'LABILE_P', 'Y_HR', 'SCALARAVG_vr_10', 'SCALARAVG_vr_14', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'PCT_CLAY_8', 'Y_NPP', 'Longitude', 'H2OSOI_10CM', 'PCT_CLAY_5', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'AREA', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'peatf', 'PCT_SAND_9', 'SECONDARY_P', 'PCT_SAND_6', 'PCT_SAND_3', 'NPP', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_9', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_2', 'SOIL_ORDER', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'abm', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'HR']
2025-06-28 07:26:19,999 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:26:19,999 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:26:19,999 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:26:20,000 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:26:20,000 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:26:20,000 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_HR', 'Y_NPP']
2025-06-28 07:26:20,001 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:26:20,003 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:26:20,004 - __main__ - INFO - Splitting data...
2025-06-28 07:26:20,004 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:26:20,066 - __main__ - INFO - Creating model...
2025-06-28 07:26:20,066 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180
2025-06-28 07:26:20,116 - models.combined_model - INFO - Model initialized with 342924 parameters
2025-06-28 07:26:20,116 - __main__ - INFO - Initializing trainer...
2025-06-28 07:26:24,027 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:26:24,027 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:26:24,027 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:26:24,427 - training.trainer - ERROR - Training pipeline failed: mat1 and mat2 shapes cannot be multiplied (4x32 and 16x16)
2025-06-28 07:26:24,428 - __main__ - ERROR - Training failed: mat1 and mat2 shapes cannot be multiplied (4x32 and 16x16)
2025-06-28 07:31:47,118 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:31:47,119 - __main__ - INFO - Initializing data loader...
2025-06-28 07:31:47,119 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:31:47,119 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:31:47,119 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:31:47,119 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:31:47,119 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:31:47,120 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:31:54,060 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:31:54,061 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:31:54,062 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:31:54,064 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:31:54,064 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:31:54,092 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:31:54,104 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:31:54,106 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:31:54,439 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,439 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,441 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,441 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,443 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,444 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,446 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,446 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,451 - data.data_loader - INFO - Found 78 static columns: ['SOIL_COLOR', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'abm', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_13', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'OCCLUDED_P', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_14', 'GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'Y_NPP', 'SCALARAVG_vr_7', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'LABILE_P', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_2', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'landfrac', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_7', 'PCT_CLAY_9', 'AREA', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'peatf', 'PCT_SAND_3', 'AR', 'SECONDARY_P', 'SNOWDP', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'HR', 'PCT_NAT_PFT_6', 'PCT_CLAY_3', 'SCALARAVG_vr_13', 'PCT_CLAY_2', 'Latitude', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_CLAY_5', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'Y_GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_16', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'NPP', 'Longitude', 'H2OSOI_10CM']
2025-06-28 07:31:54,451 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:31:54,451 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SOIL_COLOR', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'abm', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_13', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'OCCLUDED_P', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_14', 'GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'Y_NPP', 'SCALARAVG_vr_7', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'LABILE_P', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_2', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'landfrac', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_7', 'PCT_CLAY_9', 'AREA', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'peatf', 'PCT_SAND_3', 'AR', 'SECONDARY_P', 'SNOWDP', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'HR', 'PCT_NAT_PFT_6', 'PCT_CLAY_3', 'SCALARAVG_vr_13', 'PCT_CLAY_2', 'Latitude', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_CLAY_5', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'Y_GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_16', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'NPP', 'Longitude', 'H2OSOI_10CM'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_HR', 'Y_deadstemc', 'Y_GPP', 'Y_soil4c_vr', 'Y_tlai', 'Y_cwdc_vr', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:31:54,451 - __main__ - INFO - Normalizing data...
2025-06-28 07:31:54,451 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:31:54,452 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,452 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,453 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,454 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,455 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,456 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,457 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,459 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:31:54,460 - data.data_loader - INFO - Found 78 static columns: ['SOIL_COLOR', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'abm', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_13', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'OCCLUDED_P', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_14', 'GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'Y_NPP', 'SCALARAVG_vr_7', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'LABILE_P', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_2', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'landfrac', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_7', 'PCT_CLAY_9', 'AREA', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'peatf', 'PCT_SAND_3', 'AR', 'SECONDARY_P', 'SNOWDP', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'HR', 'PCT_NAT_PFT_6', 'PCT_CLAY_3', 'SCALARAVG_vr_13', 'PCT_CLAY_2', 'Latitude', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_CLAY_5', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'Y_GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_16', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'NPP', 'Longitude', 'H2OSOI_10CM']
2025-06-28 07:31:54,460 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:31:54,460 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:31:54,490 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:31:54,497 - data.data_loader - INFO - Normalizing 78 static columns: ['SOIL_COLOR', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'abm', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_13', 'PCT_SAND_5', 'SCALARAVG_vr_8', 'OCCLUDED_P', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_14', 'GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'Y_NPP', 'SCALARAVG_vr_7', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_4', 'LABILE_P', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_2', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'landfrac', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_7', 'PCT_CLAY_9', 'AREA', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'peatf', 'PCT_SAND_3', 'AR', 'SECONDARY_P', 'SNOWDP', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_12', 'HR', 'PCT_NAT_PFT_6', 'PCT_CLAY_3', 'SCALARAVG_vr_13', 'PCT_CLAY_2', 'Latitude', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_CLAY_5', 'PCT_NATVEG', 'APATITE_P', 'PCT_SAND_4', 'Y_GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_16', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'NPP', 'Longitude', 'H2OSOI_10CM']
2025-06-28 07:31:54,498 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:31:54,499 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:31:54,499 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:31:54,499 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:31:54,499 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:31:54,499 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_HR', 'Y_GPP', 'Y_AR']
2025-06-28 07:31:54,500 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:31:54,501 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:31:54,502 - __main__ - INFO - Splitting data...
2025-06-28 07:31:54,502 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:31:54,503 - __main__ - INFO - Creating model...
2025-06-28 07:31:54,503 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:31:54,503 - __main__ - INFO - Detected actual 2D channels: 18
2025-06-28 07:31:54,503 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:31:54,503 - models.combined_model - INFO - Using actual 2D channels: 18
2025-06-28 07:31:54,503 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 3240 (channels: 18)
2025-06-28 07:31:54,503 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:31:54,503 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:31:54,503 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:31:54,519 - models.combined_model - INFO - Model initialized with 347820 parameters
2025-06-28 07:31:54,519 - __main__ - INFO - Initializing trainer...
2025-06-28 07:31:56,337 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:31:56,338 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:31:56,338 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:31:56,439 - training.trainer - ERROR - Training pipeline failed: mat1 and mat2 shapes cannot be multiplied (4x32 and 16x16)
2025-06-28 07:31:56,439 - __main__ - ERROR - Training failed: mat1 and mat2 shapes cannot be multiplied (4x32 and 16x16)
2025-06-28 07:32:36,786 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:32:36,786 - __main__ - INFO - Initializing data loader...
2025-06-28 07:32:36,786 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:32:36,786 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:32:36,787 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:32:36,787 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:32:36,787 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:32:36,787 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:32:44,638 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:32:44,639 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:32:44,641 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:32:44,643 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:32:44,643 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:32:44,673 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:32:44,685 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:32:44,687 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:32:45,103 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,105 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,105 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,106 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,106 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,108 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,108 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,111 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,111 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_7', 'PCT_NAT_PFT_15', 'Y_HR', 'Latitude', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'AREA', 'Y_AR', 'PCT_NAT_PFT_1', 'AR', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'abm', 'GPP', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_CLAY_6', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'PCT_SAND_0', 'NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_CLAY_9', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'SCALARAVG_vr_9', 'Longitude', 'SCALARAVG_vr_8', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_SAND_4', 'SCALARAVG_vr_13', 'PCT_NATVEG', 'APATITE_P', 'PCT_CLAY_4', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_9', 'OCCLUDED_P', 'PCT_CLAY_8', 'HR', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_CLAY_2', 'landfrac']
2025-06-28 07:32:45,112 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:32:45,112 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_7', 'PCT_NAT_PFT_15', 'Y_HR', 'Latitude', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'AREA', 'Y_AR', 'PCT_NAT_PFT_1', 'AR', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'abm', 'GPP', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_CLAY_6', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'PCT_SAND_0', 'NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_CLAY_9', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'SCALARAVG_vr_9', 'Longitude', 'SCALARAVG_vr_8', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_SAND_4', 'SCALARAVG_vr_13', 'PCT_NATVEG', 'APATITE_P', 'PCT_CLAY_4', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_9', 'OCCLUDED_P', 'PCT_CLAY_8', 'HR', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_CLAY_2', 'landfrac'], 'target_columns': ['Y_cwdc_vr', 'Y_COL_FIRE_CLOSS', 'Y_deadstemc', 'Y_HR', 'Y_AR', 'Y_tlai', 'Y_soil4c_vr', 'Y_GPP', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:32:45,112 - __main__ - INFO - Normalizing data...
2025-06-28 07:32:45,112 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:32:45,112 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,114 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,114 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,114 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,115 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,116 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,116 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,118 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:32:45,119 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_7', 'PCT_NAT_PFT_15', 'Y_HR', 'Latitude', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'AREA', 'Y_AR', 'PCT_NAT_PFT_1', 'AR', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'abm', 'GPP', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_CLAY_6', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'PCT_SAND_0', 'NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_CLAY_9', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'SCALARAVG_vr_9', 'Longitude', 'SCALARAVG_vr_8', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_SAND_4', 'SCALARAVG_vr_13', 'PCT_NATVEG', 'APATITE_P', 'PCT_CLAY_4', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_9', 'OCCLUDED_P', 'PCT_CLAY_8', 'HR', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_CLAY_2', 'landfrac']
2025-06-28 07:32:45,119 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:32:45,119 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:32:45,150 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:32:45,157 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_7', 'PCT_NAT_PFT_15', 'Y_HR', 'Latitude', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'AREA', 'Y_AR', 'PCT_NAT_PFT_1', 'AR', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'abm', 'GPP', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_CLAY_6', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'PCT_SAND_0', 'NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_CLAY_9', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'PCT_SAND_7', 'SCALARAVG_vr_9', 'Longitude', 'SCALARAVG_vr_8', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_SAND_4', 'SCALARAVG_vr_13', 'PCT_NATVEG', 'APATITE_P', 'PCT_CLAY_4', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'PCT_CLAY_3', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_9', 'OCCLUDED_P', 'PCT_CLAY_8', 'HR', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_8', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_CLAY_2', 'landfrac']
2025-06-28 07:32:45,161 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:32:45,161 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:32:45,161 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:32:45,161 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:32:45,162 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:32:45,162 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_AR', 'Y_GPP', 'Y_NPP']
2025-06-28 07:32:45,163 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:32:45,164 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:32:45,165 - __main__ - INFO - Splitting data...
2025-06-28 07:32:45,165 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:32:45,165 - __main__ - INFO - Creating model...
2025-06-28 07:32:45,165 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:32:45,165 - __main__ - INFO - Detected actual 2D channels: 18
2025-06-28 07:32:45,166 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:32:45,166 - models.combined_model - INFO - Using actual 2D channels: 18
2025-06-28 07:32:45,166 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 3240 (channels: 18)
2025-06-28 07:32:45,166 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:32:45,166 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:32:45,166 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:32:45,187 - models.combined_model - INFO - Model initialized with 347820 parameters
2025-06-28 07:32:45,187 - __main__ - INFO - Initializing trainer...
2025-06-28 07:32:46,927 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:32:46,927 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:32:46,927 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:32:47,047 - training.trainer - ERROR - Training pipeline failed: Given groups=1, weight of size [32, 18, 3, 3], expected input[4, 1, 18, 10] to have 18 channels, but got 1 channels instead
2025-06-28 07:32:47,048 - __main__ - ERROR - Training failed: Given groups=1, weight of size [32, 18, 3, 3], expected input[4, 1, 18, 10] to have 18 channels, but got 1 channels instead
2025-06-28 07:34:22,493 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:34:22,493 - __main__ - INFO - Initializing data loader...
2025-06-28 07:34:22,493 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:34:22,493 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:34:22,494 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:34:22,494 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:34:22,494 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:34:22,494 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:34:30,019 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:34:30,020 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:34:30,021 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:34:30,023 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:34:30,023 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:34:30,052 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:34:30,063 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:34:30,064 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:34:30,483 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,485 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,485 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,486 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,488 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,489 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,490 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,491 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,491 - data.data_loader - INFO - Found 78 static columns: ['LABILE_P', 'SCALARAVG_vr_5', 'GPP', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_2', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'PCT_NAT_PFT_7', 'PCT_CLAY_5', 'PCT_NAT_PFT_14', 'PCT_CLAY_0', 'Y_GPP', 'peatf', 'PCT_NAT_PFT_0', 'abm', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_15', 'HR', 'PCT_SAND_6', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'SCALARAVG_vr_0', 'Longitude', 'AREA', 'PCT_NAT_PFT_3', 'PCT_SAND_8', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'SCALARAVG_vr_7', 'OCCLUDED_P', 'H2OSOI_10CM', 'Y_HR', 'PCT_NATVEG', 'PCT_CLAY_4', 'PCT_SAND_5', 'PCT_CLAY_7', 'PCT_CLAY_3', 'PCT_NAT_PFT_9', 'Latitude', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'AR', 'COL_FIRE_CLOSS', 'Y_NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'SECONDARY_P', 'APATITE_P', 'PCT_SAND_2', 'PCT_NAT_PFT_4', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'SCALARAVG_vr_8', 'SCALARAVG_vr_14', 'Y_AR', 'PCT_NAT_PFT_1', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_SAND_9', 'PCT_NAT_PFT_13', 'PCT_SAND_0', 'NPP', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'PCT_NAT_PFT_8']
2025-06-28 07:34:30,491 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:34:30,491 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['LABILE_P', 'SCALARAVG_vr_5', 'GPP', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_2', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'PCT_NAT_PFT_7', 'PCT_CLAY_5', 'PCT_NAT_PFT_14', 'PCT_CLAY_0', 'Y_GPP', 'peatf', 'PCT_NAT_PFT_0', 'abm', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_15', 'HR', 'PCT_SAND_6', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'SCALARAVG_vr_0', 'Longitude', 'AREA', 'PCT_NAT_PFT_3', 'PCT_SAND_8', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'SCALARAVG_vr_7', 'OCCLUDED_P', 'H2OSOI_10CM', 'Y_HR', 'PCT_NATVEG', 'PCT_CLAY_4', 'PCT_SAND_5', 'PCT_CLAY_7', 'PCT_CLAY_3', 'PCT_NAT_PFT_9', 'Latitude', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'AR', 'COL_FIRE_CLOSS', 'Y_NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'SECONDARY_P', 'APATITE_P', 'PCT_SAND_2', 'PCT_NAT_PFT_4', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'SCALARAVG_vr_8', 'SCALARAVG_vr_14', 'Y_AR', 'PCT_NAT_PFT_1', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_SAND_9', 'PCT_NAT_PFT_13', 'PCT_SAND_0', 'NPP', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'PCT_NAT_PFT_8'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_cwdc_vr', 'Y_tlai', 'Y_HR', 'Y_GPP', 'Y_soil4c_vr', 'Y_NPP', 'Y_AR', 'Y_deadstemc'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:34:30,491 - __main__ - INFO - Normalizing data...
2025-06-28 07:34:30,492 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:34:30,493 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,493 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,494 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,494 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,496 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,497 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,497 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,498 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:34:30,498 - data.data_loader - INFO - Found 78 static columns: ['LABILE_P', 'SCALARAVG_vr_5', 'GPP', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_2', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'PCT_NAT_PFT_7', 'PCT_CLAY_5', 'PCT_NAT_PFT_14', 'PCT_CLAY_0', 'Y_GPP', 'peatf', 'PCT_NAT_PFT_0', 'abm', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_15', 'HR', 'PCT_SAND_6', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'SCALARAVG_vr_0', 'Longitude', 'AREA', 'PCT_NAT_PFT_3', 'PCT_SAND_8', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'SCALARAVG_vr_7', 'OCCLUDED_P', 'H2OSOI_10CM', 'Y_HR', 'PCT_NATVEG', 'PCT_CLAY_4', 'PCT_SAND_5', 'PCT_CLAY_7', 'PCT_CLAY_3', 'PCT_NAT_PFT_9', 'Latitude', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'AR', 'COL_FIRE_CLOSS', 'Y_NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'SECONDARY_P', 'APATITE_P', 'PCT_SAND_2', 'PCT_NAT_PFT_4', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'SCALARAVG_vr_8', 'SCALARAVG_vr_14', 'Y_AR', 'PCT_NAT_PFT_1', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_SAND_9', 'PCT_NAT_PFT_13', 'PCT_SAND_0', 'NPP', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'PCT_NAT_PFT_8']
2025-06-28 07:34:30,498 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:34:30,499 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:34:30,528 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:34:30,539 - data.data_loader - INFO - Normalizing 78 static columns: ['LABILE_P', 'SCALARAVG_vr_5', 'GPP', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_2', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'PCT_NAT_PFT_7', 'PCT_CLAY_5', 'PCT_NAT_PFT_14', 'PCT_CLAY_0', 'Y_GPP', 'peatf', 'PCT_NAT_PFT_0', 'abm', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_15', 'HR', 'PCT_SAND_6', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'SCALARAVG_vr_0', 'Longitude', 'AREA', 'PCT_NAT_PFT_3', 'PCT_SAND_8', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'SCALARAVG_vr_7', 'OCCLUDED_P', 'H2OSOI_10CM', 'Y_HR', 'PCT_NATVEG', 'PCT_CLAY_4', 'PCT_SAND_5', 'PCT_CLAY_7', 'PCT_CLAY_3', 'PCT_NAT_PFT_9', 'Latitude', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'AR', 'COL_FIRE_CLOSS', 'Y_NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'SECONDARY_P', 'APATITE_P', 'PCT_SAND_2', 'PCT_NAT_PFT_4', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'SCALARAVG_vr_8', 'SCALARAVG_vr_14', 'Y_AR', 'PCT_NAT_PFT_1', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_SAND_9', 'PCT_NAT_PFT_13', 'PCT_SAND_0', 'NPP', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'PCT_NAT_PFT_8']
2025-06-28 07:34:30,541 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:34:30,541 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:34:30,542 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:34:30,542 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:34:30,542 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:34:30,542 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_GPP', 'Y_NPP', 'Y_AR']
2025-06-28 07:34:30,543 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:34:30,544 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:34:30,545 - __main__ - INFO - Splitting data...
2025-06-28 07:34:30,545 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:34:30,546 - __main__ - INFO - Creating model...
2025-06-28 07:34:30,546 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:34:30,546 - __main__ - INFO - Detected actual 2D channels: 2
2025-06-28 07:34:30,546 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:34:30,546 - models.combined_model - INFO - Using actual 2D channels: 2
2025-06-28 07:34:30,546 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 360 (channels: 2)
2025-06-28 07:34:30,546 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:34:30,546 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:34:30,546 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:34:30,570 - models.combined_model - INFO - Model initialized with 343212 parameters
2025-06-28 07:34:30,570 - __main__ - INFO - Initializing trainer...
2025-06-28 07:34:32,252 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:34:32,252 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:34:32,252 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:34:32,348 - training.trainer - ERROR - Training pipeline failed: Given groups=1, weight of size [32, 2, 3, 3], expected input[4, 1, 18, 10] to have 2 channels, but got 1 channels instead
2025-06-28 07:34:32,348 - __main__ - ERROR - Training failed: Given groups=1, weight of size [32, 2, 3, 3], expected input[4, 1, 18, 10] to have 2 channels, but got 1 channels instead
2025-06-28 07:36:16,196 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:36:16,196 - __main__ - INFO - Initializing data loader...
2025-06-28 07:36:16,196 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:36:16,196 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:36:16,197 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:36:16,197 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:36:16,197 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:36:16,197 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:36:24,000 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:36:24,000 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:36:24,002 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:36:24,004 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:36:24,004 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:36:24,033 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:36:24,044 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:36:24,046 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:36:24,487 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,488 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,489 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,491 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,493 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,493 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,495 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,496 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,496 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_16', 'NPP', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_15', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'HR', 'PCT_SAND_0', 'PCT_CLAY_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_SAND_1', 'Y_GPP', 'AREA', 'APATITE_P', 'PCT_CLAY_3', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'H2OSOI_10CM', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'Y_AR', 'abm', 'PCT_CLAY_8', 'AR', 'PCT_SAND_3', 'PCT_CLAY_0', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NATVEG', 'SCALARAVG_vr_12', 'PCT_SAND_4', 'Longitude', 'OCCLUDED_P', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'SNOWDP', 'peatf', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_4', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'SECONDARY_P', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SOIL_ORDER', 'GPP', 'LABILE_P', 'Latitude', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_HR', 'PCT_CLAY_5']
2025-06-28 07:36:24,496 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:36:24,496 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_16', 'NPP', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_15', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'HR', 'PCT_SAND_0', 'PCT_CLAY_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_SAND_1', 'Y_GPP', 'AREA', 'APATITE_P', 'PCT_CLAY_3', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'H2OSOI_10CM', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'Y_AR', 'abm', 'PCT_CLAY_8', 'AR', 'PCT_SAND_3', 'PCT_CLAY_0', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NATVEG', 'SCALARAVG_vr_12', 'PCT_SAND_4', 'Longitude', 'OCCLUDED_P', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'SNOWDP', 'peatf', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_4', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'SECONDARY_P', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SOIL_ORDER', 'GPP', 'LABILE_P', 'Latitude', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_HR', 'PCT_CLAY_5'], 'target_columns': ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_cwdc_vr', 'Y_NPP', 'Y_tlai', 'Y_deadstemc', 'Y_soil4c_vr', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:36:24,496 - __main__ - INFO - Normalizing data...
2025-06-28 07:36:24,496 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:36:24,497 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,497 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,498 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,499 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,501 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,501 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,502 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,503 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:36:24,503 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_16', 'NPP', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_15', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'HR', 'PCT_SAND_0', 'PCT_CLAY_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_SAND_1', 'Y_GPP', 'AREA', 'APATITE_P', 'PCT_CLAY_3', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'H2OSOI_10CM', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'Y_AR', 'abm', 'PCT_CLAY_8', 'AR', 'PCT_SAND_3', 'PCT_CLAY_0', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NATVEG', 'SCALARAVG_vr_12', 'PCT_SAND_4', 'Longitude', 'OCCLUDED_P', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'SNOWDP', 'peatf', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_4', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'SECONDARY_P', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SOIL_ORDER', 'GPP', 'LABILE_P', 'Latitude', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_HR', 'PCT_CLAY_5']
2025-06-28 07:36:24,503 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:36:24,503 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:36:24,534 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:36:24,540 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_16', 'NPP', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_15', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'HR', 'PCT_SAND_0', 'PCT_CLAY_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_SAND_1', 'Y_GPP', 'AREA', 'APATITE_P', 'PCT_CLAY_3', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'H2OSOI_10CM', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'Y_AR', 'abm', 'PCT_CLAY_8', 'AR', 'PCT_SAND_3', 'PCT_CLAY_0', 'SCALARAVG_vr_6', 'landfrac', 'PCT_NATVEG', 'SCALARAVG_vr_12', 'PCT_SAND_4', 'Longitude', 'OCCLUDED_P', 'SCALARAVG_vr_13', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'SNOWDP', 'peatf', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_4', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'SECONDARY_P', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SOIL_ORDER', 'GPP', 'LABILE_P', 'Latitude', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_HR', 'PCT_CLAY_5']
2025-06-28 07:36:24,542 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:36:24,542 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:36:24,543 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:36:24,543 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:36:24,543 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:36:24,543 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_NPP', 'Y_HR']
2025-06-28 07:36:24,544 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:36:24,546 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:36:24,547 - __main__ - INFO - Splitting data...
2025-06-28 07:36:24,547 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:36:24,547 - __main__ - INFO - Creating model...
2025-06-28 07:36:24,547 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:36:24,547 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:36:24,547 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:36:24,548 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:36:24,548 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:36:24,548 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:36:24,548 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:36:24,548 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:36:24,578 - models.combined_model - INFO - Model initialized with 342924 parameters
2025-06-28 07:36:24,578 - __main__ - INFO - Initializing trainer...
2025-06-28 07:36:26,330 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:36:26,330 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:36:26,330 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:36:27,721 - training.trainer - ERROR - Training pipeline failed: The size of tensor a (3) must match the size of tensor b (4) at non-singleton dimension 1
2025-06-28 07:36:27,721 - __main__ - ERROR - Training failed: The size of tensor a (3) must match the size of tensor b (4) at non-singleton dimension 1
2025-06-28 07:37:17,415 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:37:17,415 - __main__ - ERROR - Training failed: Unknown model config parameter: num_transformer_layers
2025-06-28 07:37:42,045 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:37:42,045 - __main__ - INFO - Initializing data loader...
2025-06-28 07:37:42,045 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:37:42,045 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:37:42,045 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:37:42,045 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:37:42,046 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:37:42,046 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:37:49,086 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:37:49,087 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:37:49,089 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:37:49,092 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:37:49,092 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:37:49,120 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:37:49,132 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:37:49,134 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:37:49,525 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,526 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,530 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,530 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,530 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,531 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,531 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,533 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,572 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_7', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_7', 'LABILE_P', 'PCT_NAT_PFT_1', 'NPP', 'PCT_SAND_5', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'Y_AR', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'H2OSOI_10CM', 'PCT_NAT_PFT_14', 'OCCLUDED_P', 'Y_NPP', 'HR', 'Longitude', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'Y_GPP', 'PCT_SAND_0', 'landfrac', 'PCT_NAT_PFT_8', 'GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_SAND_8', 'APATITE_P', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'PCT_CLAY_8', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_SAND_4', 'PCT_NATVEG', 'SCALARAVG_vr_7', 'SCALARAVG_vr_13', 'PCT_SAND_3', 'SCALARAVG_vr_14', 'PCT_SAND_9', 'peatf', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_10', 'AREA', 'PCT_NAT_PFT_11', 'PCT_CLAY_3', 'SNOWDP', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'Latitude', 'PCT_SAND_6', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_5', 'PCT_CLAY_0', 'SCALARAVG_vr_8', 'LANDFRAC_PFT', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_9', 'SOIL_ORDER', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'abm']
2025-06-28 07:37:49,572 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:37:49,572 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_7', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_7', 'LABILE_P', 'PCT_NAT_PFT_1', 'NPP', 'PCT_SAND_5', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'Y_AR', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'H2OSOI_10CM', 'PCT_NAT_PFT_14', 'OCCLUDED_P', 'Y_NPP', 'HR', 'Longitude', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'Y_GPP', 'PCT_SAND_0', 'landfrac', 'PCT_NAT_PFT_8', 'GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_SAND_8', 'APATITE_P', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'PCT_CLAY_8', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_SAND_4', 'PCT_NATVEG', 'SCALARAVG_vr_7', 'SCALARAVG_vr_13', 'PCT_SAND_3', 'SCALARAVG_vr_14', 'PCT_SAND_9', 'peatf', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_10', 'AREA', 'PCT_NAT_PFT_11', 'PCT_CLAY_3', 'SNOWDP', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'Latitude', 'PCT_SAND_6', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_5', 'PCT_CLAY_0', 'SCALARAVG_vr_8', 'LANDFRAC_PFT', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_9', 'SOIL_ORDER', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'abm'], 'target_columns': ['Y_AR', 'Y_soil4c_vr', 'Y_HR', 'Y_NPP', 'Y_GPP', 'Y_tlai', 'Y_deadstemc', 'Y_cwdc_vr', 'Y_COL_FIRE_CLOSS'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:37:49,572 - __main__ - INFO - Normalizing data...
2025-06-28 07:37:49,572 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:37:49,573 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,573 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,577 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,577 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,577 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,577 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,578 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,580 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:37:49,580 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_7', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_7', 'LABILE_P', 'PCT_NAT_PFT_1', 'NPP', 'PCT_SAND_5', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'Y_AR', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'H2OSOI_10CM', 'PCT_NAT_PFT_14', 'OCCLUDED_P', 'Y_NPP', 'HR', 'Longitude', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'Y_GPP', 'PCT_SAND_0', 'landfrac', 'PCT_NAT_PFT_8', 'GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_SAND_8', 'APATITE_P', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'PCT_CLAY_8', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_SAND_4', 'PCT_NATVEG', 'SCALARAVG_vr_7', 'SCALARAVG_vr_13', 'PCT_SAND_3', 'SCALARAVG_vr_14', 'PCT_SAND_9', 'peatf', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_10', 'AREA', 'PCT_NAT_PFT_11', 'PCT_CLAY_3', 'SNOWDP', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'Latitude', 'PCT_SAND_6', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_5', 'PCT_CLAY_0', 'SCALARAVG_vr_8', 'LANDFRAC_PFT', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_9', 'SOIL_ORDER', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'abm']
2025-06-28 07:37:49,580 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:37:49,580 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:37:49,617 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:37:49,623 - data.data_loader - INFO - Normalizing 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_7', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_7', 'LABILE_P', 'PCT_NAT_PFT_1', 'NPP', 'PCT_SAND_5', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'Y_AR', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'H2OSOI_10CM', 'PCT_NAT_PFT_14', 'OCCLUDED_P', 'Y_NPP', 'HR', 'Longitude', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'Y_GPP', 'PCT_SAND_0', 'landfrac', 'PCT_NAT_PFT_8', 'GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'PCT_SAND_8', 'APATITE_P', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'PCT_CLAY_8', 'SOIL_COLOR', 'SCALARAVG_vr_11', 'PCT_SAND_4', 'PCT_NATVEG', 'SCALARAVG_vr_7', 'SCALARAVG_vr_13', 'PCT_SAND_3', 'SCALARAVG_vr_14', 'PCT_SAND_9', 'peatf', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_10', 'AREA', 'PCT_NAT_PFT_11', 'PCT_CLAY_3', 'SNOWDP', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'Latitude', 'PCT_SAND_6', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_5', 'PCT_CLAY_0', 'SCALARAVG_vr_8', 'LANDFRAC_PFT', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_9', 'SOIL_ORDER', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'abm']
2025-06-28 07:37:49,625 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:37:49,625 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:37:49,626 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:37:49,626 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:37:49,626 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:37:49,626 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_HR', 'Y_NPP', 'Y_GPP', 'Y_COL_FIRE_CLOSS']
2025-06-28 07:37:49,627 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:37:49,629 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:37:49,630 - __main__ - INFO - Splitting data...
2025-06-28 07:37:49,630 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:37:49,631 - __main__ - INFO - Creating model...
2025-06-28 07:37:49,631 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:37:49,631 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:37:49,631 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:37:49,631 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:37:49,631 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:37:49,631 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:37:49,631 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:37:49,631 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:37:49,643 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:37:49,643 - __main__ - INFO - Initializing trainer...
2025-06-28 07:37:51,404 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:37:51,404 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:37:51,404 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:37:53,208 - training.trainer - ERROR - Training pipeline failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:37:53,208 - __main__ - ERROR - Training failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:38:51,922 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:38:51,922 - __main__ - INFO - Initializing data loader...
2025-06-28 07:38:51,922 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:38:51,922 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:38:51,922 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:38:51,923 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:38:51,923 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:38:51,923 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:38:59,047 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:38:59,047 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:38:59,049 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:38:59,051 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:38:59,051 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:38:59,078 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:38:59,089 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:38:59,091 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:38:59,472 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,473 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,474 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,476 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,476 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,478 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,479 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,480 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,480 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_3', 'AR', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'peatf', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'Y_NPP', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'GPP', 'PCT_NAT_PFT_8', 'OCCLUDED_P', 'LANDFRAC_PFT', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_4', 'PCT_CLAY_5', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_4', 'PCT_SAND_0', 'Longitude', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'Y_HR', 'SCALARAVG_vr_2', 'PCT_CLAY_6', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_3', 'SNOWDP', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_CLAY_1', 'PCT_CLAY_9', 'PCT_SAND_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'abm', 'Latitude', 'HR', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_6', 'COL_FIRE_CLOSS', 'PCT_SAND_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_0', 'Y_GPP', 'SCALARAVG_vr_6', 'SOIL_ORDER', 'PCT_NATVEG', 'AREA', 'NPP', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_5']
2025-06-28 07:38:59,480 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:38:59,480 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_3', 'AR', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'peatf', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'Y_NPP', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'GPP', 'PCT_NAT_PFT_8', 'OCCLUDED_P', 'LANDFRAC_PFT', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_4', 'PCT_CLAY_5', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_4', 'PCT_SAND_0', 'Longitude', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'Y_HR', 'SCALARAVG_vr_2', 'PCT_CLAY_6', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_3', 'SNOWDP', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_CLAY_1', 'PCT_CLAY_9', 'PCT_SAND_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'abm', 'Latitude', 'HR', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_6', 'COL_FIRE_CLOSS', 'PCT_SAND_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_0', 'Y_GPP', 'SCALARAVG_vr_6', 'SOIL_ORDER', 'PCT_NATVEG', 'AREA', 'NPP', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_5'], 'target_columns': ['Y_HR', 'Y_GPP', 'Y_cwdc_vr', 'Y_tlai', 'Y_NPP', 'Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_deadstemc', 'Y_soil4c_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS']}
2025-06-28 07:38:59,482 - __main__ - INFO - Normalizing data...
2025-06-28 07:38:59,482 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:38:59,483 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,483 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,484 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,486 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,486 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,487 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,488 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,488 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:38:59,489 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_3', 'AR', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'peatf', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'Y_NPP', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'GPP', 'PCT_NAT_PFT_8', 'OCCLUDED_P', 'LANDFRAC_PFT', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_4', 'PCT_CLAY_5', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_4', 'PCT_SAND_0', 'Longitude', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'Y_HR', 'SCALARAVG_vr_2', 'PCT_CLAY_6', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_3', 'SNOWDP', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_CLAY_1', 'PCT_CLAY_9', 'PCT_SAND_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'abm', 'Latitude', 'HR', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_6', 'COL_FIRE_CLOSS', 'PCT_SAND_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_0', 'Y_GPP', 'SCALARAVG_vr_6', 'SOIL_ORDER', 'PCT_NATVEG', 'AREA', 'NPP', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_5']
2025-06-28 07:38:59,489 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:38:59,489 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:38:59,519 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:38:59,525 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_3', 'AR', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'peatf', 'PCT_NAT_PFT_12', 'H2OSOI_10CM', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'Y_NPP', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'PCT_SAND_1', 'GPP', 'PCT_NAT_PFT_8', 'OCCLUDED_P', 'LANDFRAC_PFT', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_4', 'PCT_CLAY_5', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'SCALARAVG_vr_1', 'PCT_CLAY_2', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_4', 'PCT_SAND_0', 'Longitude', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'Y_HR', 'SCALARAVG_vr_2', 'PCT_CLAY_6', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_3', 'SNOWDP', 'LABILE_P', 'PCT_NAT_PFT_2', 'PCT_CLAY_1', 'PCT_CLAY_9', 'PCT_SAND_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'abm', 'Latitude', 'HR', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_6', 'COL_FIRE_CLOSS', 'PCT_SAND_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_0', 'Y_GPP', 'SCALARAVG_vr_6', 'SOIL_ORDER', 'PCT_NATVEG', 'AREA', 'NPP', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_5']
2025-06-28 07:38:59,527 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:38:59,527 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:38:59,527 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:38:59,528 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:38:59,528 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:38:59,528 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_GPP', 'Y_NPP', 'Y_AR', 'Y_COL_FIRE_CLOSS']
2025-06-28 07:38:59,529 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:38:59,530 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:38:59,531 - __main__ - INFO - Splitting data...
2025-06-28 07:38:59,531 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:38:59,531 - __main__ - INFO - Creating model...
2025-06-28 07:38:59,532 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:38:59,532 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:38:59,532 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:38:59,532 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:38:59,532 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:38:59,532 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:38:59,532 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:38:59,532 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:38:59,564 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:38:59,564 - __main__ - INFO - Initializing trainer...
2025-06-28 07:39:01,311 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:39:01,311 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:39:01,311 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:39:01,991 - training.trainer - ERROR - Training pipeline failed: 'matrix_rows'
2025-06-28 07:39:01,991 - __main__ - ERROR - Training failed: 'matrix_rows'
2025-06-28 07:40:43,846 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:40:43,846 - __main__ - INFO - Initializing data loader...
2025-06-28 07:40:43,846 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:40:43,846 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:40:43,846 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:40:43,847 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:40:43,847 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:40:43,847 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:40:50,672 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:40:50,673 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:40:50,675 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:40:50,677 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:40:50,677 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:40:50,705 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:40:50,716 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:40:50,717 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:40:51,057 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,058 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,061 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,061 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,061 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,062 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,064 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,064 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,065 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_10', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_1', 'HR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'PCT_CLAY_5', 'PCT_NAT_PFT_10', 'Y_GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'PCT_SAND_3', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_13', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SCALARAVG_vr_8', 'abm', 'NPP', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'AREA', 'landfrac', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_1', 'PCT_CLAY_9', 'Y_AR', 'SCALARAVG_vr_14', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_15', 'AR', 'GPP', 'PCT_SAND_2', 'Y_NPP', 'PCT_NATVEG', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_6', 'PCT_SAND_1', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'SOIL_COLOR', 'APATITE_P', 'SCALARAVG_vr_13', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_SAND_4', 'SCALARAVG_vr_12', 'Longitude', 'SECONDARY_P', 'SCALARAVG_vr_7', 'PCT_SAND_0', 'PCT_SAND_6']
2025-06-28 07:40:51,065 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:40:51,065 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_10', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_1', 'HR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'PCT_CLAY_5', 'PCT_NAT_PFT_10', 'Y_GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'PCT_SAND_3', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_13', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SCALARAVG_vr_8', 'abm', 'NPP', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'AREA', 'landfrac', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_1', 'PCT_CLAY_9', 'Y_AR', 'SCALARAVG_vr_14', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_15', 'AR', 'GPP', 'PCT_SAND_2', 'Y_NPP', 'PCT_NATVEG', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_6', 'PCT_SAND_1', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'SOIL_COLOR', 'APATITE_P', 'SCALARAVG_vr_13', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_SAND_4', 'SCALARAVG_vr_12', 'Longitude', 'SECONDARY_P', 'SCALARAVG_vr_7', 'PCT_SAND_0', 'PCT_SAND_6'], 'target_columns': ['Y_GPP', 'Y_cwdc_vr', 'Y_AR', 'Y_deadstemc', 'Y_HR', 'Y_tlai', 'Y_COL_FIRE_CLOSS', 'Y_soil4c_vr', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:40:51,065 - __main__ - INFO - Normalizing data...
2025-06-28 07:40:51,065 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:40:51,066 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,067 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,069 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,069 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,069 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,070 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,071 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,072 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:40:51,073 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_10', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_1', 'HR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'PCT_CLAY_5', 'PCT_NAT_PFT_10', 'Y_GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'PCT_SAND_3', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_13', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SCALARAVG_vr_8', 'abm', 'NPP', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'AREA', 'landfrac', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_1', 'PCT_CLAY_9', 'Y_AR', 'SCALARAVG_vr_14', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_15', 'AR', 'GPP', 'PCT_SAND_2', 'Y_NPP', 'PCT_NATVEG', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_6', 'PCT_SAND_1', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'SOIL_COLOR', 'APATITE_P', 'SCALARAVG_vr_13', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_SAND_4', 'SCALARAVG_vr_12', 'Longitude', 'SECONDARY_P', 'SCALARAVG_vr_7', 'PCT_SAND_0', 'PCT_SAND_6']
2025-06-28 07:40:51,073 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:40:51,073 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:40:51,103 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:40:51,109 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_4', 'SOIL_ORDER', 'SCALARAVG_vr_10', 'LANDFRAC_PFT', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_1', 'HR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'PCT_CLAY_5', 'PCT_NAT_PFT_10', 'Y_GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'PCT_SAND_3', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_13', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SCALARAVG_vr_8', 'abm', 'NPP', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'AREA', 'landfrac', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_1', 'PCT_CLAY_9', 'Y_AR', 'SCALARAVG_vr_14', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_SAND_9', 'PCT_SAND_7', 'PCT_NAT_PFT_15', 'AR', 'GPP', 'PCT_SAND_2', 'Y_NPP', 'PCT_NATVEG', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_6', 'PCT_SAND_1', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'SOIL_COLOR', 'APATITE_P', 'SCALARAVG_vr_13', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_SAND_4', 'SCALARAVG_vr_12', 'Longitude', 'SECONDARY_P', 'SCALARAVG_vr_7', 'PCT_SAND_0', 'PCT_SAND_6']
2025-06-28 07:40:51,110 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:40:51,111 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:40:51,111 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:40:51,111 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:40:51,111 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:40:51,111 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_AR', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_NPP']
2025-06-28 07:40:51,112 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:40:51,114 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:40:51,115 - __main__ - INFO - Splitting data...
2025-06-28 07:40:51,115 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:40:51,115 - __main__ - INFO - Creating model...
2025-06-28 07:40:51,115 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:40:51,115 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:40:51,115 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:40:51,116 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:40:51,116 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:40:51,116 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:40:51,116 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:40:51,116 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:40:51,125 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:40:51,125 - __main__ - INFO - Initializing trainer...
2025-06-28 07:40:52,799 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:40:52,799 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:40:52,799 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:40:53,471 - training.trainer - ERROR - Training pipeline failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:40:53,471 - __main__ - ERROR - Training failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:41:56,019 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:41:56,019 - __main__ - INFO - Initializing data loader...
2025-06-28 07:41:56,020 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:41:56,020 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:41:56,020 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:41:56,020 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:41:56,020 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:41:56,020 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:42:03,013 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:42:03,013 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:42:03,015 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:42:03,017 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:42:03,017 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:42:03,045 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:42:03,056 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:42:03,058 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:42:03,407 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,408 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,409 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,411 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,411 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,413 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,413 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,414 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,416 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_5', 'PCT_CLAY_3', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'LABILE_P', 'PCT_NAT_PFT_7', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_9', 'PCT_SAND_3', 'GPP', 'Y_NPP', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_CLAY_8', 'Latitude', 'Y_HR', 'abm', 'peatf', 'SECONDARY_P', 'Y_GPP', 'PCT_SAND_0', 'PCT_CLAY_1', 'landfrac', 'PCT_SAND_9', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_2', 'PCT_NAT_PFT_12', 'AR', 'LANDFRAC_PFT', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_CLAY_0', 'SOIL_ORDER', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'PCT_SAND_8', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'H2OSOI_10CM', 'PCT_SAND_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'SNOWDP', 'PCT_CLAY_7', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'Longitude', 'APATITE_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_8', 'HR', 'Y_AR', 'PCT_SAND_1']
2025-06-28 07:42:03,416 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:42:03,416 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_5', 'PCT_CLAY_3', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'LABILE_P', 'PCT_NAT_PFT_7', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_9', 'PCT_SAND_3', 'GPP', 'Y_NPP', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_CLAY_8', 'Latitude', 'Y_HR', 'abm', 'peatf', 'SECONDARY_P', 'Y_GPP', 'PCT_SAND_0', 'PCT_CLAY_1', 'landfrac', 'PCT_SAND_9', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_2', 'PCT_NAT_PFT_12', 'AR', 'LANDFRAC_PFT', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_CLAY_0', 'SOIL_ORDER', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'PCT_SAND_8', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'H2OSOI_10CM', 'PCT_SAND_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'SNOWDP', 'PCT_CLAY_7', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'Longitude', 'APATITE_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_8', 'HR', 'Y_AR', 'PCT_SAND_1'], 'target_columns': ['Y_cwdc_vr', 'Y_deadstemc', 'Y_NPP', 'Y_HR', 'Y_tlai', 'Y_soil4c_vr', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:42:03,416 - __main__ - INFO - Normalizing data...
2025-06-28 07:42:03,417 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:42:03,417 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,417 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,418 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,419 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,420 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,421 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,421 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,422 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:42:03,423 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_5', 'PCT_CLAY_3', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'LABILE_P', 'PCT_NAT_PFT_7', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_9', 'PCT_SAND_3', 'GPP', 'Y_NPP', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_CLAY_8', 'Latitude', 'Y_HR', 'abm', 'peatf', 'SECONDARY_P', 'Y_GPP', 'PCT_SAND_0', 'PCT_CLAY_1', 'landfrac', 'PCT_SAND_9', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_2', 'PCT_NAT_PFT_12', 'AR', 'LANDFRAC_PFT', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_CLAY_0', 'SOIL_ORDER', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'PCT_SAND_8', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'H2OSOI_10CM', 'PCT_SAND_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'SNOWDP', 'PCT_CLAY_7', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'Longitude', 'APATITE_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_8', 'HR', 'Y_AR', 'PCT_SAND_1']
2025-06-28 07:42:03,423 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:42:03,424 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:42:03,453 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:42:03,459 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_5', 'PCT_CLAY_3', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_6', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'LABILE_P', 'PCT_NAT_PFT_7', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_9', 'PCT_SAND_3', 'GPP', 'Y_NPP', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_CLAY_8', 'Latitude', 'Y_HR', 'abm', 'peatf', 'SECONDARY_P', 'Y_GPP', 'PCT_SAND_0', 'PCT_CLAY_1', 'landfrac', 'PCT_SAND_9', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_2', 'PCT_NAT_PFT_12', 'AR', 'LANDFRAC_PFT', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_CLAY_0', 'SOIL_ORDER', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'PCT_SAND_8', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'H2OSOI_10CM', 'PCT_SAND_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'SNOWDP', 'PCT_CLAY_7', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'Longitude', 'APATITE_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_8', 'HR', 'Y_AR', 'PCT_SAND_1']
2025-06-28 07:42:03,462 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:42:03,462 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:42:03,463 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:42:03,463 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:42:03,463 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:42:03,463 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_NPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP']
2025-06-28 07:42:03,464 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:42:03,466 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:42:03,468 - __main__ - INFO - Splitting data...
2025-06-28 07:42:03,468 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:42:03,469 - __main__ - INFO - Creating model...
2025-06-28 07:42:03,469 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:42:03,469 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:42:03,469 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:42:03,469 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:42:03,469 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:42:03,469 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:42:03,469 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:42:03,469 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:42:03,481 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:42:03,481 - __main__ - INFO - Initializing trainer...
2025-06-28 07:42:05,185 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:42:05,185 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:42:05,185 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:42:05,404 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,580 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,587 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,594 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,600 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,606 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,612 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,618 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,625 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,631 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,637 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,643 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,649 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,656 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,663 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,669 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,675 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,681 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,688 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,694 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,701 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,708 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,714 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,720 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,727 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,734 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,743 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,749 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,755 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,762 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,768 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,776 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,783 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,791 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:42:05,803 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,821 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,823 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,825 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,827 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,828 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,830 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,832 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,834 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:42:05,835 - training.trainer - ERROR - Training pipeline failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:42:05,835 - __main__ - ERROR - Training failed: Sizes of tensors must match except in dimension 1. Expected size 4 but got size 2 for tensor number 1 in the list.
2025-06-28 07:42:51,943 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:42:51,943 - __main__ - INFO - Initializing data loader...
2025-06-28 07:42:51,943 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:42:51,943 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:42:51,943 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:42:51,944 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:42:51,944 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:42:51,944 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:43:00,126 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:43:00,127 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:43:00,128 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:43:00,130 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:43:00,130 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:43:00,162 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:43:00,175 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:43:00,177 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:43:00,611 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,611 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,611 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,612 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,614 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,615 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,616 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,617 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,618 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_4', 'PCT_CLAY_7', 'GPP', 'SCALARAVG_vr_7', 'LABILE_P', 'SECONDARY_P', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_8', 'PCT_NAT_PFT_3', 'AREA', 'peatf', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_9', 'landfrac', 'SCALARAVG_vr_4', 'PCT_NATVEG', 'SCALARAVG_vr_3', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'OCCLUDED_P', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_3', 'SCALARAVG_vr_13', 'HR', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_12', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'H2OSOI_10CM', 'Longitude', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_CLAY_2', 'AR', 'SCALARAVG_vr_9', 'PCT_CLAY_5', 'PCT_SAND_2', 'NPP', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'Y_NPP', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'Y_AR', 'PCT_SAND_6', 'PCT_CLAY_1', 'Latitude', 'PCT_NAT_PFT_8', 'abm', 'PCT_SAND_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_11', 'APATITE_P', 'PCT_CLAY_6', 'PCT_SAND_7', 'SNOWDP', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9']
2025-06-28 07:43:00,618 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:43:00,618 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_SAND_4', 'PCT_CLAY_7', 'GPP', 'SCALARAVG_vr_7', 'LABILE_P', 'SECONDARY_P', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_8', 'PCT_NAT_PFT_3', 'AREA', 'peatf', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_9', 'landfrac', 'SCALARAVG_vr_4', 'PCT_NATVEG', 'SCALARAVG_vr_3', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'OCCLUDED_P', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_3', 'SCALARAVG_vr_13', 'HR', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_12', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'H2OSOI_10CM', 'Longitude', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_CLAY_2', 'AR', 'SCALARAVG_vr_9', 'PCT_CLAY_5', 'PCT_SAND_2', 'NPP', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'Y_NPP', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'Y_AR', 'PCT_SAND_6', 'PCT_CLAY_1', 'Latitude', 'PCT_NAT_PFT_8', 'abm', 'PCT_SAND_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_11', 'APATITE_P', 'PCT_CLAY_6', 'PCT_SAND_7', 'SNOWDP', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9'], 'target_columns': ['Y_GPP', 'Y_deadstemc', 'Y_NPP', 'Y_cwdc_vr', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_soil4c_vr', 'Y_tlai', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:43:00,620 - __main__ - INFO - Normalizing data...
2025-06-28 07:43:00,620 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:43:00,621 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,622 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,622 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,622 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,623 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,624 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,625 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,626 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:43:00,627 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_4', 'PCT_CLAY_7', 'GPP', 'SCALARAVG_vr_7', 'LABILE_P', 'SECONDARY_P', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_8', 'PCT_NAT_PFT_3', 'AREA', 'peatf', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_9', 'landfrac', 'SCALARAVG_vr_4', 'PCT_NATVEG', 'SCALARAVG_vr_3', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'OCCLUDED_P', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_3', 'SCALARAVG_vr_13', 'HR', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_12', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'H2OSOI_10CM', 'Longitude', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_CLAY_2', 'AR', 'SCALARAVG_vr_9', 'PCT_CLAY_5', 'PCT_SAND_2', 'NPP', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'Y_NPP', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'Y_AR', 'PCT_SAND_6', 'PCT_CLAY_1', 'Latitude', 'PCT_NAT_PFT_8', 'abm', 'PCT_SAND_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_11', 'APATITE_P', 'PCT_CLAY_6', 'PCT_SAND_7', 'SNOWDP', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9']
2025-06-28 07:43:00,627 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:43:00,627 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:43:00,669 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:43:00,678 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_SAND_4', 'PCT_CLAY_7', 'GPP', 'SCALARAVG_vr_7', 'LABILE_P', 'SECONDARY_P', 'PCT_SAND_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'PCT_CLAY_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_8', 'PCT_NAT_PFT_3', 'AREA', 'peatf', 'SOIL_ORDER', 'SCALARAVG_vr_6', 'PCT_CLAY_9', 'landfrac', 'SCALARAVG_vr_4', 'PCT_NATVEG', 'SCALARAVG_vr_3', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'OCCLUDED_P', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_3', 'SCALARAVG_vr_13', 'HR', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_12', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'H2OSOI_10CM', 'Longitude', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_CLAY_2', 'AR', 'SCALARAVG_vr_9', 'PCT_CLAY_5', 'PCT_SAND_2', 'NPP', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_14', 'Y_NPP', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'Y_AR', 'PCT_SAND_6', 'PCT_CLAY_1', 'Latitude', 'PCT_NAT_PFT_8', 'abm', 'PCT_SAND_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_11', 'APATITE_P', 'PCT_CLAY_6', 'PCT_SAND_7', 'SNOWDP', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9']
2025-06-28 07:43:00,680 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:43:00,680 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:43:00,680 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:43:00,681 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:43:00,681 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:43:00,681 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_NPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_AR']
2025-06-28 07:43:00,682 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:43:00,683 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:43:00,684 - __main__ - INFO - Splitting data...
2025-06-28 07:43:00,684 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:43:00,684 - __main__ - INFO - Creating model...
2025-06-28 07:43:00,684 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:43:00,685 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:43:00,685 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:43:00,685 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:43:00,685 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:43:00,685 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:43:00,685 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:43:00,685 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:43:00,722 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:43:00,723 - __main__ - INFO - Initializing trainer...
2025-06-28 07:43:02,532 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:43:02,532 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:43:02,532 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:43:02,766 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,948 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,956 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,962 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,968 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,974 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,981 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,987 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:02,996 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,004 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,011 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,018 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,026 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,034 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,040 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,046 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,052 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,058 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,065 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,072 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,079 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,085 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,091 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,097 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,103 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,110 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,116 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,122 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,128 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,135 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,141 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,147 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,155 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,165 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:43:03,178 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,199 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,202 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,204 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,206 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,208 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,210 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,212 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:43:03,213 - training.trainer - ERROR - Training pipeline failed: static batch size mismatch: 2 vs 4
2025-06-28 07:43:03,213 - __main__ - ERROR - Training failed: static batch size mismatch: 2 vs 4
2025-06-28 07:44:10,828 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:44:10,828 - __main__ - INFO - Initializing data loader...
2025-06-28 07:44:10,828 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:44:10,828 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:44:10,829 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:44:10,829 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:44:10,829 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:44:10,829 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:44:17,735 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:44:17,736 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:44:17,737 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:44:17,739 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:44:17,739 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:44:17,766 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:44:17,778 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:44:17,779 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:44:18,137 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,139 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,140 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,141 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,141 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,144 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,145 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,145 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,146 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_8', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_SAND_3', 'Y_GPP', 'GPP', 'PCT_CLAY_2', 'Y_AR', 'SOIL_ORDER', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_4', 'Longitude', 'PCT_CLAY_3', 'SECONDARY_P', 'SCALARAVG_vr_1', 'LABILE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'landfrac', 'Y_HR', 'PCT_SAND_6', 'SCALARAVG_vr_13', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'Y_COL_FIRE_CLOSS', 'LANDFRAC_PFT', 'PCT_NAT_PFT_5', 'COL_FIRE_CLOSS', 'PCT_SAND_4', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'PCT_CLAY_0', 'PCT_SAND_9', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'peatf', 'APATITE_P', 'SCALARAVG_vr_10', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_7', 'PCT_CLAY_9', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'SCALARAVG_vr_6', 'NPP', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_8', 'PCT_CLAY_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_CLAY_1', 'SOIL_COLOR', 'abm', 'PCT_SAND_1', 'AR', 'Y_NPP', 'PCT_NAT_PFT_16', 'HR', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_3']
2025-06-28 07:44:18,146 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:44:18,146 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_8', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_SAND_3', 'Y_GPP', 'GPP', 'PCT_CLAY_2', 'Y_AR', 'SOIL_ORDER', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_4', 'Longitude', 'PCT_CLAY_3', 'SECONDARY_P', 'SCALARAVG_vr_1', 'LABILE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'landfrac', 'Y_HR', 'PCT_SAND_6', 'SCALARAVG_vr_13', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'Y_COL_FIRE_CLOSS', 'LANDFRAC_PFT', 'PCT_NAT_PFT_5', 'COL_FIRE_CLOSS', 'PCT_SAND_4', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'PCT_CLAY_0', 'PCT_SAND_9', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'peatf', 'APATITE_P', 'SCALARAVG_vr_10', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_7', 'PCT_CLAY_9', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'SCALARAVG_vr_6', 'NPP', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_8', 'PCT_CLAY_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_CLAY_1', 'SOIL_COLOR', 'abm', 'PCT_SAND_1', 'AR', 'Y_NPP', 'PCT_NAT_PFT_16', 'HR', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_3'], 'target_columns': ['Y_cwdc_vr', 'Y_GPP', 'Y_AR', 'Y_deadstemc', 'Y_COL_FIRE_CLOSS', 'Y_tlai', 'Y_NPP', 'Y_HR', 'Y_soil4c_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:44:18,146 - __main__ - INFO - Normalizing data...
2025-06-28 07:44:18,146 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:44:18,146 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,148 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,149 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,149 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,149 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,151 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,152 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,152 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:44:18,153 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_8', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_SAND_3', 'Y_GPP', 'GPP', 'PCT_CLAY_2', 'Y_AR', 'SOIL_ORDER', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_4', 'Longitude', 'PCT_CLAY_3', 'SECONDARY_P', 'SCALARAVG_vr_1', 'LABILE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'landfrac', 'Y_HR', 'PCT_SAND_6', 'SCALARAVG_vr_13', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'Y_COL_FIRE_CLOSS', 'LANDFRAC_PFT', 'PCT_NAT_PFT_5', 'COL_FIRE_CLOSS', 'PCT_SAND_4', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'PCT_CLAY_0', 'PCT_SAND_9', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'peatf', 'APATITE_P', 'SCALARAVG_vr_10', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_7', 'PCT_CLAY_9', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'SCALARAVG_vr_6', 'NPP', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_8', 'PCT_CLAY_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_CLAY_1', 'SOIL_COLOR', 'abm', 'PCT_SAND_1', 'AR', 'Y_NPP', 'PCT_NAT_PFT_16', 'HR', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_3']
2025-06-28 07:44:18,153 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:44:18,153 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:44:18,182 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:44:18,188 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_8', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_SAND_3', 'Y_GPP', 'GPP', 'PCT_CLAY_2', 'Y_AR', 'SOIL_ORDER', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_4', 'Longitude', 'PCT_CLAY_3', 'SECONDARY_P', 'SCALARAVG_vr_1', 'LABILE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'landfrac', 'Y_HR', 'PCT_SAND_6', 'SCALARAVG_vr_13', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'Y_COL_FIRE_CLOSS', 'LANDFRAC_PFT', 'PCT_NAT_PFT_5', 'COL_FIRE_CLOSS', 'PCT_SAND_4', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'PCT_CLAY_0', 'PCT_SAND_9', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'peatf', 'APATITE_P', 'SCALARAVG_vr_10', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_7', 'PCT_CLAY_9', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'SCALARAVG_vr_6', 'NPP', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_8', 'PCT_CLAY_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'PCT_CLAY_1', 'SOIL_COLOR', 'abm', 'PCT_SAND_1', 'AR', 'Y_NPP', 'PCT_NAT_PFT_16', 'HR', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_3']
2025-06-28 07:44:18,190 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:44:18,190 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:44:18,191 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:44:18,191 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:44:18,191 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:44:18,191 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_HR']
2025-06-28 07:44:18,192 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:44:18,193 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:44:18,194 - __main__ - INFO - Splitting data...
2025-06-28 07:44:18,194 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:44:18,195 - __main__ - INFO - Creating model...
2025-06-28 07:44:18,195 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:44:18,195 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:44:18,195 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:44:18,195 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:44:18,195 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:44:18,195 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:44:18,195 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:44:18,195 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:44:18,217 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:44:18,217 - __main__ - INFO - Initializing trainer...
2025-06-28 07:44:19,986 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:44:19,986 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:44:19,986 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:44:20,193 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,375 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,382 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,388 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,395 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,402 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,408 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,415 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,422 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,428 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,434 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,440 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,447 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,454 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,460 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,468 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,475 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,481 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,489 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,495 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,501 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,507 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,513 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,519 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,525 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,531 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,537 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,543 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,550 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,557 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,563 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,569 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,575 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,584 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:44:20,596 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,617 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,619 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,625 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,627 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,629 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,630 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,632 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,634 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:44:20,635 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3410, Val Loss: 0.0117
2025-06-28 07:44:20,816 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:44:20,818 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,825 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,831 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,838 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,845 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,853 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,859 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,866 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,872 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,878 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,884 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,889 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,896 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,902 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,908 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,916 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,922 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,928 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,934 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,940 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,946 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,952 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,958 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,964 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,970 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,976 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,982 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,988 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:20,995 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,001 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,008 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,014 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,020 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,026 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:44:21,032 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,035 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,038 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,041 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,044 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,047 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,049 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,050 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,052 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:44:21,053 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0152, Val Loss: 0.0052
2025-06-28 07:44:21,054 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:44:21,054 - training.trainer - INFO - Training completed
2025-06-28 07:44:21,055 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:44:21,056 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,057 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,060 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,061 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,064 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,066 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,067 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,069 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:44:21,071 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:44:21,076 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:44:21,076 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:45:36,946 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:45:36,947 - __main__ - INFO - Initializing data loader...
2025-06-28 07:45:36,947 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:45:36,947 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:45:36,947 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:45:36,947 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:45:36,947 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:45:36,948 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:45:44,220 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:45:44,221 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:45:44,223 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:45:44,225 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:45:44,225 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:45:44,254 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:45:44,265 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:45:44,267 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:45:44,674 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,675 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,678 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,678 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,679 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,679 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,681 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,682 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,682 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_12', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_2', 'HR', 'PCT_CLAY_0', 'PCT_NAT_PFT_8', 'PCT_SAND_6', 'PCT_SAND_3', 'PCT_CLAY_1', 'PCT_CLAY_8', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_13', 'H2OSOI_10CM', 'SCALARAVG_vr_8', 'PCT_NATVEG', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_5', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_9', 'Longitude', 'SCALARAVG_vr_10', 'PCT_CLAY_3', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_4', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_11', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'Y_HR', 'Latitude', 'PCT_CLAY_2', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'AREA', 'SOIL_COLOR', 'PCT_SAND_5', 'SNOWDP', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'APATITE_P', 'PCT_NAT_PFT_12', 'PCT_SAND_7', 'Y_AR', 'PCT_CLAY_7', 'GPP', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'PCT_SAND_0', 'OCCLUDED_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'abm', 'peatf']
2025-06-28 07:45:44,683 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:45:44,683 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_12', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_2', 'HR', 'PCT_CLAY_0', 'PCT_NAT_PFT_8', 'PCT_SAND_6', 'PCT_SAND_3', 'PCT_CLAY_1', 'PCT_CLAY_8', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_13', 'H2OSOI_10CM', 'SCALARAVG_vr_8', 'PCT_NATVEG', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_5', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_9', 'Longitude', 'SCALARAVG_vr_10', 'PCT_CLAY_3', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_4', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_11', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'Y_HR', 'Latitude', 'PCT_CLAY_2', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'AREA', 'SOIL_COLOR', 'PCT_SAND_5', 'SNOWDP', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'APATITE_P', 'PCT_NAT_PFT_12', 'PCT_SAND_7', 'Y_AR', 'PCT_CLAY_7', 'GPP', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'PCT_SAND_0', 'OCCLUDED_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'abm', 'peatf'], 'target_columns': ['Y_deadstemc', 'Y_tlai', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_soil4c_vr', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_cwdc_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:45:44,683 - __main__ - INFO - Normalizing data...
2025-06-28 07:45:44,683 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:45:44,683 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,683 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,686 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,686 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,686 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,687 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,689 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,689 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:45:44,689 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_12', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_2', 'HR', 'PCT_CLAY_0', 'PCT_NAT_PFT_8', 'PCT_SAND_6', 'PCT_SAND_3', 'PCT_CLAY_1', 'PCT_CLAY_8', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_13', 'H2OSOI_10CM', 'SCALARAVG_vr_8', 'PCT_NATVEG', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_5', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_9', 'Longitude', 'SCALARAVG_vr_10', 'PCT_CLAY_3', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_4', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_11', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'Y_HR', 'Latitude', 'PCT_CLAY_2', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'AREA', 'SOIL_COLOR', 'PCT_SAND_5', 'SNOWDP', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'APATITE_P', 'PCT_NAT_PFT_12', 'PCT_SAND_7', 'Y_AR', 'PCT_CLAY_7', 'GPP', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'PCT_SAND_0', 'OCCLUDED_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'abm', 'peatf']
2025-06-28 07:45:44,690 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:45:44,690 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:45:44,727 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:45:44,733 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_12', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_2', 'HR', 'PCT_CLAY_0', 'PCT_NAT_PFT_8', 'PCT_SAND_6', 'PCT_SAND_3', 'PCT_CLAY_1', 'PCT_CLAY_8', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_13', 'H2OSOI_10CM', 'SCALARAVG_vr_8', 'PCT_NATVEG', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'NPP', 'PCT_NAT_PFT_0', 'PCT_CLAY_5', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_9', 'Longitude', 'SCALARAVG_vr_10', 'PCT_CLAY_3', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_4', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_11', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'Y_HR', 'Latitude', 'PCT_CLAY_2', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'AREA', 'SOIL_COLOR', 'PCT_SAND_5', 'SNOWDP', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'APATITE_P', 'PCT_NAT_PFT_12', 'PCT_SAND_7', 'Y_AR', 'PCT_CLAY_7', 'GPP', 'landfrac', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_9', 'PCT_SAND_0', 'OCCLUDED_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'abm', 'peatf']
2025-06-28 07:45:44,735 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:45:44,735 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:45:44,735 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:45:44,735 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:45:44,736 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:45:44,736 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_AR']
2025-06-28 07:45:44,737 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:45:44,738 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:45:44,739 - __main__ - INFO - Splitting data...
2025-06-28 07:45:44,739 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:45:44,739 - __main__ - INFO - Creating model...
2025-06-28 07:45:44,739 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:45:44,739 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:45:44,739 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:45:44,739 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:45:44,740 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:45:44,740 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:45:44,740 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:45:44,740 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:45:44,768 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:45:44,768 - __main__ - INFO - Initializing trainer...
2025-06-28 07:45:46,457 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:45:46,457 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:45:46,457 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:45:46,670 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,865 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,873 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,880 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,886 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,893 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,899 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,906 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,912 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,919 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,925 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,932 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,938 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,945 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,954 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,960 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,966 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,973 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,979 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,987 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,993 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:46,999 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,006 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,012 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,021 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,027 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,033 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,040 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,047 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,054 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,063 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,069 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,076 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,085 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:45:47,097 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,119 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,121 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,122 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,124 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,126 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,129 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,132 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,135 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:45:47,137 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.4207, Val Loss: 0.0178
2025-06-28 07:45:47,188 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:45:47,189 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,198 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,204 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,211 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,217 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,223 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,231 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,237 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,244 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,250 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,259 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,265 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,272 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,278 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,284 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,291 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,297 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,303 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,309 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,316 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,324 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,330 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,337 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,343 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,350 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,357 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,365 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,374 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,382 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,389 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,397 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,406 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,413 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,420 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:45:47,427 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,430 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,433 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,435 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,437 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,439 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,441 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,443 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,444 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:45:47,446 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0260, Val Loss: 0.0089
2025-06-28 07:45:47,446 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:45:47,446 - training.trainer - INFO - Training completed
2025-06-28 07:45:47,446 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:45:47,447 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,449 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,451 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,453 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,454 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,456 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,458 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,460 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:45:47,461 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:45:47,464 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:45:47,464 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:46:35,175 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:46:35,175 - __main__ - INFO - Initializing data loader...
2025-06-28 07:46:35,175 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:46:35,175 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:46:35,176 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:46:35,176 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:46:35,176 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:46:35,176 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:46:42,081 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:46:42,082 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:46:42,084 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:46:42,085 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:46:42,085 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:46:42,113 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:46:42,124 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:46:42,126 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:46:42,485 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,486 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,486 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,487 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,489 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,489 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,490 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,491 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,493 - data.data_loader - INFO - Found 78 static columns: ['abm', 'PCT_NAT_PFT_9', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'PCT_NAT_PFT_8', 'Longitude', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_14', 'PCT_CLAY_6', 'GPP', 'SECONDARY_P', 'PCT_NAT_PFT_12', 'NPP', 'Y_GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_4', 'PCT_CLAY_3', 'SCALARAVG_vr_6', 'SCALARAVG_vr_2', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_7', 'SNOWDP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_SAND_4', 'AREA', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'SCALARAVG_vr_0', 'Y_AR', 'SCALARAVG_vr_11', 'OCCLUDED_P', 'PCT_SAND_6', 'landfrac', 'SCALARAVG_vr_9', 'peatf', 'SOIL_ORDER', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'PCT_SAND_0', 'PCT_NATVEG', 'PCT_CLAY_9', 'COL_FIRE_CLOSS', 'PCT_SAND_5', 'APATITE_P', 'AR', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_1', 'PCT_SAND_1', 'HR', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'Latitude', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_7']
2025-06-28 07:46:42,493 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:46:42,493 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['abm', 'PCT_NAT_PFT_9', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'PCT_NAT_PFT_8', 'Longitude', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_14', 'PCT_CLAY_6', 'GPP', 'SECONDARY_P', 'PCT_NAT_PFT_12', 'NPP', 'Y_GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_4', 'PCT_CLAY_3', 'SCALARAVG_vr_6', 'SCALARAVG_vr_2', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_7', 'SNOWDP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_SAND_4', 'AREA', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'SCALARAVG_vr_0', 'Y_AR', 'SCALARAVG_vr_11', 'OCCLUDED_P', 'PCT_SAND_6', 'landfrac', 'SCALARAVG_vr_9', 'peatf', 'SOIL_ORDER', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'PCT_SAND_0', 'PCT_NATVEG', 'PCT_CLAY_9', 'COL_FIRE_CLOSS', 'PCT_SAND_5', 'APATITE_P', 'AR', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_1', 'PCT_SAND_1', 'HR', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'Latitude', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_7'], 'target_columns': ['Y_cwdc_vr', 'Y_GPP', 'Y_HR', 'Y_tlai', 'Y_deadstemc', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR', 'Y_soil4c_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:46:42,493 - __main__ - INFO - Normalizing data...
2025-06-28 07:46:42,494 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:46:42,494 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,494 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,495 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,495 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,497 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,497 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,498 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,499 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:46:42,501 - data.data_loader - INFO - Found 78 static columns: ['abm', 'PCT_NAT_PFT_9', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'PCT_NAT_PFT_8', 'Longitude', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_14', 'PCT_CLAY_6', 'GPP', 'SECONDARY_P', 'PCT_NAT_PFT_12', 'NPP', 'Y_GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_4', 'PCT_CLAY_3', 'SCALARAVG_vr_6', 'SCALARAVG_vr_2', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_7', 'SNOWDP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_SAND_4', 'AREA', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'SCALARAVG_vr_0', 'Y_AR', 'SCALARAVG_vr_11', 'OCCLUDED_P', 'PCT_SAND_6', 'landfrac', 'SCALARAVG_vr_9', 'peatf', 'SOIL_ORDER', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'PCT_SAND_0', 'PCT_NATVEG', 'PCT_CLAY_9', 'COL_FIRE_CLOSS', 'PCT_SAND_5', 'APATITE_P', 'AR', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_1', 'PCT_SAND_1', 'HR', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'Latitude', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_7']
2025-06-28 07:46:42,501 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:46:42,501 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:46:42,533 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:46:42,540 - data.data_loader - INFO - Normalizing 78 static columns: ['abm', 'PCT_NAT_PFT_9', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'PCT_NAT_PFT_8', 'Longitude', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_14', 'PCT_CLAY_6', 'GPP', 'SECONDARY_P', 'PCT_NAT_PFT_12', 'NPP', 'Y_GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_4', 'PCT_CLAY_3', 'SCALARAVG_vr_6', 'SCALARAVG_vr_2', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_7', 'SNOWDP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_SAND_4', 'AREA', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_CLAY_4', 'SCALARAVG_vr_0', 'Y_AR', 'SCALARAVG_vr_11', 'OCCLUDED_P', 'PCT_SAND_6', 'landfrac', 'SCALARAVG_vr_9', 'peatf', 'SOIL_ORDER', 'PCT_NAT_PFT_14', 'PCT_CLAY_5', 'PCT_NAT_PFT_5', 'PCT_SAND_2', 'PCT_SAND_0', 'PCT_NATVEG', 'PCT_CLAY_9', 'COL_FIRE_CLOSS', 'PCT_SAND_5', 'APATITE_P', 'AR', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_1', 'PCT_SAND_1', 'HR', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'Latitude', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_7']
2025-06-28 07:46:42,542 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:46:42,542 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:46:42,542 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:46:42,543 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:46:42,543 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:46:42,543 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR']
2025-06-28 07:46:42,544 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:46:42,546 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:46:42,548 - __main__ - INFO - Splitting data...
2025-06-28 07:46:42,548 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:46:42,548 - __main__ - INFO - Creating model...
2025-06-28 07:46:42,549 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:46:42,549 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:46:42,549 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:46:42,549 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:46:42,549 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:46:42,549 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:46:42,549 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:46:42,549 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:46:42,563 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:46:42,563 - __main__ - INFO - Initializing trainer...
2025-06-28 07:46:44,225 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:46:44,226 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:46:44,226 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:46:44,456 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,648 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,656 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,663 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,669 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,678 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,685 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,691 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,698 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,704 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,711 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,718 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,724 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,733 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,739 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,745 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,751 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,758 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,764 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,771 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,777 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,784 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,791 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,800 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,806 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,813 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,819 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,826 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,832 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,839 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,845 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,852 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,858 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,868 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:46:44,881 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,900 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,902 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,903 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,905 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,907 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,909 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,910 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,912 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:46:44,913 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3545, Val Loss: 0.0149
2025-06-28 07:46:44,964 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:46:44,965 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,972 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,979 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,985 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,992 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:44,998 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,005 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,012 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,019 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,025 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,031 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,039 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,045 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,052 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,058 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,064 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,071 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,078 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,085 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,091 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,097 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,104 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,111 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,117 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,124 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,133 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,139 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,145 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,152 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,159 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,165 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,172 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,178 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,185 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:46:45,191 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,193 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,195 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,197 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,199 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,202 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,204 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,205 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,207 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:46:45,208 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0159, Val Loss: 0.0072
2025-06-28 07:46:45,216 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:46:45,216 - training.trainer - INFO - Training completed
2025-06-28 07:46:45,216 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:46:45,217 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,219 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,222 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,224 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,226 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,227 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,229 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,231 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:46:45,232 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:46:45,235 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [1088, 544]
2025-06-28 07:46:45,235 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [1088, 544]
2025-06-28 07:47:42,548 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:47:42,548 - __main__ - INFO - Initializing data loader...
2025-06-28 07:47:42,548 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:47:42,548 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:47:42,548 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:47:42,548 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:47:42,549 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:47:42,549 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:47:49,797 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:47:49,798 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:47:49,799 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:47:49,801 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:47:49,801 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:47:49,830 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:47:49,841 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:47:49,842 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:47:50,204 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,206 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,206 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,209 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,210 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,210 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,211 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,212 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,212 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_6', 'Longitude', 'PCT_NAT_PFT_9', 'PCT_CLAY_8', 'GPP', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SOIL_COLOR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'SCALARAVG_vr_11', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'Latitude', 'NPP', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_CLAY_9', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'AR', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_5', 'SNOWDP', 'OCCLUDED_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_0', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_7', 'PCT_NAT_PFT_8', 'SOIL_ORDER', 'Y_HR', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'HR', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'AREA', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_3', 'Y_GPP', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NATVEG', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_CLAY_3', 'APATITE_P', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'SCALARAVG_vr_1', 'SCALARAVG_vr_10', 'SECONDARY_P', 'PCT_SAND_5', 'PCT_SAND_9', 'Y_NPP', 'PCT_NAT_PFT_3', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'peatf', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_1', 'abm', 'SCALARAVG_vr_9']
2025-06-28 07:47:50,212 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:47:50,212 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_6', 'Longitude', 'PCT_NAT_PFT_9', 'PCT_CLAY_8', 'GPP', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SOIL_COLOR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'SCALARAVG_vr_11', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'Latitude', 'NPP', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_CLAY_9', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'AR', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_5', 'SNOWDP', 'OCCLUDED_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_0', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_7', 'PCT_NAT_PFT_8', 'SOIL_ORDER', 'Y_HR', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'HR', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'AREA', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_3', 'Y_GPP', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NATVEG', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_CLAY_3', 'APATITE_P', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'SCALARAVG_vr_1', 'SCALARAVG_vr_10', 'SECONDARY_P', 'PCT_SAND_5', 'PCT_SAND_9', 'Y_NPP', 'PCT_NAT_PFT_3', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'peatf', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_1', 'abm', 'SCALARAVG_vr_9'], 'target_columns': ['Y_soil4c_vr', 'Y_COL_FIRE_CLOSS', 'Y_cwdc_vr', 'Y_GPP', 'Y_deadstemc', 'Y_AR', 'Y_tlai', 'Y_HR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:47:50,212 - __main__ - INFO - Normalizing data...
2025-06-28 07:47:50,212 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:47:50,213 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,215 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,215 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,217 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,217 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,218 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,218 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,219 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:47:50,219 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_6', 'Longitude', 'PCT_NAT_PFT_9', 'PCT_CLAY_8', 'GPP', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SOIL_COLOR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'SCALARAVG_vr_11', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'Latitude', 'NPP', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_CLAY_9', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'AR', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_5', 'SNOWDP', 'OCCLUDED_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_0', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_7', 'PCT_NAT_PFT_8', 'SOIL_ORDER', 'Y_HR', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'HR', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'AREA', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_3', 'Y_GPP', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NATVEG', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_CLAY_3', 'APATITE_P', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'SCALARAVG_vr_1', 'SCALARAVG_vr_10', 'SECONDARY_P', 'PCT_SAND_5', 'PCT_SAND_9', 'Y_NPP', 'PCT_NAT_PFT_3', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'peatf', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_1', 'abm', 'SCALARAVG_vr_9']
2025-06-28 07:47:50,219 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:47:50,219 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:47:50,256 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:47:50,263 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_6', 'Longitude', 'PCT_NAT_PFT_9', 'PCT_CLAY_8', 'GPP', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SOIL_COLOR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_CLAY_6', 'SCALARAVG_vr_11', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'Latitude', 'NPP', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_CLAY_9', 'landfrac', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'AR', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_5', 'SNOWDP', 'OCCLUDED_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_0', 'LABILE_P', 'LANDFRAC_PFT', 'PCT_CLAY_7', 'PCT_NAT_PFT_8', 'SOIL_ORDER', 'Y_HR', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'HR', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'AREA', 'PCT_CLAY_4', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_3', 'Y_GPP', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'PCT_NATVEG', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_CLAY_3', 'APATITE_P', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'SCALARAVG_vr_1', 'SCALARAVG_vr_10', 'SECONDARY_P', 'PCT_SAND_5', 'PCT_SAND_9', 'Y_NPP', 'PCT_NAT_PFT_3', 'Y_AR', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'peatf', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_1', 'abm', 'SCALARAVG_vr_9']
2025-06-28 07:47:50,264 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:47:50,264 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:47:50,264 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:47:50,265 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:47:50,265 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:47:50,265 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_AR', 'Y_HR', 'Y_NPP']
2025-06-28 07:47:50,266 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:47:50,267 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:47:50,268 - __main__ - INFO - Splitting data...
2025-06-28 07:47:50,268 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:47:50,269 - __main__ - INFO - Creating model...
2025-06-28 07:47:50,269 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:47:50,269 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:47:50,269 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:47:50,269 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:47:50,269 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:47:50,269 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:47:50,269 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:47:50,269 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:47:50,291 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:47:50,291 - __main__ - INFO - Initializing trainer...
2025-06-28 07:47:51,975 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:47:51,975 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:47:51,975 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:47:52,172 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,354 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,362 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,369 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,375 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,382 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,388 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,394 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,400 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,406 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,412 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,420 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,426 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,433 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,440 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,446 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,451 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,457 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,464 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,471 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,478 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,484 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,490 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,496 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,501 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,510 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,515 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,521 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,528 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,534 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,542 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,549 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,555 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,564 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:47:52,577 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,598 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,601 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,603 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,605 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,607 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,610 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,613 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,616 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:47:52,619 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3540, Val Loss: 0.0078
2025-06-28 07:47:52,668 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:47:52,670 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,676 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,683 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,690 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,696 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,702 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,708 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,714 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,721 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,727 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,733 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,739 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,745 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,751 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,759 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,765 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,772 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,778 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,784 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,790 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,796 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,804 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,810 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,816 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,822 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,829 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,835 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,844 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,850 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,856 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,862 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,868 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,874 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,881 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:47:52,888 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,889 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,891 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,893 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,895 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,896 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,898 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,900 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,902 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:47:52,904 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0184, Val Loss: 0.0037
2025-06-28 07:47:52,909 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:47:52,909 - training.trainer - INFO - Training completed
2025-06-28 07:47:52,909 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:47:52,910 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,912 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,916 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,919 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,922 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,925 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,928 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,931 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:47:52,933 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:47:52,935 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:47:52,935 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [34, 544]
2025-06-28 07:48:39,925 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:48:39,925 - __main__ - INFO - Initializing data loader...
2025-06-28 07:48:39,926 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:48:39,926 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:48:39,926 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:48:39,926 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:48:39,926 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:48:39,926 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:48:47,057 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:48:47,058 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:48:47,060 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:48:47,061 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:48:47,062 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:48:47,089 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:48:47,104 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:48:47,106 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:48:47,463 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,464 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,465 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,465 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,470 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,470 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,470 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,471 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,471 - data.data_loader - INFO - Found 78 static columns: ['Longitude', 'PCT_NAT_PFT_1', 'HR', 'SCALARAVG_vr_5', 'PCT_SAND_7', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_6', 'SECONDARY_P', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'PCT_SAND_1', 'abm', 'PCT_SAND_4', 'Y_GPP', 'H2OSOI_10CM', 'Y_AR', 'NPP', 'LABILE_P', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'GPP', 'AR', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'Y_NPP', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_CLAY_8', 'PCT_SAND_3', 'SCALARAVG_vr_8', 'peatf', 'Y_HR', 'PCT_NAT_PFT_11', 'APATITE_P', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'SOIL_ORDER', 'Latitude', 'PCT_SAND_0', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_4', 'PCT_CLAY_3', 'PCT_SAND_2', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_CLAY_6', 'PCT_NATVEG', 'PCT_NAT_PFT_5', 'AREA', 'SCALARAVG_vr_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_CLAY_0', 'OCCLUDED_P', 'landfrac', 'PCT_NAT_PFT_12']
2025-06-28 07:48:47,471 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:48:47,471 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['Longitude', 'PCT_NAT_PFT_1', 'HR', 'SCALARAVG_vr_5', 'PCT_SAND_7', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_6', 'SECONDARY_P', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'PCT_SAND_1', 'abm', 'PCT_SAND_4', 'Y_GPP', 'H2OSOI_10CM', 'Y_AR', 'NPP', 'LABILE_P', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'GPP', 'AR', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'Y_NPP', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_CLAY_8', 'PCT_SAND_3', 'SCALARAVG_vr_8', 'peatf', 'Y_HR', 'PCT_NAT_PFT_11', 'APATITE_P', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'SOIL_ORDER', 'Latitude', 'PCT_SAND_0', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_4', 'PCT_CLAY_3', 'PCT_SAND_2', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_CLAY_6', 'PCT_NATVEG', 'PCT_NAT_PFT_5', 'AREA', 'SCALARAVG_vr_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_CLAY_0', 'OCCLUDED_P', 'landfrac', 'PCT_NAT_PFT_12'], 'target_columns': ['Y_deadstemc', 'Y_soil4c_vr', 'Y_AR', 'Y_tlai', 'Y_GPP', 'Y_cwdc_vr', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:48:47,472 - __main__ - INFO - Normalizing data...
2025-06-28 07:48:47,472 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:48:47,472 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,473 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,473 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,474 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,477 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,477 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,478 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,478 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:48:47,478 - data.data_loader - INFO - Found 78 static columns: ['Longitude', 'PCT_NAT_PFT_1', 'HR', 'SCALARAVG_vr_5', 'PCT_SAND_7', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_6', 'SECONDARY_P', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'PCT_SAND_1', 'abm', 'PCT_SAND_4', 'Y_GPP', 'H2OSOI_10CM', 'Y_AR', 'NPP', 'LABILE_P', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'GPP', 'AR', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'Y_NPP', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_CLAY_8', 'PCT_SAND_3', 'SCALARAVG_vr_8', 'peatf', 'Y_HR', 'PCT_NAT_PFT_11', 'APATITE_P', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'SOIL_ORDER', 'Latitude', 'PCT_SAND_0', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_4', 'PCT_CLAY_3', 'PCT_SAND_2', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_CLAY_6', 'PCT_NATVEG', 'PCT_NAT_PFT_5', 'AREA', 'SCALARAVG_vr_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_CLAY_0', 'OCCLUDED_P', 'landfrac', 'PCT_NAT_PFT_12']
2025-06-28 07:48:47,478 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:48:47,478 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:48:47,507 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:48:47,513 - data.data_loader - INFO - Normalizing 78 static columns: ['Longitude', 'PCT_NAT_PFT_1', 'HR', 'SCALARAVG_vr_5', 'PCT_SAND_7', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_6', 'SECONDARY_P', 'PCT_CLAY_5', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'PCT_SAND_1', 'abm', 'PCT_SAND_4', 'Y_GPP', 'H2OSOI_10CM', 'Y_AR', 'NPP', 'LABILE_P', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'GPP', 'AR', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'Y_NPP', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SNOWDP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_CLAY_8', 'PCT_SAND_3', 'SCALARAVG_vr_8', 'peatf', 'Y_HR', 'PCT_NAT_PFT_11', 'APATITE_P', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'SOIL_ORDER', 'Latitude', 'PCT_SAND_0', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_4', 'PCT_CLAY_3', 'PCT_SAND_2', 'PCT_SAND_9', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_CLAY_6', 'PCT_NATVEG', 'PCT_NAT_PFT_5', 'AREA', 'SCALARAVG_vr_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_CLAY_0', 'OCCLUDED_P', 'landfrac', 'PCT_NAT_PFT_12']
2025-06-28 07:48:47,515 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:48:47,515 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:48:47,515 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:48:47,515 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:48:47,515 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:48:47,516 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_GPP', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_HR']
2025-06-28 07:48:47,516 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:48:47,518 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:48:47,519 - __main__ - INFO - Splitting data...
2025-06-28 07:48:47,519 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:48:47,519 - __main__ - INFO - Creating model...
2025-06-28 07:48:47,519 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:48:47,519 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:48:47,520 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:48:47,520 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:48:47,520 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:48:47,520 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:48:47,520 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:48:47,520 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:48:47,529 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:48:47,529 - __main__ - INFO - Initializing trainer...
2025-06-28 07:48:49,199 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:48:49,199 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:48:49,199 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:48:49,405 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,585 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,592 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,599 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,605 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,612 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,618 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,625 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,633 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,640 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,647 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,653 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,659 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,666 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,674 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,680 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,687 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,693 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,699 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,705 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,712 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,718 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,724 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,730 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,737 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,744 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,751 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,758 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,765 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,771 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,777 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,784 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,790 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,800 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:48:49,812 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,831 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,833 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,835 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,837 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,839 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,841 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,843 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,844 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:48:49,845 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3754, Val Loss: 0.0156
2025-06-28 07:48:49,896 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:48:49,898 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,904 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,911 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,917 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,923 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,930 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,937 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,944 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,950 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,956 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,964 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,973 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,979 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,986 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,992 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:49,998 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,005 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,011 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,018 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,024 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,031 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,037 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,043 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,049 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,056 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,062 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,069 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,075 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,081 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,087 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,093 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,100 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,106 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,112 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:48:50,118 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,120 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,122 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,124 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,126 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,128 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,131 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,134 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,136 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:48:50,138 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0214, Val Loss: 0.0115
2025-06-28 07:48:50,139 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:48:50,139 - training.trainer - INFO - Training completed
2025-06-28 07:48:50,139 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:48:50,140 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,142 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,143 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,145 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,147 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,148 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,150 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,152 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:48:50,154 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:48:50,157 - training.trainer - ERROR - Training pipeline failed: y_true and y_pred have different number of output (360!=540)
2025-06-28 07:48:50,157 - __main__ - ERROR - Training failed: y_true and y_pred have different number of output (360!=540)
2025-06-28 07:49:22,790 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:49:22,790 - __main__ - INFO - Initializing data loader...
2025-06-28 07:49:22,791 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:49:22,791 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:49:22,791 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:49:22,791 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:49:22,791 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:49:22,791 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:49:31,173 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:49:31,174 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:49:31,175 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:49:31,177 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:49:31,177 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:49:31,207 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:49:31,218 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:49:31,220 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:49:31,598 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,598 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,599 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,600 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,601 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,602 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,603 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,603 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,606 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_0', 'AREA', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_12', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_NAT_PFT_10', 'peatf', 'PCT_CLAY_2', 'abm', 'GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_SAND_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_4', 'PCT_SAND_5', 'NPP', 'SECONDARY_P', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_0', 'Y_HR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_1', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'SOIL_ORDER', 'landfrac', 'SCALARAVG_vr_3', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'PCT_SAND_1', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_0', 'PCT_CLAY_4', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_8', 'APATITE_P', 'HR', 'PCT_SAND_2', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'Y_AR', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'Longitude', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'LABILE_P', 'AR', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_SAND_6', 'Latitude', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_13']
2025-06-28 07:49:31,606 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:49:31,606 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_SAND_0', 'AREA', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_12', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_NAT_PFT_10', 'peatf', 'PCT_CLAY_2', 'abm', 'GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_SAND_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_4', 'PCT_SAND_5', 'NPP', 'SECONDARY_P', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_0', 'Y_HR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_1', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'SOIL_ORDER', 'landfrac', 'SCALARAVG_vr_3', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'PCT_SAND_1', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_0', 'PCT_CLAY_4', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_8', 'APATITE_P', 'HR', 'PCT_SAND_2', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'Y_AR', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'Longitude', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'LABILE_P', 'AR', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_SAND_6', 'Latitude', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_13'], 'target_columns': ['Y_deadstemc', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR', 'Y_cwdc_vr', 'Y_tlai', 'Y_HR', 'Y_soil4c_vr', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:49:31,606 - __main__ - INFO - Normalizing data...
2025-06-28 07:49:31,606 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:49:31,607 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,607 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,608 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,609 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,609 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,610 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,611 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,611 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:49:31,613 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_0', 'AREA', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_12', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_NAT_PFT_10', 'peatf', 'PCT_CLAY_2', 'abm', 'GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_SAND_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_4', 'PCT_SAND_5', 'NPP', 'SECONDARY_P', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_0', 'Y_HR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_1', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'SOIL_ORDER', 'landfrac', 'SCALARAVG_vr_3', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'PCT_SAND_1', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_0', 'PCT_CLAY_4', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_8', 'APATITE_P', 'HR', 'PCT_SAND_2', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'Y_AR', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'Longitude', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'LABILE_P', 'AR', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_SAND_6', 'Latitude', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_13']
2025-06-28 07:49:31,613 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:49:31,613 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:49:31,648 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:49:31,655 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_SAND_0', 'AREA', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_12', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_NAT_PFT_10', 'peatf', 'PCT_CLAY_2', 'abm', 'GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_6', 'SNOWDP', 'PCT_SAND_4', 'PCT_NAT_PFT_14', 'PCT_SAND_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_4', 'PCT_SAND_5', 'NPP', 'SECONDARY_P', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_0', 'Y_HR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_1', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'SOIL_ORDER', 'landfrac', 'SCALARAVG_vr_3', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'PCT_SAND_1', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_0', 'PCT_CLAY_4', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_CLAY_1', 'Y_NPP', 'PCT_SAND_8', 'APATITE_P', 'HR', 'PCT_SAND_2', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'Y_AR', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'Longitude', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'LABILE_P', 'AR', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_SAND_6', 'Latitude', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_13']
2025-06-28 07:49:31,657 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:49:31,657 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:49:31,658 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:49:31,658 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:49:31,658 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:49:31,658 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR', 'Y_HR', 'Y_GPP']
2025-06-28 07:49:31,659 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:49:31,660 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:49:31,661 - __main__ - INFO - Splitting data...
2025-06-28 07:49:31,662 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:49:31,662 - __main__ - INFO - Creating model...
2025-06-28 07:49:31,662 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:49:31,662 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:49:31,662 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:49:31,662 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:49:31,662 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:49:31,662 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:49:31,663 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:49:31,663 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:49:31,673 - models.combined_model - INFO - Model initialized with 338796 parameters
2025-06-28 07:49:31,673 - __main__ - INFO - Initializing trainer...
2025-06-28 07:49:33,400 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:49:33,400 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:49:33,400 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:49:33,628 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,806 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,814 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,820 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,827 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,833 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,840 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,847 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,853 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,863 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,869 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,876 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,882 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,889 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,896 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,904 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,910 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,917 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,923 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,930 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,937 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,943 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,950 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,957 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,963 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,969 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,975 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,981 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,988 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:33,994 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,002 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,008 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,015 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,024 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:49:34,037 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,058 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,060 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,061 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,063 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,065 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,067 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,069 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,071 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:49:34,074 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3553, Val Loss: 0.0102
2025-06-28 07:49:34,120 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:49:34,122 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,129 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,136 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,142 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,149 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,156 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,162 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,168 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,175 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,181 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,187 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,194 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,201 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,207 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,214 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,221 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,228 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,236 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,242 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,249 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,255 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,261 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,268 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,275 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,281 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,288 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,295 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,301 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,307 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,314 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,320 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,326 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,333 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,340 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:49:34,346 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,348 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,350 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,352 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,353 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,355 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,357 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,358 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,360 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:49:34,362 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0219, Val Loss: 0.0100
2025-06-28 07:49:34,364 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:49:34,364 - training.trainer - INFO - Training completed
2025-06-28 07:49:34,364 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:49:34,365 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,367 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,369 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,371 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,373 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,374 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,376 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,379 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:49:34,382 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:49:34,389 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [1020, 18360]
2025-06-28 07:49:34,389 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [1020, 18360]
2025-06-28 07:50:21,319 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:50:21,319 - __main__ - INFO - Initializing data loader...
2025-06-28 07:50:21,319 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:50:21,319 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:50:21,320 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:50:21,320 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:50:21,320 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:50:21,320 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:50:28,681 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:50:28,682 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:50:28,684 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:50:28,685 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:50:28,685 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:50:28,715 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:50:28,727 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:50:28,728 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:50:29,141 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,141 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,144 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,144 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,145 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,145 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,148 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,149 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,150 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_3', 'landfrac', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_13', 'LABILE_P', 'PCT_NAT_PFT_15', 'Longitude', 'HR', 'PCT_NAT_PFT_0', 'PCT_CLAY_8', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'GPP', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_NAT_PFT_11', 'Y_HR', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NATVEG', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'PCT_SAND_7', 'SNOWDP', 'PCT_CLAY_5', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'Y_GPP', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SECONDARY_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'peatf', 'APATITE_P', 'Y_AR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SCALARAVG_vr_4', 'abm', 'SCALARAVG_vr_0', 'SCALARAVG_vr_10', 'NPP', 'AREA', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_6', 'PCT_SAND_0', 'PCT_SAND_3', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_5', 'PCT_CLAY_0', 'PCT_SAND_8', 'PCT_SAND_2']
2025-06-28 07:50:29,150 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:50:29,150 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_3', 'landfrac', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_13', 'LABILE_P', 'PCT_NAT_PFT_15', 'Longitude', 'HR', 'PCT_NAT_PFT_0', 'PCT_CLAY_8', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'GPP', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_NAT_PFT_11', 'Y_HR', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NATVEG', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'PCT_SAND_7', 'SNOWDP', 'PCT_CLAY_5', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'Y_GPP', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SECONDARY_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'peatf', 'APATITE_P', 'Y_AR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SCALARAVG_vr_4', 'abm', 'SCALARAVG_vr_0', 'SCALARAVG_vr_10', 'NPP', 'AREA', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_6', 'PCT_SAND_0', 'PCT_SAND_3', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_5', 'PCT_CLAY_0', 'PCT_SAND_8', 'PCT_SAND_2'], 'target_columns': ['Y_NPP', 'Y_deadstemc', 'Y_HR', 'Y_GPP', 'Y_soil4c_vr', 'Y_COL_FIRE_CLOSS', 'Y_tlai', 'Y_AR', 'Y_cwdc_vr'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:50:29,150 - __main__ - INFO - Normalizing data...
2025-06-28 07:50:29,150 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:50:29,150 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,151 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,152 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,153 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,153 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,153 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,155 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,156 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:50:29,157 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_3', 'landfrac', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_13', 'LABILE_P', 'PCT_NAT_PFT_15', 'Longitude', 'HR', 'PCT_NAT_PFT_0', 'PCT_CLAY_8', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'GPP', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_NAT_PFT_11', 'Y_HR', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NATVEG', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'PCT_SAND_7', 'SNOWDP', 'PCT_CLAY_5', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'Y_GPP', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SECONDARY_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'peatf', 'APATITE_P', 'Y_AR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SCALARAVG_vr_4', 'abm', 'SCALARAVG_vr_0', 'SCALARAVG_vr_10', 'NPP', 'AREA', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_6', 'PCT_SAND_0', 'PCT_SAND_3', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_5', 'PCT_CLAY_0', 'PCT_SAND_8', 'PCT_SAND_2']
2025-06-28 07:50:29,157 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:50:29,157 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:50:29,188 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:50:29,194 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_3', 'landfrac', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_13', 'LABILE_P', 'PCT_NAT_PFT_15', 'Longitude', 'HR', 'PCT_NAT_PFT_0', 'PCT_CLAY_8', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'GPP', 'PCT_SAND_4', 'PCT_SAND_6', 'PCT_NAT_PFT_11', 'Y_HR', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'OCCLUDED_P', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NATVEG', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_7', 'AR', 'PCT_SAND_1', 'PCT_SAND_7', 'SNOWDP', 'PCT_CLAY_5', 'COL_FIRE_CLOSS', 'SOIL_COLOR', 'Y_GPP', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SECONDARY_P', 'SCALARAVG_vr_1', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'peatf', 'APATITE_P', 'Y_AR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SCALARAVG_vr_4', 'abm', 'SCALARAVG_vr_0', 'SCALARAVG_vr_10', 'NPP', 'AREA', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_6', 'PCT_SAND_0', 'PCT_SAND_3', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'Latitude', 'SCALARAVG_vr_5', 'PCT_SAND_5', 'PCT_CLAY_0', 'PCT_SAND_8', 'PCT_SAND_2']
2025-06-28 07:50:29,196 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:50:29,196 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:50:29,196 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:50:29,197 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:50:29,197 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:50:29,197 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_NPP', 'Y_HR', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR']
2025-06-28 07:50:29,198 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:50:29,199 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:50:29,200 - __main__ - INFO - Splitting data...
2025-06-28 07:50:29,200 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:50:29,200 - __main__ - INFO - Creating model...
2025-06-28 07:50:29,200 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:50:29,200 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:50:29,200 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:50:29,201 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:50:29,201 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:50:29,201 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:50:29,201 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:50:29,201 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:50:29,230 - models.combined_model - INFO - Model initialized with 292356 parameters
2025-06-28 07:50:29,230 - __main__ - INFO - Initializing trainer...
2025-06-28 07:50:30,915 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:50:30,916 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:50:30,916 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:50:31,103 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,288 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,296 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,302 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,309 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,315 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,322 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,328 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,337 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,343 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,350 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,356 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,362 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,369 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,376 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,383 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,391 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,397 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,404 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,410 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,417 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,424 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,431 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,438 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,445 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,451 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,458 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,464 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,472 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,478 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,485 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,492 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,499 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,508 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,520 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,538 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,541 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,543 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,544 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,546 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,548 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,550 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,551 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,552 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3784, Val Loss: 0.0185
2025-06-28 07:50:31,608 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:50:31,609 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,616 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,623 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,630 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,637 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,645 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,652 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,658 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,665 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,671 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,677 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,684 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,691 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,698 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,704 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,710 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,717 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,723 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,768 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,774 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,780 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,786 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,793 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,799 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,806 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,813 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,819 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,826 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,832 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,839 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,845 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,852 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,858 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,865 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,872 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,873 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,876 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,878 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,880 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,882 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,884 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,886 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,889 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,892 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0188, Val Loss: 0.0081
2025-06-28 07:50:31,898 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:50:31,898 - training.trainer - INFO - Training completed
2025-06-28 07:50:31,898 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:50:31,899 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,901 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,902 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,904 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,905 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,907 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,908 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,910 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,911 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,914 - training.trainer - INFO - Test metrics: {'scalar_rmse': np.float64(0.0879172973427517), 'scalar_mse': 0.007729451172053814, 'vector_rmse': np.float64(0.017572882320813877), 'vector_mse': 0.00030880619306117296, 'matrix_rmse': np.float64(0.015117992750395654), 'matrix_mse': 0.00022855370480101556}
2025-06-28 07:50:31,915 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,917 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,918 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,920 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,921 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,923 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,924 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,926 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:50:31,928 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:50:31,933 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 07:50:31,934 - training.trainer - ERROR - Training pipeline failed: Shape of passed values is (34, 5), indices imply (34, 9)
2025-06-28 07:50:31,934 - __main__ - ERROR - Training failed: Shape of passed values is (34, 5), indices imply (34, 9)
2025-06-28 07:51:38,963 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:51:38,963 - __main__ - INFO - Initializing data loader...
2025-06-28 07:51:38,963 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:51:38,963 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:51:38,964 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:51:38,964 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:51:38,964 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:51:38,964 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:51:45,823 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:51:45,824 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:51:45,825 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:51:45,827 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:51:45,827 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:51:45,855 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:51:45,866 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:51:45,868 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:51:46,194 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,195 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,196 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,197 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,198 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,201 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,202 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,203 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,203 - data.data_loader - INFO - Found 78 static columns: ['H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_SAND_6', 'Y_AR', 'AR', 'PCT_SAND_5', 'Y_HR', 'PCT_CLAY_0', 'SOIL_ORDER', 'PCT_NAT_PFT_10', 'PCT_SAND_2', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'OCCLUDED_P', 'PCT_NAT_PFT_9', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_CLAY_1', 'PCT_NAT_PFT_13', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_7', 'PCT_CLAY_3', 'HR', 'PCT_SAND_7', 'GPP', 'PCT_SAND_0', 'SECONDARY_P', 'landfrac', 'PCT_SAND_4', 'PCT_CLAY_2', 'peatf', 'Longitude', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'abm', 'PCT_NAT_PFT_8', 'PCT_CLAY_8', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_SAND_1', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_2', 'Y_NPP', 'AREA', 'Latitude', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'APATITE_P', 'SCALARAVG_vr_14', 'SNOWDP', 'PCT_SAND_8', 'PCT_NAT_PFT_1']
2025-06-28 07:51:46,203 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:51:46,203 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_SAND_6', 'Y_AR', 'AR', 'PCT_SAND_5', 'Y_HR', 'PCT_CLAY_0', 'SOIL_ORDER', 'PCT_NAT_PFT_10', 'PCT_SAND_2', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'OCCLUDED_P', 'PCT_NAT_PFT_9', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_CLAY_1', 'PCT_NAT_PFT_13', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_7', 'PCT_CLAY_3', 'HR', 'PCT_SAND_7', 'GPP', 'PCT_SAND_0', 'SECONDARY_P', 'landfrac', 'PCT_SAND_4', 'PCT_CLAY_2', 'peatf', 'Longitude', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'abm', 'PCT_NAT_PFT_8', 'PCT_CLAY_8', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_SAND_1', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_2', 'Y_NPP', 'AREA', 'Latitude', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'APATITE_P', 'SCALARAVG_vr_14', 'SNOWDP', 'PCT_SAND_8', 'PCT_NAT_PFT_1'], 'target_columns': ['Y_AR', 'Y_HR', 'Y_tlai', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_deadstemc', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:51:46,203 - __main__ - INFO - Normalizing data...
2025-06-28 07:51:46,203 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:51:46,204 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,204 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,204 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,205 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,206 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,209 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,209 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,210 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:51:46,210 - data.data_loader - INFO - Found 78 static columns: ['H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_SAND_6', 'Y_AR', 'AR', 'PCT_SAND_5', 'Y_HR', 'PCT_CLAY_0', 'SOIL_ORDER', 'PCT_NAT_PFT_10', 'PCT_SAND_2', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'OCCLUDED_P', 'PCT_NAT_PFT_9', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_CLAY_1', 'PCT_NAT_PFT_13', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_7', 'PCT_CLAY_3', 'HR', 'PCT_SAND_7', 'GPP', 'PCT_SAND_0', 'SECONDARY_P', 'landfrac', 'PCT_SAND_4', 'PCT_CLAY_2', 'peatf', 'Longitude', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'abm', 'PCT_NAT_PFT_8', 'PCT_CLAY_8', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_SAND_1', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_2', 'Y_NPP', 'AREA', 'Latitude', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'APATITE_P', 'SCALARAVG_vr_14', 'SNOWDP', 'PCT_SAND_8', 'PCT_NAT_PFT_1']
2025-06-28 07:51:46,210 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:51:46,210 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:51:46,243 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:51:46,255 - data.data_loader - INFO - Normalizing 78 static columns: ['H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_SAND_6', 'Y_AR', 'AR', 'PCT_SAND_5', 'Y_HR', 'PCT_CLAY_0', 'SOIL_ORDER', 'PCT_NAT_PFT_10', 'PCT_SAND_2', 'SCALARAVG_vr_13', 'SCALARAVG_vr_12', 'OCCLUDED_P', 'PCT_NAT_PFT_9', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_CLAY_1', 'PCT_NAT_PFT_13', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_7', 'LANDFRAC_PFT', 'SCALARAVG_vr_5', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_3', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'SCALARAVG_vr_7', 'PCT_CLAY_3', 'HR', 'PCT_SAND_7', 'GPP', 'PCT_SAND_0', 'SECONDARY_P', 'landfrac', 'PCT_SAND_4', 'PCT_CLAY_2', 'peatf', 'Longitude', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'abm', 'PCT_NAT_PFT_8', 'PCT_CLAY_8', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_SAND_1', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_2', 'Y_NPP', 'AREA', 'Latitude', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'APATITE_P', 'SCALARAVG_vr_14', 'SNOWDP', 'PCT_SAND_8', 'PCT_NAT_PFT_1']
2025-06-28 07:51:46,256 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:51:46,257 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:51:46,257 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:51:46,257 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:51:46,257 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:51:46,257 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_NPP']
2025-06-28 07:51:46,258 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:51:46,260 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:51:46,261 - __main__ - INFO - Splitting data...
2025-06-28 07:51:46,261 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:51:46,261 - __main__ - INFO - Creating model...
2025-06-28 07:51:46,261 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:51:46,262 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:51:46,262 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:51:46,262 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:51:46,263 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:51:46,263 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:51:46,263 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:51:46,263 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:51:46,295 - models.combined_model - INFO - Model initialized with 292356 parameters
2025-06-28 07:51:46,295 - __main__ - INFO - Initializing trainer...
2025-06-28 07:51:48,003 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:51:48,003 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:51:48,003 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:51:48,224 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,410 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,419 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,425 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,432 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,439 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,445 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,452 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,459 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,465 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,471 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,477 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,484 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,490 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,499 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,505 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,511 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,518 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,524 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,530 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,537 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,544 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,550 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,557 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,563 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,570 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,576 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,582 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,589 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,595 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,602 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,608 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,614 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,625 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:48,637 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,654 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,658 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,661 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,664 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,667 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,669 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,671 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,672 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:48,673 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3863, Val Loss: 0.0284
2025-06-28 07:51:48,725 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:51:48,727 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,735 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,741 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,747 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,754 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,760 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,767 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,774 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,780 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,786 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,792 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,799 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,806 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,813 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,819 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,825 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,832 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,838 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,846 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,852 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,859 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,865 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,871 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,877 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,883 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,890 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,896 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,903 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,910 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,916 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,923 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,929 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,936 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,942 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:48,948 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,951 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,952 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,954 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,956 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,957 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,959 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,961 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,962 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:48,964 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0182, Val Loss: 0.0093
2025-06-28 07:51:48,965 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:51:48,965 - training.trainer - INFO - Training completed
2025-06-28 07:51:48,965 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:51:48,966 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,968 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,970 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,972 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,974 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,976 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,977 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,979 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,983 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:48,989 - training.trainer - INFO - Test metrics: {'scalar_rmse': np.float64(0.09316485802492741), 'scalar_mse': 0.008679690770804882, 'vector_rmse': np.float64(0.020478621637427415), 'vector_mse': 0.0004193739441689104, 'matrix_rmse': np.float64(0.017523776748549855), 'matrix_mse': 0.00030708275153301656}
2025-06-28 07:51:48,989 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,992 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,993 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,995 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,997 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:48,998 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:49,000 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:49,001 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([4, 32]), static_out torch.Size([4, 32]), list_1d_out torch.Size([4, 16]), list_2d_out torch.Size([4, 16])
2025-06-28 07:51:49,003 - models.combined_model - ERROR - BATCH DEBUG: lstm_out torch.Size([2, 32]), static_out torch.Size([2, 32]), list_1d_out torch.Size([2, 16]), list_2d_out torch.Size([2, 16])
2025-06-28 07:51:49,010 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 07:51:49,022 - training.trainer - INFO - All predictions saved successfully
2025-06-28 07:51:49,297 - training.trainer - ERROR - Training pipeline failed: 
attribute lookup is not defined on python value of type 'Logger':
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/AImodel/models/combined_model.py", line 283
        
        # Debug: log shapes before concatenation
        logger.error(f"BATCH DEBUG: lstm_out {lstm_out.shape}, static_out {static_out.shape}, list_1d_out {list_1d_out.shape}, list_2d_out {list_2d_out.shape}")
        ~~~~~~~~~~~~ <--- HERE
    
        # Combine all features

2025-06-28 07:51:49,297 - __main__ - ERROR - Training failed: 
attribute lookup is not defined on python value of type 'Logger':
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/AImodel/models/combined_model.py", line 283
        
        # Debug: log shapes before concatenation
        logger.error(f"BATCH DEBUG: lstm_out {lstm_out.shape}, static_out {static_out.shape}, list_1d_out {list_1d_out.shape}, list_2d_out {list_2d_out.shape}")
        ~~~~~~~~~~~~ <--- HERE
    
        # Combine all features

2025-06-28 07:53:13,854 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:53:13,855 - __main__ - INFO - Initializing data loader...
2025-06-28 07:53:13,855 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:53:13,855 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:53:13,855 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:53:13,856 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:53:13,856 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:53:13,856 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:53:20,663 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:53:20,663 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:53:20,665 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:53:20,667 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:53:20,667 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:53:20,695 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:53:20,707 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:53:20,708 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:53:21,037 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,040 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,041 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,041 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,042 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,044 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,044 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,045 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,046 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_10', 'Y_AR', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'SCALARAVG_vr_13', 'Latitude', 'SCALARAVG_vr_0', 'PCT_CLAY_3', 'PCT_NAT_PFT_1', 'H2OSOI_10CM', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_3', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'NPP', 'AR', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_4', 'SECONDARY_P', 'HR', 'COL_FIRE_CLOSS', 'SOIL_ORDER', 'peatf', 'PCT_CLAY_2', 'LABILE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'Y_HR', 'PCT_SAND_9', 'landfrac', 'PCT_SAND_1', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_16', 'SNOWDP', 'PCT_NAT_PFT_13', 'Y_NPP', 'PCT_NAT_PFT_9', 'GPP']
2025-06-28 07:53:21,046 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:53:21,046 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_10', 'Y_AR', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'SCALARAVG_vr_13', 'Latitude', 'SCALARAVG_vr_0', 'PCT_CLAY_3', 'PCT_NAT_PFT_1', 'H2OSOI_10CM', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_3', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'NPP', 'AR', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_4', 'SECONDARY_P', 'HR', 'COL_FIRE_CLOSS', 'SOIL_ORDER', 'peatf', 'PCT_CLAY_2', 'LABILE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'Y_HR', 'PCT_SAND_9', 'landfrac', 'PCT_SAND_1', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_16', 'SNOWDP', 'PCT_NAT_PFT_13', 'Y_NPP', 'PCT_NAT_PFT_9', 'GPP'], 'target_columns': ['Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_cwdc_vr', 'Y_GPP', 'Y_deadstemc', 'Y_soil4c_vr', 'Y_HR', 'Y_tlai', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:53:21,046 - __main__ - INFO - Normalizing data...
2025-06-28 07:53:21,046 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:53:21,046 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,049 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,049 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,049 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,050 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,051 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,051 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,052 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:53:21,053 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_10', 'Y_AR', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'SCALARAVG_vr_13', 'Latitude', 'SCALARAVG_vr_0', 'PCT_CLAY_3', 'PCT_NAT_PFT_1', 'H2OSOI_10CM', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_3', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'NPP', 'AR', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_4', 'SECONDARY_P', 'HR', 'COL_FIRE_CLOSS', 'SOIL_ORDER', 'peatf', 'PCT_CLAY_2', 'LABILE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'Y_HR', 'PCT_SAND_9', 'landfrac', 'PCT_SAND_1', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_16', 'SNOWDP', 'PCT_NAT_PFT_13', 'Y_NPP', 'PCT_NAT_PFT_9', 'GPP']
2025-06-28 07:53:21,054 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:53:21,054 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:53:21,095 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:53:21,101 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_10', 'Y_AR', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'SCALARAVG_vr_13', 'Latitude', 'SCALARAVG_vr_0', 'PCT_CLAY_3', 'PCT_NAT_PFT_1', 'H2OSOI_10CM', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_3', 'PCT_CLAY_1', 'SCALARAVG_vr_6', 'NPP', 'AR', 'LANDFRAC_PFT', 'PCT_NATVEG', 'Y_COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_4', 'SECONDARY_P', 'HR', 'COL_FIRE_CLOSS', 'SOIL_ORDER', 'peatf', 'PCT_CLAY_2', 'LABILE_P', 'PCT_SAND_4', 'PCT_NAT_PFT_5', 'PCT_CLAY_7', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'Y_HR', 'PCT_SAND_9', 'landfrac', 'PCT_SAND_1', 'PCT_SAND_3', 'Y_GPP', 'SCALARAVG_vr_5', 'SCALARAVG_vr_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_12', 'PCT_SAND_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'AREA', 'SOIL_COLOR', 'PCT_CLAY_6', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_16', 'SNOWDP', 'PCT_NAT_PFT_13', 'Y_NPP', 'PCT_NAT_PFT_9', 'GPP']
2025-06-28 07:53:21,103 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:53:21,103 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:53:21,103 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:53:21,104 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:53:21,104 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:53:21,104 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_NPP']
2025-06-28 07:53:21,105 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:53:21,106 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:53:21,110 - __main__ - INFO - Splitting data...
2025-06-28 07:53:21,110 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:53:21,111 - __main__ - INFO - Creating model...
2025-06-28 07:53:21,111 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:53:21,111 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:53:21,111 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:53:21,111 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:53:21,111 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:53:21,111 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:53:21,111 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:53:21,111 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:53:21,174 - models.combined_model - INFO - Model initialized with 292356 parameters
2025-06-28 07:53:21,174 - __main__ - INFO - Initializing trainer...
2025-06-28 07:53:22,930 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:53:22,930 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:53:22,930 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:53:23,551 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3883, Val Loss: 0.0270
2025-06-28 07:53:23,601 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:53:23,847 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0252, Val Loss: 0.0191
2025-06-28 07:53:23,855 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:53:23,855 - training.trainer - INFO - Training completed
2025-06-28 07:53:23,855 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:53:23,871 - training.trainer - INFO - Test metrics: {'scalar_rmse': np.float64(0.13731477789884183), 'scalar_mse': 0.018855348229408264, 'vector_rmse': np.float64(0.01766916547701457), 'vector_mse': 0.00031219940865412354, 'matrix_rmse': np.float64(0.016123031787183648), 'matrix_mse': 0.0002599521540105343}
2025-06-28 07:53:23,894 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 07:53:23,909 - training.trainer - INFO - All predictions saved successfully
2025-06-28 07:53:24,147 - training.trainer - ERROR - Training pipeline failed: 
Module 'CombinedModel' has no attribute 'model_config' (This attribute exists on the Python module, but we failed to convert Python type: 'config.training_config.ModelConfig' to a TorchScript type. Only tensors and (possibly nested) tuples of tensors, lists, or dicts are supported as inputs or outputs of traced functions, but instead got value of type ModelConfig.. Its type was inferred; try adding a type annotation for the attribute.):
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/AImodel/models/combined_model.py", line 289
        
        # Reshape for transformer
        combined_tokens = combined_projected.view(batch_size, self.model_config.num_tokens, self.token_dim)
                                                              ~~~~~~~~~~~~~~~~~ <--- HERE
        
        # Apply transformer fusion

2025-06-28 07:53:24,147 - __main__ - ERROR - Training failed: 
Module 'CombinedModel' has no attribute 'model_config' (This attribute exists on the Python module, but we failed to convert Python type: 'config.training_config.ModelConfig' to a TorchScript type. Only tensors and (possibly nested) tuples of tensors, lists, or dicts are supported as inputs or outputs of traced functions, but instead got value of type ModelConfig.. Its type was inferred; try adding a type annotation for the attribute.):
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/AImodel/models/combined_model.py", line 289
        
        # Reshape for transformer
        combined_tokens = combined_projected.view(batch_size, self.model_config.num_tokens, self.token_dim)
                                                              ~~~~~~~~~~~~~~~~~ <--- HERE
        
        # Apply transformer fusion

2025-06-28 07:54:05,764 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:54:05,764 - __main__ - INFO - Initializing data loader...
2025-06-28 07:54:05,764 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:54:05,764 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:54:05,765 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:54:05,765 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:54:05,765 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:54:05,765 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:54:12,651 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:54:12,652 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:54:12,654 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:54:12,656 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:54:12,656 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:54:12,685 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:54:12,696 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:54:12,698 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:54:13,054 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,055 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,058 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,060 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,061 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,061 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,062 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,063 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,063 - data.data_loader - INFO - Found 78 static columns: ['PCT_NATVEG', 'SOIL_ORDER', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'LABILE_P', 'PCT_CLAY_8', 'abm', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_1', 'Longitude', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'NPP', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_SAND_3', 'Y_HR', 'PCT_CLAY_3', 'PCT_SAND_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_CLAY_4', 'Y_AR', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'PCT_SAND_0', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'LANDFRAC_PFT', 'AREA', 'SNOWDP', 'PCT_CLAY_1', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_NAT_PFT_5', 'PCT_CLAY_9', 'GPP', 'SCALARAVG_vr_13', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'landfrac', 'PCT_SAND_4', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_9', 'Latitude', 'PCT_SAND_8', 'SCALARAVG_vr_4', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'APATITE_P', 'PCT_CLAY_7', 'HR', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SECONDARY_P', 'AR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_6', 'PCT_CLAY_5', 'PCT_NAT_PFT_12', 'SOIL_COLOR', 'peatf', 'H2OSOI_10CM', 'Y_GPP', 'SCALARAVG_vr_12', 'Y_NPP', 'PCT_CLAY_6', 'SCALARAVG_vr_5']
2025-06-28 07:54:13,063 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:54:13,063 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NATVEG', 'SOIL_ORDER', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'LABILE_P', 'PCT_CLAY_8', 'abm', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_1', 'Longitude', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'NPP', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_SAND_3', 'Y_HR', 'PCT_CLAY_3', 'PCT_SAND_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_CLAY_4', 'Y_AR', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'PCT_SAND_0', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'LANDFRAC_PFT', 'AREA', 'SNOWDP', 'PCT_CLAY_1', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_NAT_PFT_5', 'PCT_CLAY_9', 'GPP', 'SCALARAVG_vr_13', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'landfrac', 'PCT_SAND_4', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_9', 'Latitude', 'PCT_SAND_8', 'SCALARAVG_vr_4', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'APATITE_P', 'PCT_CLAY_7', 'HR', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SECONDARY_P', 'AR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_6', 'PCT_CLAY_5', 'PCT_NAT_PFT_12', 'SOIL_COLOR', 'peatf', 'H2OSOI_10CM', 'Y_GPP', 'SCALARAVG_vr_12', 'Y_NPP', 'PCT_CLAY_6', 'SCALARAVG_vr_5'], 'target_columns': ['Y_tlai', 'Y_HR', 'Y_soil4c_vr', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_cwdc_vr', 'Y_NPP', 'Y_AR', 'Y_deadstemc'], 'x_list_columns_1d': ['deadcrootc'], 'y_list_columns_1d': ['Y_deadcrootc'], 'x_list_columns_2d': ['soil3c_vr'], 'y_list_columns_2d': ['Y_soil3c_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:54:13,063 - __main__ - INFO - Normalizing data...
2025-06-28 07:54:13,063 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:54:13,063 - data.data_loader - WARNING - Column Y_tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,064 - data.data_loader - WARNING - Column soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,066 - data.data_loader - WARNING - Column cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,067 - data.data_loader - WARNING - Column Y_soil4c_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,068 - data.data_loader - WARNING - Column tlai contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,068 - data.data_loader - WARNING - Column Y_deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,069 - data.data_loader - WARNING - Column Y_cwdc_vr contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,070 - data.data_loader - WARNING - Column deadstemc contains list data but was not in list configurations. Skipping from static columns.
2025-06-28 07:54:13,070 - data.data_loader - INFO - Found 78 static columns: ['PCT_NATVEG', 'SOIL_ORDER', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'LABILE_P', 'PCT_CLAY_8', 'abm', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_1', 'Longitude', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'NPP', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_SAND_3', 'Y_HR', 'PCT_CLAY_3', 'PCT_SAND_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_CLAY_4', 'Y_AR', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'PCT_SAND_0', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'LANDFRAC_PFT', 'AREA', 'SNOWDP', 'PCT_CLAY_1', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_NAT_PFT_5', 'PCT_CLAY_9', 'GPP', 'SCALARAVG_vr_13', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'landfrac', 'PCT_SAND_4', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_9', 'Latitude', 'PCT_SAND_8', 'SCALARAVG_vr_4', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'APATITE_P', 'PCT_CLAY_7', 'HR', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SECONDARY_P', 'AR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_6', 'PCT_CLAY_5', 'PCT_NAT_PFT_12', 'SOIL_COLOR', 'peatf', 'H2OSOI_10CM', 'Y_GPP', 'SCALARAVG_vr_12', 'Y_NPP', 'PCT_CLAY_6', 'SCALARAVG_vr_5']
2025-06-28 07:54:13,071 - data.data_loader - INFO - Found 9 target columns
2025-06-28 07:54:13,071 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:54:13,103 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:54:13,110 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NATVEG', 'SOIL_ORDER', 'PCT_NAT_PFT_7', 'PCT_CLAY_0', 'LABILE_P', 'PCT_CLAY_8', 'abm', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_1', 'Longitude', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_SAND_2', 'NPP', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_SAND_3', 'Y_HR', 'PCT_CLAY_3', 'PCT_SAND_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'COL_FIRE_CLOSS', 'PCT_CLAY_4', 'Y_AR', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_1', 'PCT_SAND_0', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_7', 'LANDFRAC_PFT', 'AREA', 'SNOWDP', 'PCT_CLAY_1', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_NAT_PFT_5', 'PCT_CLAY_9', 'GPP', 'SCALARAVG_vr_13', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_11', 'landfrac', 'PCT_SAND_4', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_9', 'Latitude', 'PCT_SAND_8', 'SCALARAVG_vr_4', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_16', 'PCT_SAND_7', 'APATITE_P', 'PCT_CLAY_7', 'HR', 'PCT_CLAY_2', 'PCT_NAT_PFT_3', 'SECONDARY_P', 'AR', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_6', 'PCT_CLAY_5', 'PCT_NAT_PFT_12', 'SOIL_COLOR', 'peatf', 'H2OSOI_10CM', 'Y_GPP', 'SCALARAVG_vr_12', 'Y_NPP', 'PCT_CLAY_6', 'SCALARAVG_vr_5']
2025-06-28 07:54:13,111 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:54:13,111 - data.data_loader - WARNING - Skipping column Y_tlai from target normalization - contains list data
2025-06-28 07:54:13,111 - data.data_loader - WARNING - Skipping column Y_soil4c_vr from target normalization - contains list data
2025-06-28 07:54:13,112 - data.data_loader - WARNING - Skipping column Y_cwdc_vr from target normalization - contains list data
2025-06-28 07:54:13,112 - data.data_loader - WARNING - Skipping column Y_deadstemc from target normalization - contains list data
2025-06-28 07:54:13,112 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_NPP', 'Y_AR']
2025-06-28 07:54:13,113 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:54:13,114 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:54:13,115 - __main__ - INFO - Splitting data...
2025-06-28 07:54:13,115 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:54:13,116 - __main__ - INFO - Creating model...
2025-06-28 07:54:13,116 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:54:13,116 - __main__ - INFO - Detected actual 2D channels: 1
2025-06-28 07:54:13,116 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:54:13,116 - models.combined_model - INFO - Using actual 2D channels: 1
2025-06-28 07:54:13,116 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 180 (channels: 1)
2025-06-28 07:54:13,116 - models.combined_model - INFO - 1D columns: ['deadcrootc']
2025-06-28 07:54:13,116 - models.combined_model - INFO - 2D columns: ['soil3c_vr']
2025-06-28 07:54:13,116 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:54:13,127 - models.combined_model - INFO - Model initialized with 292356 parameters
2025-06-28 07:54:13,127 - __main__ - INFO - Initializing trainer...
2025-06-28 07:54:14,830 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 07:54:14,830 - __main__ - INFO - Starting training pipeline...
2025-06-28 07:54:14,830 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 07:54:15,478 - training.trainer - INFO - Epoch [1/2] - Train Loss: 0.3232, Val Loss: 0.0199
2025-06-28 07:54:15,528 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:54:15,773 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.0227, Val Loss: 0.0102
2025-06-28 07:54:15,774 - training.trainer - INFO - Loss weights - Scalar: 0.5000, Vector: 0.5000, Matrix: 0.5000
2025-06-28 07:54:15,774 - training.trainer - INFO - Training completed
2025-06-28 07:54:15,774 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 07:54:15,793 - training.trainer - INFO - Test metrics: {'scalar_rmse': np.float64(0.09792376118011015), 'scalar_mse': 0.009589063003659248, 'vector_rmse': np.float64(0.015259465679425956), 'vector_mse': 0.00023285129282157868, 'matrix_rmse': np.float64(0.01617485981154346), 'matrix_mse': 0.0002616260899230838}
2025-06-28 07:54:15,815 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 07:54:15,867 - training.trainer - INFO - All predictions saved successfully
2025-06-28 07:54:15,875 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 07:54:15,876 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 07:54:16,365 - training.trainer - INFO - Training curves saved to training_curves.png
2025-06-28 07:54:16,365 - __main__ - INFO - Training completed successfully!
2025-06-28 07:54:16,365 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.09792376118011015), 'scalar_mse': 0.009589063003659248, 'vector_rmse': np.float64(0.015259465679425956), 'vector_mse': 0.00023285129282157868, 'matrix_rmse': np.float64(0.01617485981154346), 'matrix_mse': 0.0002616260899230838}
2025-06-28 07:59:11,027 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:59:11,027 - __main__ - ERROR - Training failed: TrainingConfig.__init__() got an unexpected keyword argument 'max_files'
2025-06-28 07:59:43,002 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 07:59:43,002 - __main__ - INFO - Initializing data loader...
2025-06-28 07:59:43,002 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 07:59:43,002 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 07:59:43,003 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 07:59:43,003 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 07:59:43,003 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 07:59:43,003 - data.data_loader - INFO - Total files to load: 3
2025-06-28 07:59:50,060 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 07:59:50,060 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 07:59:50,062 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 07:59:50,064 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 07:59:50,064 - data.data_loader - INFO - Processing time series data...
2025-06-28 07:59:50,092 - data.data_loader - INFO - Processing list columns...
2025-06-28 07:59:50,132 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 07:59:50,134 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 07:59:50,511 - data.data_loader - INFO - Found 78 static columns: ['GPP', 'PCT_CLAY_6', 'SCALARAVG_vr_9', 'Longitude', 'COL_FIRE_CLOSS', 'Y_HR', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_10', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_9', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_4', 'SCALARAVG_vr_4', 'LABILE_P', 'PCT_SAND_0', 'PCT_NAT_PFT_16', 'Y_NPP', 'PCT_CLAY_1', 'PCT_SAND_8', 'PCT_NAT_PFT_0', 'PCT_SAND_1', 'PCT_CLAY_5', 'HR', 'SCALARAVG_vr_7', 'SCALARAVG_vr_3', 'PCT_CLAY_7', 'APATITE_P', 'PCT_SAND_5', 'landfrac', 'Latitude', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_7', 'PCT_NATVEG', 'AREA', 'SECONDARY_P', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'SCALARAVG_vr_13', 'SCALARAVG_vr_5', 'NPP', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'SNOWDP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_14', 'abm', 'Y_AR', 'PCT_SAND_3', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_12', 'Y_GPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_2', 'PCT_CLAY_8', 'PCT_NAT_PFT_3']
2025-06-28 07:59:50,512 - data.data_loader - INFO - Found 5 target columns
2025-06-28 07:59:50,512 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['GPP', 'PCT_CLAY_6', 'SCALARAVG_vr_9', 'Longitude', 'COL_FIRE_CLOSS', 'Y_HR', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_10', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_9', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_4', 'SCALARAVG_vr_4', 'LABILE_P', 'PCT_SAND_0', 'PCT_NAT_PFT_16', 'Y_NPP', 'PCT_CLAY_1', 'PCT_SAND_8', 'PCT_NAT_PFT_0', 'PCT_SAND_1', 'PCT_CLAY_5', 'HR', 'SCALARAVG_vr_7', 'SCALARAVG_vr_3', 'PCT_CLAY_7', 'APATITE_P', 'PCT_SAND_5', 'landfrac', 'Latitude', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_7', 'PCT_NATVEG', 'AREA', 'SECONDARY_P', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'SCALARAVG_vr_13', 'SCALARAVG_vr_5', 'NPP', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'SNOWDP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_14', 'abm', 'Y_AR', 'PCT_SAND_3', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_12', 'Y_GPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_2', 'PCT_CLAY_8', 'PCT_NAT_PFT_3'], 'target_columns': ['Y_HR', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 07:59:50,512 - __main__ - INFO - Normalizing data...
2025-06-28 07:59:50,512 - data.data_loader - INFO - Normalizing data...
2025-06-28 07:59:50,517 - data.data_loader - INFO - Found 78 static columns: ['GPP', 'PCT_CLAY_6', 'SCALARAVG_vr_9', 'Longitude', 'COL_FIRE_CLOSS', 'Y_HR', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_10', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_9', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_4', 'SCALARAVG_vr_4', 'LABILE_P', 'PCT_SAND_0', 'PCT_NAT_PFT_16', 'Y_NPP', 'PCT_CLAY_1', 'PCT_SAND_8', 'PCT_NAT_PFT_0', 'PCT_SAND_1', 'PCT_CLAY_5', 'HR', 'SCALARAVG_vr_7', 'SCALARAVG_vr_3', 'PCT_CLAY_7', 'APATITE_P', 'PCT_SAND_5', 'landfrac', 'Latitude', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_7', 'PCT_NATVEG', 'AREA', 'SECONDARY_P', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'SCALARAVG_vr_13', 'SCALARAVG_vr_5', 'NPP', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'SNOWDP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_14', 'abm', 'Y_AR', 'PCT_SAND_3', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_12', 'Y_GPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_2', 'PCT_CLAY_8', 'PCT_NAT_PFT_3']
2025-06-28 07:59:50,517 - data.data_loader - INFO - Found 5 target columns
2025-06-28 07:59:50,517 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 07:59:50,554 - data.data_loader - INFO - Normalizing static data...
2025-06-28 07:59:50,560 - data.data_loader - INFO - Normalizing 78 static columns: ['GPP', 'PCT_CLAY_6', 'SCALARAVG_vr_9', 'Longitude', 'COL_FIRE_CLOSS', 'Y_HR', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_10', 'peatf', 'PCT_NAT_PFT_6', 'PCT_SAND_9', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_4', 'SCALARAVG_vr_4', 'LABILE_P', 'PCT_SAND_0', 'PCT_NAT_PFT_16', 'Y_NPP', 'PCT_CLAY_1', 'PCT_SAND_8', 'PCT_NAT_PFT_0', 'PCT_SAND_1', 'PCT_CLAY_5', 'HR', 'SCALARAVG_vr_7', 'SCALARAVG_vr_3', 'PCT_CLAY_7', 'APATITE_P', 'PCT_SAND_5', 'landfrac', 'Latitude', 'PCT_NAT_PFT_11', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_7', 'PCT_NATVEG', 'AREA', 'SECONDARY_P', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'PCT_CLAY_9', 'SCALARAVG_vr_13', 'SCALARAVG_vr_5', 'NPP', 'PCT_SAND_2', 'SCALARAVG_vr_1', 'LANDFRAC_PFT', 'SCALARAVG_vr_2', 'SNOWDP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_14', 'abm', 'Y_AR', 'PCT_SAND_3', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_12', 'Y_GPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_15', 'SOIL_COLOR', 'AR', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_2', 'PCT_CLAY_8', 'PCT_NAT_PFT_3']
2025-06-28 07:59:50,562 - data.data_loader - INFO - Normalizing target data...
2025-06-28 07:59:50,563 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR']
2025-06-28 07:59:50,563 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 07:59:50,567 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 07:59:50,570 - __main__ - INFO - Splitting data...
2025-06-28 07:59:50,570 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 07:59:50,570 - __main__ - INFO - Creating model...
2025-06-28 07:59:50,570 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 07:59:50,570 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 07:59:50,570 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 07:59:50,570 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 07:59:50,570 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 07:59:50,570 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 07:59:50,570 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 07:59:50,570 - models.combined_model - INFO - Vector length config: 16
2025-06-28 07:59:50,587 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 07:59:50,587 - __main__ - INFO - Initializing trainer...
2025-06-28 07:59:50,935 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 07:59:52,338 - __main__ - ERROR - Training failed: ReduceLROnPlateau.__init__() got an unexpected keyword argument 'verbose'
2025-06-28 08:01:02,133 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:01:02,133 - __main__ - INFO - Initializing data loader...
2025-06-28 08:01:02,134 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:01:02,134 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:01:02,135 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:01:02,135 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:01:02,135 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:01:02,135 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:01:08,956 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:01:08,956 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:01:08,958 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:01:08,960 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:01:08,960 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:01:08,988 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:01:09,020 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:01:09,023 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:01:09,415 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'SCALARAVG_vr_12', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_2', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SECONDARY_P', 'Y_NPP', 'SCALARAVG_vr_0', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'NPP', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'landfrac', 'PCT_SAND_8', 'PCT_CLAY_0', 'LABILE_P', 'SCALARAVG_vr_7', 'SCALARAVG_vr_9', 'SCALARAVG_vr_4', 'PCT_CLAY_8', 'abm', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'LANDFRAC_PFT', 'PCT_NAT_PFT_12', 'PCT_CLAY_2', 'GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'Y_HR', 'PCT_NAT_PFT_6', 'PCT_SAND_0', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'AR', 'PCT_NATVEG', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_11', 'Y_AR', 'PCT_NAT_PFT_8', 'PCT_CLAY_3', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_4', 'SNOWDP', 'peatf', 'AREA', 'COL_FIRE_CLOSS', 'Latitude', 'PCT_SAND_1', 'HR', 'SCALARAVG_vr_13', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_CLAY_1', 'Longitude', 'OCCLUDED_P']
2025-06-28 08:01:09,415 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:01:09,415 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'SCALARAVG_vr_12', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_2', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SECONDARY_P', 'Y_NPP', 'SCALARAVG_vr_0', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'NPP', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'landfrac', 'PCT_SAND_8', 'PCT_CLAY_0', 'LABILE_P', 'SCALARAVG_vr_7', 'SCALARAVG_vr_9', 'SCALARAVG_vr_4', 'PCT_CLAY_8', 'abm', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'LANDFRAC_PFT', 'PCT_NAT_PFT_12', 'PCT_CLAY_2', 'GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'Y_HR', 'PCT_NAT_PFT_6', 'PCT_SAND_0', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'AR', 'PCT_NATVEG', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_11', 'Y_AR', 'PCT_NAT_PFT_8', 'PCT_CLAY_3', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_4', 'SNOWDP', 'peatf', 'AREA', 'COL_FIRE_CLOSS', 'Latitude', 'PCT_SAND_1', 'HR', 'SCALARAVG_vr_13', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_CLAY_1', 'Longitude', 'OCCLUDED_P'], 'target_columns': ['Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:01:09,415 - __main__ - INFO - Normalizing data...
2025-06-28 08:01:09,415 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:01:09,421 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'SCALARAVG_vr_12', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_2', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SECONDARY_P', 'Y_NPP', 'SCALARAVG_vr_0', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'NPP', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'landfrac', 'PCT_SAND_8', 'PCT_CLAY_0', 'LABILE_P', 'SCALARAVG_vr_7', 'SCALARAVG_vr_9', 'SCALARAVG_vr_4', 'PCT_CLAY_8', 'abm', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'LANDFRAC_PFT', 'PCT_NAT_PFT_12', 'PCT_CLAY_2', 'GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'Y_HR', 'PCT_NAT_PFT_6', 'PCT_SAND_0', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'AR', 'PCT_NATVEG', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_11', 'Y_AR', 'PCT_NAT_PFT_8', 'PCT_CLAY_3', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_4', 'SNOWDP', 'peatf', 'AREA', 'COL_FIRE_CLOSS', 'Latitude', 'PCT_SAND_1', 'HR', 'SCALARAVG_vr_13', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_CLAY_1', 'Longitude', 'OCCLUDED_P']
2025-06-28 08:01:09,421 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:01:09,421 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:01:09,453 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:01:09,459 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_14', 'SCALARAVG_vr_12', 'PCT_SAND_3', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_2', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SECONDARY_P', 'Y_NPP', 'SCALARAVG_vr_0', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_5', 'NPP', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'landfrac', 'PCT_SAND_8', 'PCT_CLAY_0', 'LABILE_P', 'SCALARAVG_vr_7', 'SCALARAVG_vr_9', 'SCALARAVG_vr_4', 'PCT_CLAY_8', 'abm', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'PCT_SAND_9', 'SOIL_ORDER', 'Y_GPP', 'PCT_SAND_2', 'SCALARAVG_vr_3', 'LANDFRAC_PFT', 'PCT_NAT_PFT_12', 'PCT_CLAY_2', 'GPP', 'PCT_NAT_PFT_2', 'H2OSOI_10CM', 'Y_HR', 'PCT_NAT_PFT_6', 'PCT_SAND_0', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_6', 'PCT_CLAY_6', 'AR', 'PCT_NATVEG', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_11', 'Y_AR', 'PCT_NAT_PFT_8', 'PCT_CLAY_3', 'PCT_SAND_5', 'PCT_NAT_PFT_9', 'SOIL_COLOR', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_11', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_4', 'SNOWDP', 'peatf', 'AREA', 'COL_FIRE_CLOSS', 'Latitude', 'PCT_SAND_1', 'HR', 'SCALARAVG_vr_13', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_CLAY_1', 'Longitude', 'OCCLUDED_P']
2025-06-28 08:01:09,462 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:01:09,463 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR']
2025-06-28 08:01:09,464 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:01:09,468 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:01:09,471 - __main__ - INFO - Splitting data...
2025-06-28 08:01:09,471 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:01:09,472 - __main__ - INFO - Creating model...
2025-06-28 08:01:09,472 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:01:09,472 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:01:09,472 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:01:09,472 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:01:09,472 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:01:09,472 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:01:09,472 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:01:09,472 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:01:09,501 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:01:09,501 - __main__ - INFO - Initializing trainer...
2025-06-28 08:01:09,803 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:01:11,206 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:01:11,206 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:01:11,206 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:01:11,206 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:01:11,206 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:01:11,207 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:01:11,207 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:01:11,207 - training.trainer - ERROR - Training pipeline failed: 'TrainingConfig' object has no attribute 'epochs'
2025-06-28 08:01:11,207 - __main__ - ERROR - Training failed: 'TrainingConfig' object has no attribute 'epochs'
2025-06-28 08:02:04,193 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:02:04,193 - __main__ - INFO - Initializing data loader...
2025-06-28 08:02:04,193 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:02:04,193 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:02:04,193 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:02:04,194 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:02:04,194 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:02:04,194 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:02:11,577 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:02:11,578 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:02:11,579 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:02:11,581 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:02:11,581 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:02:11,610 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:02:11,643 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:02:11,645 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:02:12,045 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'APATITE_P', 'PCT_NAT_PFT_4', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SOIL_COLOR', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_5', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'Y_GPP', 'Y_NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_NAT_PFT_12', 'SOIL_ORDER', 'peatf', 'SCALARAVG_vr_9', 'Latitude', 'PCT_SAND_8', 'landfrac', 'PCT_SAND_5', 'PCT_NAT_PFT_14', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'SECONDARY_P', 'PCT_SAND_1', 'abm', 'PCT_CLAY_8', 'SNOWDP', 'PCT_CLAY_0', 'PCT_SAND_3', 'AR', 'SCALARAVG_vr_11', 'PCT_NATVEG', 'LANDFRAC_PFT', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'PCT_SAND_0', 'Y_AR', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_6', 'PCT_CLAY_7', 'PCT_SAND_4', 'PCT_CLAY_3', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'GPP', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_12', 'H2OSOI_10CM', 'PCT_NAT_PFT_11', 'AREA', 'PCT_NAT_PFT_7', 'LABILE_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'Longitude', 'SCALARAVG_vr_10', 'Y_HR', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'NPP', 'HR', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_NAT_PFT_15']
2025-06-28 08:02:12,045 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:02:12,045 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'APATITE_P', 'PCT_NAT_PFT_4', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SOIL_COLOR', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_5', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'Y_GPP', 'Y_NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_NAT_PFT_12', 'SOIL_ORDER', 'peatf', 'SCALARAVG_vr_9', 'Latitude', 'PCT_SAND_8', 'landfrac', 'PCT_SAND_5', 'PCT_NAT_PFT_14', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'SECONDARY_P', 'PCT_SAND_1', 'abm', 'PCT_CLAY_8', 'SNOWDP', 'PCT_CLAY_0', 'PCT_SAND_3', 'AR', 'SCALARAVG_vr_11', 'PCT_NATVEG', 'LANDFRAC_PFT', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'PCT_SAND_0', 'Y_AR', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_6', 'PCT_CLAY_7', 'PCT_SAND_4', 'PCT_CLAY_3', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'GPP', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_12', 'H2OSOI_10CM', 'PCT_NAT_PFT_11', 'AREA', 'PCT_NAT_PFT_7', 'LABILE_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'Longitude', 'SCALARAVG_vr_10', 'Y_HR', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'NPP', 'HR', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_NAT_PFT_15'], 'target_columns': ['Y_GPP', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:02:12,046 - __main__ - INFO - Normalizing data...
2025-06-28 08:02:12,046 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:02:12,052 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'APATITE_P', 'PCT_NAT_PFT_4', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SOIL_COLOR', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_5', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'Y_GPP', 'Y_NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_NAT_PFT_12', 'SOIL_ORDER', 'peatf', 'SCALARAVG_vr_9', 'Latitude', 'PCT_SAND_8', 'landfrac', 'PCT_SAND_5', 'PCT_NAT_PFT_14', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'SECONDARY_P', 'PCT_SAND_1', 'abm', 'PCT_CLAY_8', 'SNOWDP', 'PCT_CLAY_0', 'PCT_SAND_3', 'AR', 'SCALARAVG_vr_11', 'PCT_NATVEG', 'LANDFRAC_PFT', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'PCT_SAND_0', 'Y_AR', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_6', 'PCT_CLAY_7', 'PCT_SAND_4', 'PCT_CLAY_3', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'GPP', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_12', 'H2OSOI_10CM', 'PCT_NAT_PFT_11', 'AREA', 'PCT_NAT_PFT_7', 'LABILE_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'Longitude', 'SCALARAVG_vr_10', 'Y_HR', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'NPP', 'HR', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_NAT_PFT_15']
2025-06-28 08:02:12,052 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:02:12,052 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:02:12,082 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:02:12,090 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_6', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'APATITE_P', 'PCT_NAT_PFT_4', 'PCT_CLAY_9', 'PCT_NAT_PFT_10', 'SOIL_COLOR', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_1', 'PCT_CLAY_5', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'Y_GPP', 'Y_NPP', 'PCT_NAT_PFT_0', 'PCT_SAND_2', 'PCT_SAND_6', 'PCT_NAT_PFT_12', 'SOIL_ORDER', 'peatf', 'SCALARAVG_vr_9', 'Latitude', 'PCT_SAND_8', 'landfrac', 'PCT_SAND_5', 'PCT_NAT_PFT_14', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_1', 'SCALARAVG_vr_14', 'SECONDARY_P', 'PCT_SAND_1', 'abm', 'PCT_CLAY_8', 'SNOWDP', 'PCT_CLAY_0', 'PCT_SAND_3', 'AR', 'SCALARAVG_vr_11', 'PCT_NATVEG', 'LANDFRAC_PFT', 'SCALARAVG_vr_0', 'PCT_SAND_7', 'PCT_SAND_0', 'Y_AR', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_6', 'PCT_CLAY_7', 'PCT_SAND_4', 'PCT_CLAY_3', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_9', 'GPP', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_12', 'H2OSOI_10CM', 'PCT_NAT_PFT_11', 'AREA', 'PCT_NAT_PFT_7', 'LABILE_P', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'Longitude', 'SCALARAVG_vr_10', 'Y_HR', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'NPP', 'HR', 'SCALARAVG_vr_13', 'PCT_CLAY_1', 'PCT_NAT_PFT_15']
2025-06-28 08:02:12,091 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:02:12,091 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_HR']
2025-06-28 08:02:12,092 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:02:12,095 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:02:12,098 - __main__ - INFO - Splitting data...
2025-06-28 08:02:12,098 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:02:12,099 - __main__ - INFO - Creating model...
2025-06-28 08:02:12,099 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:02:12,099 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:02:12,099 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:02:12,099 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:02:12,099 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:02:12,099 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:02:12,099 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:02:12,099 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:02:12,113 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:02:12,113 - __main__ - INFO - Initializing trainer...
2025-06-28 08:02:12,432 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:02:13,824 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:02:13,824 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:02:13,824 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:02:13,824 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:02:13,824 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:02:13,825 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:02:13,825 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:02:13,825 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:02:13,825 - training.trainer - ERROR - Training pipeline failed: 'y_list_1d'
2025-06-28 08:02:13,825 - __main__ - ERROR - Training failed: 'y_list_1d'
2025-06-28 08:03:49,882 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:03:49,882 - __main__ - INFO - Initializing data loader...
2025-06-28 08:03:49,882 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:03:49,882 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:03:49,882 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:03:49,883 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:03:49,883 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:03:49,883 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:03:56,912 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:03:56,913 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:03:56,915 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:03:56,917 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:03:56,917 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:03:56,947 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:03:56,979 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:03:56,982 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:03:57,355 - data.data_loader - INFO - Found 78 static columns: ['NPP', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_15', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'HR', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'peatf', 'Y_NPP', 'landfrac', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_5', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_5', 'PCT_SAND_1', 'PCT_SAND_6', 'AREA', 'SOIL_ORDER', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_1', 'PCT_SAND_3', 'PCT_NATVEG', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_7', 'Latitude', 'SNOWDP', 'LABILE_P', 'Y_AR', 'OCCLUDED_P', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'PCT_SAND_9', 'SECONDARY_P', 'SCALARAVG_vr_1', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'APATITE_P', 'AR', 'Y_HR', 'PCT_NAT_PFT_11', 'PCT_SAND_4', 'PCT_CLAY_8', 'PCT_NAT_PFT_2', 'LANDFRAC_PFT', 'PCT_CLAY_6', 'PCT_SAND_2', 'PCT_NAT_PFT_10']
2025-06-28 08:03:57,355 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:03:57,355 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['NPP', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_15', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'HR', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'peatf', 'Y_NPP', 'landfrac', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_5', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_5', 'PCT_SAND_1', 'PCT_SAND_6', 'AREA', 'SOIL_ORDER', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_1', 'PCT_SAND_3', 'PCT_NATVEG', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_7', 'Latitude', 'SNOWDP', 'LABILE_P', 'Y_AR', 'OCCLUDED_P', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'PCT_SAND_9', 'SECONDARY_P', 'SCALARAVG_vr_1', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'APATITE_P', 'AR', 'Y_HR', 'PCT_NAT_PFT_11', 'PCT_SAND_4', 'PCT_CLAY_8', 'PCT_NAT_PFT_2', 'LANDFRAC_PFT', 'PCT_CLAY_6', 'PCT_SAND_2', 'PCT_NAT_PFT_10'], 'target_columns': ['Y_GPP', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:03:57,355 - __main__ - INFO - Normalizing data...
2025-06-28 08:03:57,355 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:03:57,360 - data.data_loader - INFO - Found 78 static columns: ['NPP', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_15', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'HR', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'peatf', 'Y_NPP', 'landfrac', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_5', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_5', 'PCT_SAND_1', 'PCT_SAND_6', 'AREA', 'SOIL_ORDER', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_1', 'PCT_SAND_3', 'PCT_NATVEG', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_7', 'Latitude', 'SNOWDP', 'LABILE_P', 'Y_AR', 'OCCLUDED_P', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'PCT_SAND_9', 'SECONDARY_P', 'SCALARAVG_vr_1', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'APATITE_P', 'AR', 'Y_HR', 'PCT_NAT_PFT_11', 'PCT_SAND_4', 'PCT_CLAY_8', 'PCT_NAT_PFT_2', 'LANDFRAC_PFT', 'PCT_CLAY_6', 'PCT_SAND_2', 'PCT_NAT_PFT_10']
2025-06-28 08:03:57,360 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:03:57,360 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:03:57,393 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:03:57,399 - data.data_loader - INFO - Normalizing 78 static columns: ['NPP', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_0', 'PCT_SAND_0', 'PCT_NAT_PFT_15', 'Y_GPP', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'PCT_SAND_8', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'HR', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'peatf', 'Y_NPP', 'landfrac', 'SCALARAVG_vr_9', 'SCALARAVG_vr_8', 'PCT_CLAY_5', 'SCALARAVG_vr_5', 'PCT_CLAY_7', 'PCT_SAND_5', 'PCT_SAND_1', 'PCT_SAND_6', 'AREA', 'SOIL_ORDER', 'PCT_CLAY_2', 'SCALARAVG_vr_2', 'GPP', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_11', 'abm', 'SOIL_COLOR', 'SCALARAVG_vr_6', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_4', 'PCT_CLAY_1', 'PCT_SAND_3', 'PCT_NATVEG', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_NAT_PFT_7', 'Latitude', 'SNOWDP', 'LABILE_P', 'Y_AR', 'OCCLUDED_P', 'SCALARAVG_vr_12', 'PCT_CLAY_3', 'PCT_SAND_9', 'SECONDARY_P', 'SCALARAVG_vr_1', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'APATITE_P', 'AR', 'Y_HR', 'PCT_NAT_PFT_11', 'PCT_SAND_4', 'PCT_CLAY_8', 'PCT_NAT_PFT_2', 'LANDFRAC_PFT', 'PCT_CLAY_6', 'PCT_SAND_2', 'PCT_NAT_PFT_10']
2025-06-28 08:03:57,401 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:03:57,401 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR']
2025-06-28 08:03:57,402 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:03:57,406 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:03:57,409 - __main__ - INFO - Splitting data...
2025-06-28 08:03:57,409 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:03:57,409 - __main__ - INFO - Creating model...
2025-06-28 08:03:57,409 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:03:57,409 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:03:57,410 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:03:57,410 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:03:57,410 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:03:57,410 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:03:57,410 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:03:57,410 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:03:57,433 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:03:57,433 - __main__ - INFO - Initializing trainer...
2025-06-28 08:03:57,750 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:03:59,112 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:03:59,113 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:03:59,113 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:03:59,113 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:03:59,113 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:03:59,114 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:03:59,114 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:03:59,114 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:03:59,114 - training.trainer - ERROR - Training pipeline failed: 'dict' object has no attribute 'size'
2025-06-28 08:03:59,114 - __main__ - ERROR - Training failed: 'dict' object has no attribute 'size'
2025-06-28 08:05:24,408 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:05:24,409 - __main__ - INFO - Initializing data loader...
2025-06-28 08:05:24,409 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:05:24,409 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:05:24,409 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:05:24,409 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:05:24,409 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:05:24,410 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:05:31,304 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:05:31,305 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:05:31,307 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:05:31,309 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:05:31,309 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:05:31,337 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:05:31,370 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:05:31,373 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:05:31,738 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_5', 'PCT_NAT_PFT_5', 'Longitude', 'SCALARAVG_vr_11', 'PCT_SAND_2', 'LABILE_P', 'PCT_CLAY_2', 'NPP', 'SOIL_COLOR', 'HR', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'PCT_SAND_5', 'SNOWDP', 'PCT_CLAY_6', 'PCT_CLAY_7', 'Y_NPP', 'SCALARAVG_vr_4', 'Latitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'abm', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_12', 'landfrac', 'APATITE_P', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_SAND_8', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'peatf', 'PCT_NATVEG', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'AR', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_SAND_7', 'PCT_SAND_9', 'LANDFRAC_PFT', 'Y_AR', 'GPP', 'Y_GPP', 'SCALARAVG_vr_7', 'AREA', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_CLAY_8', 'Y_HR', 'SOIL_ORDER', 'PCT_CLAY_1']
2025-06-28 08:05:31,738 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:05:31,738 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_5', 'PCT_NAT_PFT_5', 'Longitude', 'SCALARAVG_vr_11', 'PCT_SAND_2', 'LABILE_P', 'PCT_CLAY_2', 'NPP', 'SOIL_COLOR', 'HR', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'PCT_SAND_5', 'SNOWDP', 'PCT_CLAY_6', 'PCT_CLAY_7', 'Y_NPP', 'SCALARAVG_vr_4', 'Latitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'abm', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_12', 'landfrac', 'APATITE_P', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_SAND_8', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'peatf', 'PCT_NATVEG', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'AR', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_SAND_7', 'PCT_SAND_9', 'LANDFRAC_PFT', 'Y_AR', 'GPP', 'Y_GPP', 'SCALARAVG_vr_7', 'AREA', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_CLAY_8', 'Y_HR', 'SOIL_ORDER', 'PCT_CLAY_1'], 'target_columns': ['Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:05:31,738 - __main__ - INFO - Normalizing data...
2025-06-28 08:05:31,738 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:05:31,745 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_5', 'PCT_NAT_PFT_5', 'Longitude', 'SCALARAVG_vr_11', 'PCT_SAND_2', 'LABILE_P', 'PCT_CLAY_2', 'NPP', 'SOIL_COLOR', 'HR', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'PCT_SAND_5', 'SNOWDP', 'PCT_CLAY_6', 'PCT_CLAY_7', 'Y_NPP', 'SCALARAVG_vr_4', 'Latitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'abm', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_12', 'landfrac', 'APATITE_P', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_SAND_8', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'peatf', 'PCT_NATVEG', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'AR', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_SAND_7', 'PCT_SAND_9', 'LANDFRAC_PFT', 'Y_AR', 'GPP', 'Y_GPP', 'SCALARAVG_vr_7', 'AREA', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_CLAY_8', 'Y_HR', 'SOIL_ORDER', 'PCT_CLAY_1']
2025-06-28 08:05:31,745 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:05:31,745 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:05:31,778 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:05:31,784 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_5', 'PCT_NAT_PFT_5', 'Longitude', 'SCALARAVG_vr_11', 'PCT_SAND_2', 'LABILE_P', 'PCT_CLAY_2', 'NPP', 'SOIL_COLOR', 'HR', 'PCT_NAT_PFT_1', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'PCT_SAND_5', 'SNOWDP', 'PCT_CLAY_6', 'PCT_CLAY_7', 'Y_NPP', 'SCALARAVG_vr_4', 'Latitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'abm', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_12', 'landfrac', 'APATITE_P', 'H2OSOI_10CM', 'PCT_SAND_6', 'PCT_CLAY_9', 'PCT_SAND_8', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_7', 'peatf', 'PCT_NATVEG', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_12', 'AR', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_NAT_PFT_15', 'PCT_SAND_3', 'SCALARAVG_vr_5', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'SECONDARY_P', 'PCT_NAT_PFT_6', 'PCT_SAND_7', 'PCT_SAND_9', 'LANDFRAC_PFT', 'Y_AR', 'GPP', 'Y_GPP', 'SCALARAVG_vr_7', 'AREA', 'PCT_SAND_0', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_CLAY_8', 'Y_HR', 'SOIL_ORDER', 'PCT_CLAY_1']
2025-06-28 08:05:31,785 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:05:31,786 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP']
2025-06-28 08:05:31,787 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:05:31,790 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:05:31,794 - __main__ - INFO - Splitting data...
2025-06-28 08:05:31,794 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:05:31,794 - __main__ - INFO - Creating model...
2025-06-28 08:05:31,794 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:05:31,794 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:05:31,794 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:05:31,794 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:05:31,794 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:05:31,795 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:05:31,795 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:05:31,795 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:05:31,821 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:05:31,821 - __main__ - INFO - Initializing trainer...
2025-06-28 08:05:32,116 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:05:33,492 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:05:33,493 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:05:33,493 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:05:33,493 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:05:33,493 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:05:33,493 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:05:33,494 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:05:33,494 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:05:33,734 - training.trainer - ERROR - Training pipeline failed: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 207, in __getitem__
    return tuple(tensor[index] for tensor in self.tensors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 207, in <genexpr>
    return tuple(tensor[index] for tensor in self.tensors)
                 ~~~~~~^^^^^^^
RuntimeError: CUDA error: initialization error
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


2025-06-28 08:05:33,734 - __main__ - ERROR - Training failed: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 207, in __getitem__
    return tuple(tensor[index] for tensor in self.tensors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/cfs/cdirs/m4814/wangd/AI4BGC/ai4bgc_env/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 207, in <genexpr>
    return tuple(tensor[index] for tensor in self.tensors)
                 ~~~~~~^^^^^^^
RuntimeError: CUDA error: initialization error
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


2025-06-28 08:06:33,107 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:06:33,107 - __main__ - INFO - Initializing data loader...
2025-06-28 08:06:33,107 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:06:33,107 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:06:33,108 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:06:33,108 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:06:33,108 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:06:33,108 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:06:39,898 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:06:39,899 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:06:39,902 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:06:39,904 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:06:39,904 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:06:39,932 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:06:39,964 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:06:39,967 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:06:40,357 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_11', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_6', 'NPP', 'SCALARAVG_vr_13', 'Latitude', 'PCT_CLAY_9', 'PCT_CLAY_8', 'PCT_CLAY_0', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_14', 'LABILE_P', 'SECONDARY_P', 'SCALARAVG_vr_0', 'PCT_SAND_3', 'PCT_CLAY_7', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_SAND_4', 'Y_HR', 'PCT_CLAY_4', 'PCT_CLAY_2', 'AR', 'PCT_SAND_2', 'H2OSOI_10CM', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_CLAY_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_8', 'abm', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'GPP', 'PCT_CLAY_3', 'PCT_NAT_PFT_12', 'HR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'PCT_SAND_9', 'SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'SCALARAVG_vr_4', 'SOIL_COLOR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_9', 'Y_AR', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'landfrac', 'PCT_SAND_1', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_10', 'AREA']
2025-06-28 08:06:40,357 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:06:40,357 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_11', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_6', 'NPP', 'SCALARAVG_vr_13', 'Latitude', 'PCT_CLAY_9', 'PCT_CLAY_8', 'PCT_CLAY_0', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_14', 'LABILE_P', 'SECONDARY_P', 'SCALARAVG_vr_0', 'PCT_SAND_3', 'PCT_CLAY_7', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_SAND_4', 'Y_HR', 'PCT_CLAY_4', 'PCT_CLAY_2', 'AR', 'PCT_SAND_2', 'H2OSOI_10CM', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_CLAY_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_8', 'abm', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'GPP', 'PCT_CLAY_3', 'PCT_NAT_PFT_12', 'HR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'PCT_SAND_9', 'SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'SCALARAVG_vr_4', 'SOIL_COLOR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_9', 'Y_AR', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'landfrac', 'PCT_SAND_1', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_10', 'AREA'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_NPP', 'Y_HR', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:06:40,358 - __main__ - INFO - Normalizing data...
2025-06-28 08:06:40,358 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:06:40,363 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_11', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_6', 'NPP', 'SCALARAVG_vr_13', 'Latitude', 'PCT_CLAY_9', 'PCT_CLAY_8', 'PCT_CLAY_0', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_14', 'LABILE_P', 'SECONDARY_P', 'SCALARAVG_vr_0', 'PCT_SAND_3', 'PCT_CLAY_7', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_SAND_4', 'Y_HR', 'PCT_CLAY_4', 'PCT_CLAY_2', 'AR', 'PCT_SAND_2', 'H2OSOI_10CM', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_CLAY_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_8', 'abm', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'GPP', 'PCT_CLAY_3', 'PCT_NAT_PFT_12', 'HR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'PCT_SAND_9', 'SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'SCALARAVG_vr_4', 'SOIL_COLOR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_9', 'Y_AR', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'landfrac', 'PCT_SAND_1', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_10', 'AREA']
2025-06-28 08:06:40,363 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:06:40,363 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:06:40,392 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:06:40,398 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_11', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NATVEG', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_6', 'NPP', 'SCALARAVG_vr_13', 'Latitude', 'PCT_CLAY_9', 'PCT_CLAY_8', 'PCT_CLAY_0', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_14', 'LABILE_P', 'SECONDARY_P', 'SCALARAVG_vr_0', 'PCT_SAND_3', 'PCT_CLAY_7', 'SOIL_ORDER', 'PCT_NAT_PFT_13', 'PCT_SAND_4', 'Y_HR', 'PCT_CLAY_4', 'PCT_CLAY_2', 'AR', 'PCT_SAND_2', 'H2OSOI_10CM', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_CLAY_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_8', 'abm', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_5', 'GPP', 'PCT_CLAY_3', 'PCT_NAT_PFT_12', 'HR', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_12', 'PCT_SAND_9', 'SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'SCALARAVG_vr_4', 'SOIL_COLOR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_9', 'Y_AR', 'PCT_NAT_PFT_9', 'PCT_SAND_7', 'PCT_NAT_PFT_0', 'SNOWDP', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_8', 'OCCLUDED_P', 'SCALARAVG_vr_3', 'landfrac', 'PCT_SAND_1', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_10', 'AREA']
2025-06-28 08:06:40,400 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:06:40,400 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_NPP', 'Y_HR', 'Y_GPP']
2025-06-28 08:06:40,401 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:06:40,405 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:06:40,408 - __main__ - INFO - Splitting data...
2025-06-28 08:06:40,408 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:06:40,408 - __main__ - INFO - Creating model...
2025-06-28 08:06:40,408 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:06:40,408 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:06:40,408 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:06:40,409 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:06:40,409 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:06:40,409 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:06:40,409 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:06:40,409 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:06:40,446 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:06:40,447 - __main__ - INFO - Initializing trainer...
2025-06-28 08:06:40,774 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:06:42,283 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:06:42,283 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:06:42,283 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:06:42,283 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:06:42,283 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:06:42,283 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:06:42,284 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:06:42,284 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:06:43,190 - training.trainer - ERROR - Training pipeline failed: mat1 and mat2 shapes cannot be multiplied (32x48 and 16x32)
2025-06-28 08:06:43,190 - __main__ - ERROR - Training failed: mat1 and mat2 shapes cannot be multiplied (32x48 and 16x32)
2025-06-28 08:07:50,576 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:07:50,577 - __main__ - INFO - Initializing data loader...
2025-06-28 08:07:50,577 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:07:50,577 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:07:50,577 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:07:50,577 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:07:50,577 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:07:50,578 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:07:57,897 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:07:57,897 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:07:57,899 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:07:57,901 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:07:57,901 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:07:57,930 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:07:57,966 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:07:57,969 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:07:58,387 - data.data_loader - INFO - Found 78 static columns: ['H2OSOI_10CM', 'landfrac', 'SOIL_ORDER', 'PCT_CLAY_8', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_2', 'SNOWDP', 'PCT_NAT_PFT_3', 'AR', 'PCT_CLAY_5', 'PCT_NAT_PFT_6', 'SOIL_COLOR', 'AREA', 'PCT_SAND_9', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_1', 'Y_AR', 'SCALARAVG_vr_9', 'peatf', 'PCT_NAT_PFT_7', 'PCT_SAND_2', 'PCT_CLAY_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_11', 'SCALARAVG_vr_14', 'PCT_CLAY_9', 'PCT_NAT_PFT_15', 'PCT_SAND_0', 'HR', 'PCT_SAND_6', 'APATITE_P', 'GPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'LANDFRAC_PFT', 'SECONDARY_P', 'PCT_SAND_7', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'Y_HR', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'PCT_CLAY_2', 'abm', 'SCALARAVG_vr_10', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_8', 'PCT_SAND_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_SAND_3', 'PCT_NAT_PFT_16', 'Latitude', 'OCCLUDED_P', 'PCT_CLAY_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NATVEG', 'NPP', 'Y_GPP']
2025-06-28 08:07:58,387 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:07:58,387 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['H2OSOI_10CM', 'landfrac', 'SOIL_ORDER', 'PCT_CLAY_8', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_2', 'SNOWDP', 'PCT_NAT_PFT_3', 'AR', 'PCT_CLAY_5', 'PCT_NAT_PFT_6', 'SOIL_COLOR', 'AREA', 'PCT_SAND_9', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_1', 'Y_AR', 'SCALARAVG_vr_9', 'peatf', 'PCT_NAT_PFT_7', 'PCT_SAND_2', 'PCT_CLAY_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_11', 'SCALARAVG_vr_14', 'PCT_CLAY_9', 'PCT_NAT_PFT_15', 'PCT_SAND_0', 'HR', 'PCT_SAND_6', 'APATITE_P', 'GPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'LANDFRAC_PFT', 'SECONDARY_P', 'PCT_SAND_7', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'Y_HR', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'PCT_CLAY_2', 'abm', 'SCALARAVG_vr_10', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_8', 'PCT_SAND_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_SAND_3', 'PCT_NAT_PFT_16', 'Latitude', 'OCCLUDED_P', 'PCT_CLAY_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NATVEG', 'NPP', 'Y_GPP'], 'target_columns': ['Y_AR', 'Y_HR', 'Y_GPP', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:07:58,387 - __main__ - INFO - Normalizing data...
2025-06-28 08:07:58,387 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:07:58,394 - data.data_loader - INFO - Found 78 static columns: ['H2OSOI_10CM', 'landfrac', 'SOIL_ORDER', 'PCT_CLAY_8', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_2', 'SNOWDP', 'PCT_NAT_PFT_3', 'AR', 'PCT_CLAY_5', 'PCT_NAT_PFT_6', 'SOIL_COLOR', 'AREA', 'PCT_SAND_9', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_1', 'Y_AR', 'SCALARAVG_vr_9', 'peatf', 'PCT_NAT_PFT_7', 'PCT_SAND_2', 'PCT_CLAY_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_11', 'SCALARAVG_vr_14', 'PCT_CLAY_9', 'PCT_NAT_PFT_15', 'PCT_SAND_0', 'HR', 'PCT_SAND_6', 'APATITE_P', 'GPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'LANDFRAC_PFT', 'SECONDARY_P', 'PCT_SAND_7', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'Y_HR', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'PCT_CLAY_2', 'abm', 'SCALARAVG_vr_10', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_8', 'PCT_SAND_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_SAND_3', 'PCT_NAT_PFT_16', 'Latitude', 'OCCLUDED_P', 'PCT_CLAY_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NATVEG', 'NPP', 'Y_GPP']
2025-06-28 08:07:58,394 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:07:58,394 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:07:58,423 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:07:58,429 - data.data_loader - INFO - Normalizing 78 static columns: ['H2OSOI_10CM', 'landfrac', 'SOIL_ORDER', 'PCT_CLAY_8', 'SCALARAVG_vr_3', 'Y_NPP', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_8', 'LABILE_P', 'PCT_CLAY_0', 'PCT_NAT_PFT_2', 'SNOWDP', 'PCT_NAT_PFT_3', 'AR', 'PCT_CLAY_5', 'PCT_NAT_PFT_6', 'SOIL_COLOR', 'AREA', 'PCT_SAND_9', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_0', 'PCT_SAND_8', 'PCT_SAND_5', 'PCT_NAT_PFT_1', 'Y_AR', 'SCALARAVG_vr_9', 'peatf', 'PCT_NAT_PFT_7', 'PCT_SAND_2', 'PCT_CLAY_1', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_11', 'SCALARAVG_vr_14', 'PCT_CLAY_9', 'PCT_NAT_PFT_15', 'PCT_SAND_0', 'HR', 'PCT_SAND_6', 'APATITE_P', 'GPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_13', 'LANDFRAC_PFT', 'SECONDARY_P', 'PCT_SAND_7', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'Y_HR', 'SCALARAVG_vr_6', 'PCT_CLAY_4', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'PCT_CLAY_2', 'abm', 'SCALARAVG_vr_10', 'Y_COL_FIRE_CLOSS', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_8', 'PCT_SAND_4', 'PCT_CLAY_6', 'PCT_NAT_PFT_12', 'PCT_SAND_3', 'PCT_NAT_PFT_16', 'Latitude', 'OCCLUDED_P', 'PCT_CLAY_7', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_NATVEG', 'NPP', 'Y_GPP']
2025-06-28 08:07:58,431 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:07:58,431 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_HR', 'Y_GPP', 'Y_NPP', 'Y_COL_FIRE_CLOSS']
2025-06-28 08:07:58,432 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:07:58,436 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:07:58,439 - __main__ - INFO - Splitting data...
2025-06-28 08:07:58,439 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:07:58,439 - __main__ - INFO - Creating model...
2025-06-28 08:07:58,440 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:07:58,440 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:07:58,440 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:07:58,440 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:07:58,440 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:07:58,440 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:07:58,440 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:07:58,440 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:07:58,453 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:07:58,453 - __main__ - INFO - Initializing trainer...
2025-06-28 08:07:58,773 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:08:00,175 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:08:00,175 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:08:00,175 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:08:00,175 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:08:00,175 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:08:00,176 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:08:00,176 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:08:00,176 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:08:00,176 - training.trainer - ERROR - Training pipeline failed: 'dict' object has no attribute 'size'
2025-06-28 08:08:00,176 - __main__ - ERROR - Training failed: 'dict' object has no attribute 'size'
2025-06-28 08:08:36,440 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:08:36,440 - __main__ - INFO - Initializing data loader...
2025-06-28 08:08:36,440 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:08:36,440 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:08:36,441 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:08:36,441 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:08:36,441 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:08:36,441 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:08:43,224 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:08:43,224 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:08:43,226 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:08:43,228 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:08:43,228 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:08:43,257 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:08:43,289 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:08:43,292 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:08:43,644 - data.data_loader - INFO - Found 78 static columns: ['peatf', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_SAND_6', 'PCT_NAT_PFT_6', 'PCT_CLAY_2', 'SCALARAVG_vr_4', 'SCALARAVG_vr_3', 'PCT_CLAY_5', 'PCT_NAT_PFT_8', 'Y_GPP', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'PCT_SAND_3', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_SAND_4', 'PCT_SAND_1', 'SCALARAVG_vr_2', 'SOIL_ORDER', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'abm', 'Y_HR', 'Latitude', 'SNOWDP', 'Longitude', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SECONDARY_P', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'APATITE_P', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_NATVEG', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9', 'HR', 'PCT_CLAY_9', 'AREA', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'SCALARAVG_vr_11', 'PCT_SAND_8', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_10', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'LABILE_P', 'NPP', 'PCT_NAT_PFT_5', 'OCCLUDED_P', 'AR', 'landfrac', 'GPP']
2025-06-28 08:08:43,644 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:08:43,644 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['peatf', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_SAND_6', 'PCT_NAT_PFT_6', 'PCT_CLAY_2', 'SCALARAVG_vr_4', 'SCALARAVG_vr_3', 'PCT_CLAY_5', 'PCT_NAT_PFT_8', 'Y_GPP', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'PCT_SAND_3', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_SAND_4', 'PCT_SAND_1', 'SCALARAVG_vr_2', 'SOIL_ORDER', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'abm', 'Y_HR', 'Latitude', 'SNOWDP', 'Longitude', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SECONDARY_P', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'APATITE_P', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_NATVEG', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9', 'HR', 'PCT_CLAY_9', 'AREA', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'SCALARAVG_vr_11', 'PCT_SAND_8', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_10', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'LABILE_P', 'NPP', 'PCT_NAT_PFT_5', 'OCCLUDED_P', 'AR', 'landfrac', 'GPP'], 'target_columns': ['Y_GPP', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:08:43,644 - __main__ - INFO - Normalizing data...
2025-06-28 08:08:43,644 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:08:43,650 - data.data_loader - INFO - Found 78 static columns: ['peatf', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_SAND_6', 'PCT_NAT_PFT_6', 'PCT_CLAY_2', 'SCALARAVG_vr_4', 'SCALARAVG_vr_3', 'PCT_CLAY_5', 'PCT_NAT_PFT_8', 'Y_GPP', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'PCT_SAND_3', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_SAND_4', 'PCT_SAND_1', 'SCALARAVG_vr_2', 'SOIL_ORDER', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'abm', 'Y_HR', 'Latitude', 'SNOWDP', 'Longitude', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SECONDARY_P', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'APATITE_P', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_NATVEG', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9', 'HR', 'PCT_CLAY_9', 'AREA', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'SCALARAVG_vr_11', 'PCT_SAND_8', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_10', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'LABILE_P', 'NPP', 'PCT_NAT_PFT_5', 'OCCLUDED_P', 'AR', 'landfrac', 'GPP']
2025-06-28 08:08:43,650 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:08:43,650 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:08:43,683 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:08:43,692 - data.data_loader - INFO - Normalizing 78 static columns: ['peatf', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_9', 'PCT_SAND_2', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_SAND_7', 'PCT_CLAY_7', 'PCT_SAND_6', 'PCT_NAT_PFT_6', 'PCT_CLAY_2', 'SCALARAVG_vr_4', 'SCALARAVG_vr_3', 'PCT_CLAY_5', 'PCT_NAT_PFT_8', 'Y_GPP', 'PCT_SAND_5', 'PCT_CLAY_1', 'PCT_NAT_PFT_1', 'PCT_SAND_3', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_SAND_4', 'PCT_SAND_1', 'SCALARAVG_vr_2', 'SOIL_ORDER', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'abm', 'Y_HR', 'Latitude', 'SNOWDP', 'Longitude', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'PCT_CLAY_0', 'SECONDARY_P', 'SOIL_COLOR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_6', 'APATITE_P', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_NATVEG', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_9', 'HR', 'PCT_CLAY_9', 'AREA', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_0', 'SCALARAVG_vr_11', 'PCT_SAND_8', 'PCT_CLAY_8', 'PCT_SAND_0', 'PCT_SAND_9', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_10', 'PCT_CLAY_4', 'SCALARAVG_vr_7', 'SCALARAVG_vr_5', 'LABILE_P', 'NPP', 'PCT_NAT_PFT_5', 'OCCLUDED_P', 'AR', 'landfrac', 'GPP']
2025-06-28 08:08:43,693 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:08:43,694 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_AR']
2025-06-28 08:08:43,694 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:08:43,698 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:08:43,702 - __main__ - INFO - Splitting data...
2025-06-28 08:08:43,702 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:08:43,702 - __main__ - INFO - Creating model...
2025-06-28 08:08:43,702 - __main__ - INFO - Detected actual 1D input size: 16
2025-06-28 08:08:43,702 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:08:43,702 - models.combined_model - INFO - Using actual 1D input size: 16
2025-06-28 08:08:43,702 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:08:43,702 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 16, 2D: 540 (channels: 3)
2025-06-28 08:08:43,702 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:08:43,702 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:08:43,702 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:08:43,721 - models.combined_model - INFO - Model initialized with 620040 parameters
2025-06-28 08:08:43,721 - __main__ - INFO - Initializing trainer...
2025-06-28 08:08:44,030 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:08:45,382 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:08:45,382 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:08:45,382 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:08:45,382 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:08:45,382 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:08:45,383 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:08:45,383 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:08:45,384 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:08:45,868 - training.trainer - ERROR - Training pipeline failed: mat1 and mat2 shapes cannot be multiplied (32x48 and 16x32)
2025-06-28 08:08:45,868 - __main__ - ERROR - Training failed: mat1 and mat2 shapes cannot be multiplied (32x48 and 16x32)
2025-06-28 08:10:51,193 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:10:51,194 - __main__ - INFO - Initializing data loader...
2025-06-28 08:10:51,194 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:10:51,194 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:10:51,194 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:10:51,194 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:10:51,194 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:10:51,195 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:10:57,945 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:10:57,946 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:10:57,948 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:10:57,949 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:10:57,950 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:10:57,977 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:10:58,010 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:10:58,012 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:10:58,370 - data.data_loader - INFO - Found 78 static columns: ['Y_GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_SAND_2', 'PCT_CLAY_7', 'SNOWDP', 'LABILE_P', 'SCALARAVG_vr_4', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_3', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_SAND_4', 'Longitude', 'SCALARAVG_vr_3', 'PCT_CLAY_6', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_CLAY_2', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'GPP', 'PCT_NAT_PFT_7', 'PCT_SAND_9', 'PCT_SAND_3', 'PCT_NAT_PFT_0', 'Y_NPP', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_5', 'PCT_CLAY_3', 'APATITE_P', 'NPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'landfrac', 'PCT_CLAY_0', 'SCALARAVG_vr_5', 'Y_HR', 'PCT_NAT_PFT_4', 'abm', 'PCT_SAND_5', 'PCT_NAT_PFT_8', 'PCT_SAND_7', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'Latitude', 'AR', 'PCT_NAT_PFT_5', 'SOIL_ORDER', 'PCT_SAND_1', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'AREA', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SCALARAVG_vr_1', 'HR', 'LANDFRAC_PFT', 'H2OSOI_10CM']
2025-06-28 08:10:58,370 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:10:58,370 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['Y_GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_SAND_2', 'PCT_CLAY_7', 'SNOWDP', 'LABILE_P', 'SCALARAVG_vr_4', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_3', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_SAND_4', 'Longitude', 'SCALARAVG_vr_3', 'PCT_CLAY_6', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_CLAY_2', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'GPP', 'PCT_NAT_PFT_7', 'PCT_SAND_9', 'PCT_SAND_3', 'PCT_NAT_PFT_0', 'Y_NPP', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_5', 'PCT_CLAY_3', 'APATITE_P', 'NPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'landfrac', 'PCT_CLAY_0', 'SCALARAVG_vr_5', 'Y_HR', 'PCT_NAT_PFT_4', 'abm', 'PCT_SAND_5', 'PCT_NAT_PFT_8', 'PCT_SAND_7', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'Latitude', 'AR', 'PCT_NAT_PFT_5', 'SOIL_ORDER', 'PCT_SAND_1', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'AREA', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SCALARAVG_vr_1', 'HR', 'LANDFRAC_PFT', 'H2OSOI_10CM'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_AR', 'Y_NPP', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:10:58,370 - __main__ - INFO - Normalizing data...
2025-06-28 08:10:58,370 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:10:58,375 - data.data_loader - INFO - Found 78 static columns: ['Y_GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_SAND_2', 'PCT_CLAY_7', 'SNOWDP', 'LABILE_P', 'SCALARAVG_vr_4', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_3', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_SAND_4', 'Longitude', 'SCALARAVG_vr_3', 'PCT_CLAY_6', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_CLAY_2', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'GPP', 'PCT_NAT_PFT_7', 'PCT_SAND_9', 'PCT_SAND_3', 'PCT_NAT_PFT_0', 'Y_NPP', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_5', 'PCT_CLAY_3', 'APATITE_P', 'NPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'landfrac', 'PCT_CLAY_0', 'SCALARAVG_vr_5', 'Y_HR', 'PCT_NAT_PFT_4', 'abm', 'PCT_SAND_5', 'PCT_NAT_PFT_8', 'PCT_SAND_7', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'Latitude', 'AR', 'PCT_NAT_PFT_5', 'SOIL_ORDER', 'PCT_SAND_1', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'AREA', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SCALARAVG_vr_1', 'HR', 'LANDFRAC_PFT', 'H2OSOI_10CM']
2025-06-28 08:10:58,375 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:10:58,376 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:10:58,407 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:10:58,413 - data.data_loader - INFO - Normalizing 78 static columns: ['Y_GPP', 'PCT_CLAY_8', 'PCT_SAND_6', 'PCT_SAND_0', 'PCT_SAND_2', 'PCT_CLAY_7', 'SNOWDP', 'LABILE_P', 'SCALARAVG_vr_4', 'OCCLUDED_P', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_3', 'Y_COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_16', 'SCALARAVG_vr_9', 'SCALARAVG_vr_12', 'SECONDARY_P', 'PCT_SAND_4', 'Longitude', 'SCALARAVG_vr_3', 'PCT_CLAY_6', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'PCT_CLAY_2', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_7', 'PCT_SAND_8', 'GPP', 'PCT_NAT_PFT_7', 'PCT_SAND_9', 'PCT_SAND_3', 'PCT_NAT_PFT_0', 'Y_NPP', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'COL_FIRE_CLOSS', 'PCT_CLAY_5', 'PCT_CLAY_3', 'APATITE_P', 'NPP', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'landfrac', 'PCT_CLAY_0', 'SCALARAVG_vr_5', 'Y_HR', 'PCT_NAT_PFT_4', 'abm', 'PCT_SAND_5', 'PCT_NAT_PFT_8', 'PCT_SAND_7', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'Latitude', 'AR', 'PCT_NAT_PFT_5', 'SOIL_ORDER', 'PCT_SAND_1', 'PCT_NATVEG', 'SCALARAVG_vr_11', 'AREA', 'PCT_CLAY_4', 'PCT_CLAY_9', 'SCALARAVG_vr_1', 'HR', 'LANDFRAC_PFT', 'H2OSOI_10CM']
2025-06-28 08:10:58,415 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:10:58,416 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_AR', 'Y_NPP', 'Y_HR']
2025-06-28 08:10:58,417 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:10:58,421 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:10:58,426 - __main__ - INFO - Splitting data...
2025-06-28 08:10:58,426 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:10:58,426 - __main__ - INFO - Creating model...
2025-06-28 08:10:58,426 - __main__ - ERROR - Training failed: 'vector_length'
2025-06-28 08:12:07,004 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:12:07,005 - __main__ - INFO - Initializing data loader...
2025-06-28 08:12:07,005 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:12:07,005 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:12:07,005 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:12:07,005 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:12:07,006 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:12:07,006 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:12:14,422 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:12:14,422 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:12:14,424 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:12:14,425 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:12:14,425 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:12:14,455 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:12:14,488 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:12:14,491 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:12:14,930 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_12', 'SCALARAVG_vr_7', 'PCT_SAND_2', 'PCT_SAND_8', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_SAND_7', 'GPP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_3', 'PCT_CLAY_7', 'OCCLUDED_P', 'landfrac', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_AR', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'PCT_SAND_6', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_4', 'HR', 'NPP', 'Y_HR', 'AR', 'SECONDARY_P', 'PCT_CLAY_6', 'Y_GPP', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'PCT_CLAY_0', 'SOIL_COLOR', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'PCT_NATVEG', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'Y_NPP', 'LABILE_P', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_13', 'SNOWDP', 'PCT_CLAY_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_1', 'Longitude', 'SOIL_ORDER', 'SCALARAVG_vr_2', 'PCT_SAND_9', 'AREA', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_14', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_7', 'peatf']
2025-06-28 08:12:14,931 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:12:14,931 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_12', 'SCALARAVG_vr_7', 'PCT_SAND_2', 'PCT_SAND_8', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_SAND_7', 'GPP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_3', 'PCT_CLAY_7', 'OCCLUDED_P', 'landfrac', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_AR', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'PCT_SAND_6', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_4', 'HR', 'NPP', 'Y_HR', 'AR', 'SECONDARY_P', 'PCT_CLAY_6', 'Y_GPP', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'PCT_CLAY_0', 'SOIL_COLOR', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'PCT_NATVEG', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'Y_NPP', 'LABILE_P', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_13', 'SNOWDP', 'PCT_CLAY_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_1', 'Longitude', 'SOIL_ORDER', 'SCALARAVG_vr_2', 'PCT_SAND_9', 'AREA', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_14', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_7', 'peatf'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_HR', 'Y_GPP', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:12:14,931 - __main__ - INFO - Normalizing data...
2025-06-28 08:12:14,931 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:12:14,936 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_12', 'SCALARAVG_vr_7', 'PCT_SAND_2', 'PCT_SAND_8', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_SAND_7', 'GPP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_3', 'PCT_CLAY_7', 'OCCLUDED_P', 'landfrac', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_AR', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'PCT_SAND_6', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_4', 'HR', 'NPP', 'Y_HR', 'AR', 'SECONDARY_P', 'PCT_CLAY_6', 'Y_GPP', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'PCT_CLAY_0', 'SOIL_COLOR', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'PCT_NATVEG', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'Y_NPP', 'LABILE_P', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_13', 'SNOWDP', 'PCT_CLAY_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_1', 'Longitude', 'SOIL_ORDER', 'SCALARAVG_vr_2', 'PCT_SAND_9', 'AREA', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_14', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_7', 'peatf']
2025-06-28 08:12:14,938 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:12:14,938 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:12:14,973 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:12:14,984 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_3', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_0', 'Latitude', 'SCALARAVG_vr_12', 'SCALARAVG_vr_7', 'PCT_SAND_2', 'PCT_SAND_8', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_SAND_7', 'GPP', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_3', 'PCT_CLAY_7', 'OCCLUDED_P', 'landfrac', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'Y_AR', 'SCALARAVG_vr_10', 'PCT_SAND_0', 'PCT_SAND_6', 'SCALARAVG_vr_1', 'COL_FIRE_CLOSS', 'abm', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_4', 'HR', 'NPP', 'Y_HR', 'AR', 'SECONDARY_P', 'PCT_CLAY_6', 'Y_GPP', 'SCALARAVG_vr_3', 'PCT_SAND_1', 'PCT_CLAY_0', 'SOIL_COLOR', 'PCT_CLAY_1', 'PCT_CLAY_8', 'PCT_SAND_4', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_14', 'PCT_NATVEG', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_4', 'Y_NPP', 'LABILE_P', 'APATITE_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_13', 'SNOWDP', 'PCT_CLAY_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_CLAY_9', 'PCT_NAT_PFT_1', 'Longitude', 'SOIL_ORDER', 'SCALARAVG_vr_2', 'PCT_SAND_9', 'AREA', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_14', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_7', 'peatf']
2025-06-28 08:12:14,990 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:12:14,990 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_HR', 'Y_GPP', 'Y_NPP']
2025-06-28 08:12:14,991 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:12:14,995 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:12:14,998 - __main__ - INFO - Splitting data...
2025-06-28 08:12:14,998 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:12:14,998 - __main__ - INFO - Creating model...
2025-06-28 08:12:14,998 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:12:14,999 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:12:14,999 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:12:14,999 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:12:14,999 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:12:14,999 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:12:14,999 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:12:14,999 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:12:15,016 - models.combined_model - INFO - Model initialized with 621064 parameters
2025-06-28 08:12:15,016 - __main__ - INFO - Initializing trainer...
2025-06-28 08:12:15,318 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:12:16,753 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:12:16,754 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:12:16,754 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:12:16,754 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:12:16,754 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:12:16,754 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:12:16,754 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:12:16,754 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:12:18,508 - training.trainer - ERROR - Training pipeline failed: The size of tensor a (16) must match the size of tensor b (48) at non-singleton dimension 2
2025-06-28 08:12:18,508 - __main__ - ERROR - Training failed: The size of tensor a (16) must match the size of tensor b (48) at non-singleton dimension 2
2025-06-28 08:14:07,092 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:14:07,092 - __main__ - INFO - Initializing data loader...
2025-06-28 08:14:07,092 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:14:07,092 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:14:07,093 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:14:07,093 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:14:07,093 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:14:07,093 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:14:13,910 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:14:13,910 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:14:13,912 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:14:13,914 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:14:13,914 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:14:13,943 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:14:13,976 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:14:13,979 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:14:14,392 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_10', 'PCT_SAND_0', 'PCT_CLAY_9', 'Y_GPP', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_SAND_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'OCCLUDED_P', 'SCALARAVG_vr_8', 'GPP', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'LABILE_P', 'SECONDARY_P', 'COL_FIRE_CLOSS', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_7', 'H2OSOI_10CM', 'SCALARAVG_vr_7', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Longitude', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'Y_AR', 'landfrac', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'NPP', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_SAND_5', 'SCALARAVG_vr_3', 'peatf', 'PCT_CLAY_8', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_4', 'PCT_NATVEG', 'SCALARAVG_vr_2', 'PCT_CLAY_7', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'abm', 'SCALARAVG_vr_1', 'PCT_CLAY_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_SAND_9', 'PCT_CLAY_1', 'AREA', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'HR', 'SCALARAVG_vr_0', 'SCALARAVG_vr_4', 'Latitude', 'SNOWDP', 'AR', 'PCT_CLAY_0', 'PCT_SAND_4']
2025-06-28 08:14:14,393 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:14:14,393 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_10', 'PCT_SAND_0', 'PCT_CLAY_9', 'Y_GPP', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_SAND_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'OCCLUDED_P', 'SCALARAVG_vr_8', 'GPP', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'LABILE_P', 'SECONDARY_P', 'COL_FIRE_CLOSS', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_7', 'H2OSOI_10CM', 'SCALARAVG_vr_7', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Longitude', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'Y_AR', 'landfrac', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'NPP', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_SAND_5', 'SCALARAVG_vr_3', 'peatf', 'PCT_CLAY_8', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_4', 'PCT_NATVEG', 'SCALARAVG_vr_2', 'PCT_CLAY_7', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'abm', 'SCALARAVG_vr_1', 'PCT_CLAY_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_SAND_9', 'PCT_CLAY_1', 'AREA', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'HR', 'SCALARAVG_vr_0', 'SCALARAVG_vr_4', 'Latitude', 'SNOWDP', 'AR', 'PCT_CLAY_0', 'PCT_SAND_4'], 'target_columns': ['Y_GPP', 'Y_NPP', 'Y_AR', 'Y_HR', 'Y_COL_FIRE_CLOSS'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:14:14,393 - __main__ - INFO - Normalizing data...
2025-06-28 08:14:14,393 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:14:14,398 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_10', 'PCT_SAND_0', 'PCT_CLAY_9', 'Y_GPP', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_SAND_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'OCCLUDED_P', 'SCALARAVG_vr_8', 'GPP', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'LABILE_P', 'SECONDARY_P', 'COL_FIRE_CLOSS', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_7', 'H2OSOI_10CM', 'SCALARAVG_vr_7', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Longitude', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'Y_AR', 'landfrac', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'NPP', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_SAND_5', 'SCALARAVG_vr_3', 'peatf', 'PCT_CLAY_8', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_4', 'PCT_NATVEG', 'SCALARAVG_vr_2', 'PCT_CLAY_7', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'abm', 'SCALARAVG_vr_1', 'PCT_CLAY_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_SAND_9', 'PCT_CLAY_1', 'AREA', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'HR', 'SCALARAVG_vr_0', 'SCALARAVG_vr_4', 'Latitude', 'SNOWDP', 'AR', 'PCT_CLAY_0', 'PCT_SAND_4']
2025-06-28 08:14:14,399 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:14:14,399 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:14:14,435 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:14:14,441 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_10', 'PCT_SAND_0', 'PCT_CLAY_9', 'Y_GPP', 'PCT_NAT_PFT_11', 'Y_HR', 'PCT_SAND_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'OCCLUDED_P', 'SCALARAVG_vr_8', 'GPP', 'SCALARAVG_vr_12', 'PCT_CLAY_5', 'LABILE_P', 'SECONDARY_P', 'COL_FIRE_CLOSS', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_7', 'H2OSOI_10CM', 'SCALARAVG_vr_7', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_8', 'Longitude', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'Y_AR', 'landfrac', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_6', 'PCT_CLAY_2', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'NPP', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_SAND_6', 'PCT_SAND_5', 'SCALARAVG_vr_3', 'peatf', 'PCT_CLAY_8', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_4', 'PCT_NATVEG', 'SCALARAVG_vr_2', 'PCT_CLAY_7', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'abm', 'SCALARAVG_vr_1', 'PCT_CLAY_6', 'PCT_SAND_8', 'APATITE_P', 'PCT_SAND_9', 'PCT_CLAY_1', 'AREA', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'HR', 'SCALARAVG_vr_0', 'SCALARAVG_vr_4', 'Latitude', 'SNOWDP', 'AR', 'PCT_CLAY_0', 'PCT_SAND_4']
2025-06-28 08:14:14,442 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:14:14,442 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_NPP', 'Y_AR', 'Y_HR', 'Y_COL_FIRE_CLOSS']
2025-06-28 08:14:14,443 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:14:14,446 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:14:14,449 - __main__ - INFO - Splitting data...
2025-06-28 08:14:14,449 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:14:14,449 - __main__ - INFO - Creating model...
2025-06-28 08:14:14,449 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:14:14,449 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:14:14,450 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:14:14,450 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:14:14,450 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:14:14,450 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:14:14,450 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:14:14,450 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:14:14,470 - models.combined_model - INFO - Model initialized with 625192 parameters
2025-06-28 08:14:14,471 - __main__ - INFO - Initializing trainer...
2025-06-28 08:14:14,797 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:14:16,175 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:16,175 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:14:16,175 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:14:16,175 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:14:16,175 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:14:16,176 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:16,176 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:14:16,176 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:14:17,321 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,321 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:14:17,322 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,334 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,392 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,404 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,434 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,732 - training.trainer - INFO - Epoch [1/2] - Train Loss: 4.0109, Val Loss: 9.1849, Time: 1.56s
2025-06-28 08:14:17,733 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,733 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:14:17,912 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,912 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:14:17,912 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,924 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,936 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,948 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:17,962 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:18,265 - training.trainer - INFO - Epoch [2/2] - Train Loss: 2.4231, Val Loss: 0.2718, Time: 0.53s
2025-06-28 08:14:18,265 - training.trainer - INFO - Training completed
2025-06-28 08:14:18,265 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:14:18,266 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:14:18,266 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:14:18,503 - training.trainer - ERROR - Training pipeline failed: y_true and y_pred have different number of output (5!=1)
2025-06-28 08:14:18,503 - __main__ - ERROR - Training failed: y_true and y_pred have different number of output (5!=1)
2025-06-28 08:15:47,507 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:15:47,507 - __main__ - ERROR - Training failed: 'DataConfig' object has no attribute 'target_columns'
2025-06-28 08:16:34,519 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:16:34,519 - __main__ - INFO - Initializing data loader...
2025-06-28 08:16:34,519 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:16:34,519 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:16:34,520 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:16:34,520 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:16:34,520 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:16:34,520 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:16:41,646 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:16:41,647 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:16:41,649 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:16:41,651 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:16:41,651 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:16:41,680 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:16:41,713 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:16:41,716 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:16:42,100 - data.data_loader - INFO - Found 78 static columns: ['Y_AR', 'peatf', 'PCT_NAT_PFT_0', 'PCT_SAND_4', 'SCALARAVG_vr_2', 'AR', 'PCT_SAND_8', 'Y_HR', 'AREA', 'SCALARAVG_vr_12', 'APATITE_P', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_1', 'PCT_CLAY_3', 'GPP', 'HR', 'Y_NPP', 'PCT_CLAY_9', 'SCALARAVG_vr_14', 'landfrac', 'OCCLUDED_P', 'SNOWDP', 'PCT_CLAY_8', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'LABILE_P', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_9', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SECONDARY_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'PCT_CLAY_1', 'SCALARAVG_vr_7', 'Latitude', 'PCT_SAND_0', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NATVEG', 'PCT_CLAY_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_4', 'abm', 'PCT_NAT_PFT_13', 'Longitude', 'PCT_SAND_5', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'Y_GPP', 'NPP', 'PCT_SAND_3', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_12']
2025-06-28 08:16:42,100 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:16:42,100 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['Y_AR', 'peatf', 'PCT_NAT_PFT_0', 'PCT_SAND_4', 'SCALARAVG_vr_2', 'AR', 'PCT_SAND_8', 'Y_HR', 'AREA', 'SCALARAVG_vr_12', 'APATITE_P', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_1', 'PCT_CLAY_3', 'GPP', 'HR', 'Y_NPP', 'PCT_CLAY_9', 'SCALARAVG_vr_14', 'landfrac', 'OCCLUDED_P', 'SNOWDP', 'PCT_CLAY_8', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'LABILE_P', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_9', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SECONDARY_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'PCT_CLAY_1', 'SCALARAVG_vr_7', 'Latitude', 'PCT_SAND_0', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NATVEG', 'PCT_CLAY_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_4', 'abm', 'PCT_NAT_PFT_13', 'Longitude', 'PCT_SAND_5', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'Y_GPP', 'NPP', 'PCT_SAND_3', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_12'], 'target_columns': ['Y_AR', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:16:42,100 - __main__ - INFO - Normalizing data...
2025-06-28 08:16:42,100 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:16:42,106 - data.data_loader - INFO - Found 78 static columns: ['Y_AR', 'peatf', 'PCT_NAT_PFT_0', 'PCT_SAND_4', 'SCALARAVG_vr_2', 'AR', 'PCT_SAND_8', 'Y_HR', 'AREA', 'SCALARAVG_vr_12', 'APATITE_P', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_1', 'PCT_CLAY_3', 'GPP', 'HR', 'Y_NPP', 'PCT_CLAY_9', 'SCALARAVG_vr_14', 'landfrac', 'OCCLUDED_P', 'SNOWDP', 'PCT_CLAY_8', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'LABILE_P', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_9', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SECONDARY_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'PCT_CLAY_1', 'SCALARAVG_vr_7', 'Latitude', 'PCT_SAND_0', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NATVEG', 'PCT_CLAY_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_4', 'abm', 'PCT_NAT_PFT_13', 'Longitude', 'PCT_SAND_5', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'Y_GPP', 'NPP', 'PCT_SAND_3', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_12']
2025-06-28 08:16:42,106 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:16:42,106 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:16:42,135 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:16:42,142 - data.data_loader - INFO - Normalizing 78 static columns: ['Y_AR', 'peatf', 'PCT_NAT_PFT_0', 'PCT_SAND_4', 'SCALARAVG_vr_2', 'AR', 'PCT_SAND_8', 'Y_HR', 'AREA', 'SCALARAVG_vr_12', 'APATITE_P', 'SCALARAVG_vr_6', 'H2OSOI_10CM', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_1', 'PCT_CLAY_3', 'GPP', 'HR', 'Y_NPP', 'PCT_CLAY_9', 'SCALARAVG_vr_14', 'landfrac', 'OCCLUDED_P', 'SNOWDP', 'PCT_CLAY_8', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'LANDFRAC_PFT', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'LABILE_P', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_9', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'PCT_CLAY_4', 'SECONDARY_P', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_11', 'SCALARAVG_vr_3', 'PCT_CLAY_1', 'SCALARAVG_vr_7', 'Latitude', 'PCT_SAND_0', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_13', 'SOIL_ORDER', 'PCT_CLAY_6', 'PCT_NAT_PFT_11', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_CLAY_7', 'PCT_NATVEG', 'PCT_CLAY_5', 'SOIL_COLOR', 'PCT_CLAY_0', 'PCT_NAT_PFT_4', 'abm', 'PCT_NAT_PFT_13', 'Longitude', 'PCT_SAND_5', 'SCALARAVG_vr_4', 'PCT_SAND_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'Y_GPP', 'NPP', 'PCT_SAND_3', 'PCT_SAND_2', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_12']
2025-06-28 08:16:42,143 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:16:42,143 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP']
2025-06-28 08:16:42,144 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:16:42,147 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:16:42,150 - __main__ - INFO - Splitting data...
2025-06-28 08:16:42,150 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:16:42,151 - __main__ - INFO - Creating model...
2025-06-28 08:16:42,151 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:16:42,151 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:16:42,151 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:16:42,151 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:16:42,151 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:16:42,151 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:16:42,151 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:16:42,151 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:16:42,166 - models.combined_model - INFO - Model initialized with 625708 parameters
2025-06-28 08:16:42,166 - __main__ - INFO - Initializing trainer...
2025-06-28 08:16:42,503 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:16:43,921 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:43,921 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:16:43,921 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:16:43,921 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:16:43,921 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:16:43,922 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:43,922 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:16:43,922 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:16:44,751 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:44,752 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:16:44,752 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:44,764 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:44,815 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:44,829 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:44,868 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,140 - training.trainer - INFO - Epoch [1/2] - Train Loss: 1.3659, Val Loss: 0.5542, Time: 1.22s
2025-06-28 08:16:45,141 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,141 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:16:45,303 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,303 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:16:45,304 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,315 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,328 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,340 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,353 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,650 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.5113, Val Loss: 0.2324, Time: 0.51s
2025-06-28 08:16:45,652 - training.trainer - INFO - Training completed
2025-06-28 08:16:45,652 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:16:45,653 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:16:45,653 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:16:45,878 - training.trainer - ERROR - Training pipeline failed: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
2025-06-28 08:16:45,878 - __main__ - ERROR - Training failed: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
2025-06-28 08:17:18,963 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:17:18,963 - __main__ - INFO - Initializing data loader...
2025-06-28 08:17:18,963 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:17:18,963 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:17:18,963 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:17:18,964 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:17:18,964 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:17:18,964 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:17:26,579 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:17:26,580 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:17:26,581 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:17:26,583 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:17:26,583 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:17:26,612 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:17:26,645 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:17:26,647 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:17:27,071 - data.data_loader - INFO - Found 78 static columns: ['peatf', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_SAND_8', 'Y_GPP', 'AR', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_12', 'NPP', 'Y_COL_FIRE_CLOSS', 'Latitude', 'landfrac', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_8', 'PCT_SAND_9', 'SCALARAVG_vr_13', 'AREA', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_5', 'PCT_SAND_6', 'LANDFRAC_PFT', 'H2OSOI_10CM', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'COL_FIRE_CLOSS', 'HR', 'PCT_SAND_5', 'PCT_NAT_PFT_11', 'Y_HR', 'Y_AR', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_4', 'APATITE_P', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_0', 'Y_NPP', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NATVEG', 'GPP', 'PCT_CLAY_7', 'abm', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_1', 'SCALARAVG_vr_4', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_8', 'SCALARAVG_vr_6', 'SOIL_COLOR', 'PCT_CLAY_4']
2025-06-28 08:17:27,071 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:17:27,071 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['peatf', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_SAND_8', 'Y_GPP', 'AR', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_12', 'NPP', 'Y_COL_FIRE_CLOSS', 'Latitude', 'landfrac', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_8', 'PCT_SAND_9', 'SCALARAVG_vr_13', 'AREA', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_5', 'PCT_SAND_6', 'LANDFRAC_PFT', 'H2OSOI_10CM', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'COL_FIRE_CLOSS', 'HR', 'PCT_SAND_5', 'PCT_NAT_PFT_11', 'Y_HR', 'Y_AR', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_4', 'APATITE_P', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_0', 'Y_NPP', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NATVEG', 'GPP', 'PCT_CLAY_7', 'abm', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_1', 'SCALARAVG_vr_4', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_8', 'SCALARAVG_vr_6', 'SOIL_COLOR', 'PCT_CLAY_4'], 'target_columns': ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_AR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:17:27,071 - __main__ - INFO - Normalizing data...
2025-06-28 08:17:27,071 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:17:27,077 - data.data_loader - INFO - Found 78 static columns: ['peatf', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_SAND_8', 'Y_GPP', 'AR', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_12', 'NPP', 'Y_COL_FIRE_CLOSS', 'Latitude', 'landfrac', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_8', 'PCT_SAND_9', 'SCALARAVG_vr_13', 'AREA', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_5', 'PCT_SAND_6', 'LANDFRAC_PFT', 'H2OSOI_10CM', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'COL_FIRE_CLOSS', 'HR', 'PCT_SAND_5', 'PCT_NAT_PFT_11', 'Y_HR', 'Y_AR', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_4', 'APATITE_P', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_0', 'Y_NPP', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NATVEG', 'GPP', 'PCT_CLAY_7', 'abm', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_1', 'SCALARAVG_vr_4', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_8', 'SCALARAVG_vr_6', 'SOIL_COLOR', 'PCT_CLAY_4']
2025-06-28 08:17:27,077 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:17:27,077 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:17:27,108 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:17:27,115 - data.data_loader - INFO - Normalizing 78 static columns: ['peatf', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_3', 'PCT_CLAY_9', 'Longitude', 'PCT_SAND_8', 'Y_GPP', 'AR', 'PCT_CLAY_2', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_12', 'NPP', 'Y_COL_FIRE_CLOSS', 'Latitude', 'landfrac', 'SECONDARY_P', 'PCT_CLAY_6', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_SAND_2', 'SNOWDP', 'PCT_CLAY_8', 'PCT_SAND_9', 'SCALARAVG_vr_13', 'AREA', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_5', 'PCT_SAND_6', 'LANDFRAC_PFT', 'H2OSOI_10CM', 'SCALARAVG_vr_0', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'OCCLUDED_P', 'COL_FIRE_CLOSS', 'HR', 'PCT_SAND_5', 'PCT_NAT_PFT_11', 'Y_HR', 'Y_AR', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_7', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_4', 'APATITE_P', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_SAND_4', 'PCT_SAND_0', 'Y_NPP', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NATVEG', 'GPP', 'PCT_CLAY_7', 'abm', 'PCT_CLAY_0', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_1', 'SCALARAVG_vr_4', 'SCALARAVG_vr_10', 'PCT_SAND_7', 'PCT_SAND_1', 'PCT_NAT_PFT_8', 'SCALARAVG_vr_8', 'SCALARAVG_vr_6', 'SOIL_COLOR', 'PCT_CLAY_4']
2025-06-28 08:17:27,116 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:17:27,117 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_AR', 'Y_NPP']
2025-06-28 08:17:27,118 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:17:27,121 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:17:27,124 - __main__ - INFO - Splitting data...
2025-06-28 08:17:27,124 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:17:27,124 - __main__ - INFO - Creating model...
2025-06-28 08:17:27,125 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:17:27,125 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:17:27,125 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:17:27,125 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:17:27,125 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:17:27,125 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:17:27,125 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:17:27,125 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:17:27,152 - models.combined_model - INFO - Model initialized with 625708 parameters
2025-06-28 08:17:27,152 - __main__ - INFO - Initializing trainer...
2025-06-28 08:17:27,465 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:17:28,883 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:28,883 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:17:28,884 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:17:28,884 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:17:28,884 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:17:28,884 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:28,884 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:17:28,884 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:17:29,727 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:29,727 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:17:29,728 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:29,740 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:29,793 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:29,806 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:29,835 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,093 - training.trainer - INFO - Epoch [1/2] - Train Loss: 2.0380, Val Loss: 0.8063, Time: 1.21s
2025-06-28 08:17:30,093 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,094 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:17:30,278 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,279 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:17:30,279 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,291 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,303 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,317 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,330 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,617 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.7094, Val Loss: 0.2695, Time: 0.52s
2025-06-28 08:17:30,617 - training.trainer - INFO - Training completed
2025-06-28 08:17:30,618 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:17:30,618 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:17:30,618 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:17:30,859 - training.trainer - ERROR - Training pipeline failed: Found input variables with inconsistent numbers of samples: [18360, 6120]
2025-06-28 08:17:30,859 - __main__ - ERROR - Training failed: Found input variables with inconsistent numbers of samples: [18360, 6120]
2025-06-28 08:17:55,091 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:17:55,091 - __main__ - INFO - Initializing data loader...
2025-06-28 08:17:55,092 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:17:55,092 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:17:55,092 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:17:55,092 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:17:55,093 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:17:55,093 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:18:02,793 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:18:02,793 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:18:02,795 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:18:02,797 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:18:02,797 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:18:02,826 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:18:02,859 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:18:02,863 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:18:03,284 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_15', 'PCT_SAND_1', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SECONDARY_P', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_5', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_2', 'PCT_SAND_9', 'H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_0', 'PCT_CLAY_4', 'PCT_SAND_7', 'APATITE_P', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'AREA', 'Y_HR', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'PCT_NAT_PFT_1', 'HR', 'SNOWDP', 'PCT_NAT_PFT_12', 'Latitude', 'SOIL_COLOR', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'NPP', 'PCT_SAND_0', 'LANDFRAC_PFT', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_10', 'GPP', 'SCALARAVG_vr_3', 'AR', 'SCALARAVG_vr_4', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'abm', 'SCALARAVG_vr_1', 'peatf', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_11', 'Y_AR']
2025-06-28 08:18:03,284 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:18:03,284 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_15', 'PCT_SAND_1', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SECONDARY_P', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_5', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_2', 'PCT_SAND_9', 'H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_0', 'PCT_CLAY_4', 'PCT_SAND_7', 'APATITE_P', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'AREA', 'Y_HR', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'PCT_NAT_PFT_1', 'HR', 'SNOWDP', 'PCT_NAT_PFT_12', 'Latitude', 'SOIL_COLOR', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'NPP', 'PCT_SAND_0', 'LANDFRAC_PFT', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_10', 'GPP', 'SCALARAVG_vr_3', 'AR', 'SCALARAVG_vr_4', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'abm', 'SCALARAVG_vr_1', 'peatf', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_11', 'Y_AR'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_NPP', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:18:03,284 - __main__ - INFO - Normalizing data...
2025-06-28 08:18:03,284 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:18:03,289 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_15', 'PCT_SAND_1', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SECONDARY_P', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_5', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_2', 'PCT_SAND_9', 'H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_0', 'PCT_CLAY_4', 'PCT_SAND_7', 'APATITE_P', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'AREA', 'Y_HR', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'PCT_NAT_PFT_1', 'HR', 'SNOWDP', 'PCT_NAT_PFT_12', 'Latitude', 'SOIL_COLOR', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'NPP', 'PCT_SAND_0', 'LANDFRAC_PFT', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_10', 'GPP', 'SCALARAVG_vr_3', 'AR', 'SCALARAVG_vr_4', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'abm', 'SCALARAVG_vr_1', 'peatf', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_11', 'Y_AR']
2025-06-28 08:18:03,290 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:18:03,290 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:18:03,318 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:18:03,325 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_15', 'PCT_SAND_1', 'PCT_NAT_PFT_10', 'SOIL_ORDER', 'SECONDARY_P', 'SCALARAVG_vr_13', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_5', 'SCALARAVG_vr_14', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_SAND_5', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_9', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_11', 'Y_GPP', 'PCT_SAND_2', 'PCT_SAND_9', 'H2OSOI_10CM', 'PCT_CLAY_6', 'PCT_CLAY_3', 'LABILE_P', 'PCT_CLAY_0', 'PCT_CLAY_4', 'PCT_SAND_7', 'APATITE_P', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'AREA', 'Y_HR', 'PCT_NAT_PFT_3', 'PCT_SAND_4', 'PCT_NAT_PFT_1', 'HR', 'SNOWDP', 'PCT_NAT_PFT_12', 'Latitude', 'SOIL_COLOR', 'Y_NPP', 'PCT_CLAY_7', 'PCT_NAT_PFT_0', 'PCT_SAND_3', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'NPP', 'PCT_SAND_0', 'LANDFRAC_PFT', 'PCT_NAT_PFT_4', 'OCCLUDED_P', 'SCALARAVG_vr_10', 'GPP', 'SCALARAVG_vr_3', 'AR', 'SCALARAVG_vr_4', 'SCALARAVG_vr_12', 'landfrac', 'PCT_CLAY_8', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'abm', 'SCALARAVG_vr_1', 'peatf', 'PCT_CLAY_2', 'SCALARAVG_vr_5', 'SCALARAVG_vr_7', 'PCT_CLAY_1', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_11', 'Y_AR']
2025-06-28 08:18:03,326 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:18:03,327 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_NPP', 'Y_AR']
2025-06-28 08:18:03,328 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:18:03,331 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:18:03,334 - __main__ - INFO - Splitting data...
2025-06-28 08:18:03,334 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:18:03,335 - __main__ - INFO - Creating model...
2025-06-28 08:18:03,335 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:18:03,335 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:18:03,335 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:18:03,335 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:18:03,335 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:18:03,335 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:18:03,335 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:18:03,335 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:18:03,361 - models.combined_model - INFO - Model initialized with 625708 parameters
2025-06-28 08:18:03,361 - __main__ - INFO - Initializing trainer...
2025-06-28 08:18:03,640 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:18:05,014 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,014 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:18:05,014 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:18:05,015 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:18:05,015 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:18:05,020 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,020 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:18:05,020 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:18:05,941 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,942 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:05,942 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,955 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,966 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:05,978 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,010 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,287 - training.trainer - INFO - Epoch [1/2] - Train Loss: 1.8090, Val Loss: 0.4455, Time: 1.27s
2025-06-28 08:18:06,288 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,288 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:06,458 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,459 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:06,459 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,471 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,485 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,499 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,512 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,796 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.4425, Val Loss: 0.1754, Time: 0.51s
2025-06-28 08:18:06,797 - training.trainer - INFO - Training completed
2025-06-28 08:18:06,797 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:06,797 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:06,797 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:18:07,029 - training.trainer - ERROR - Training pipeline failed: tuple index out of range
2025-06-28 08:18:07,029 - __main__ - ERROR - Training failed: tuple index out of range
2025-06-28 08:18:42,796 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:18:42,796 - __main__ - INFO - Initializing data loader...
2025-06-28 08:18:42,796 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:18:42,796 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:18:42,796 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:18:42,797 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:18:42,797 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:18:42,797 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:18:49,902 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:18:49,903 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:18:49,904 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:18:49,906 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:18:49,906 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:18:49,934 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:18:49,965 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:18:49,967 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:18:50,378 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_4', 'AR', 'NPP', 'PCT_SAND_3', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_0', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_4', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_0', 'SNOWDP', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'HR', 'Y_GPP', 'SCALARAVG_vr_3', 'SECONDARY_P', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'SOIL_COLOR', 'Latitude', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_16', 'Y_AR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SCALARAVG_vr_13', 'PCT_SAND_6', 'abm', 'Y_HR', 'landfrac', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_NATVEG', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'LANDFRAC_PFT', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'PCT_NAT_PFT_6', 'GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'Longitude', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'LABILE_P', 'SOIL_ORDER']
2025-06-28 08:18:50,378 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:18:50,379 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_SAND_4', 'AR', 'NPP', 'PCT_SAND_3', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_0', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_4', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_0', 'SNOWDP', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'HR', 'Y_GPP', 'SCALARAVG_vr_3', 'SECONDARY_P', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'SOIL_COLOR', 'Latitude', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_16', 'Y_AR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SCALARAVG_vr_13', 'PCT_SAND_6', 'abm', 'Y_HR', 'landfrac', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_NATVEG', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'LANDFRAC_PFT', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'PCT_NAT_PFT_6', 'GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'Longitude', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'LABILE_P', 'SOIL_ORDER'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_GPP', 'Y_AR', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:18:50,380 - __main__ - INFO - Normalizing data...
2025-06-28 08:18:50,380 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:18:50,386 - data.data_loader - INFO - Found 78 static columns: ['PCT_SAND_4', 'AR', 'NPP', 'PCT_SAND_3', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_0', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_4', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_0', 'SNOWDP', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'HR', 'Y_GPP', 'SCALARAVG_vr_3', 'SECONDARY_P', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'SOIL_COLOR', 'Latitude', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_16', 'Y_AR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SCALARAVG_vr_13', 'PCT_SAND_6', 'abm', 'Y_HR', 'landfrac', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_NATVEG', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'LANDFRAC_PFT', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'PCT_NAT_PFT_6', 'GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'Longitude', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'LABILE_P', 'SOIL_ORDER']
2025-06-28 08:18:50,386 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:18:50,386 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:18:50,417 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:18:50,427 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_SAND_4', 'AR', 'NPP', 'PCT_SAND_3', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_0', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_4', 'PCT_SAND_2', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'OCCLUDED_P', 'PCT_SAND_0', 'SCALARAVG_vr_0', 'SNOWDP', 'SCALARAVG_vr_10', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_7', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'APATITE_P', 'Y_NPP', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_14', 'HR', 'Y_GPP', 'SCALARAVG_vr_3', 'SECONDARY_P', 'PCT_NAT_PFT_14', 'PCT_CLAY_9', 'SOIL_COLOR', 'Latitude', 'SCALARAVG_vr_6', 'peatf', 'PCT_NAT_PFT_16', 'Y_AR', 'COL_FIRE_CLOSS', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SCALARAVG_vr_13', 'PCT_SAND_6', 'abm', 'Y_HR', 'landfrac', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_NAT_PFT_4', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_NATVEG', 'PCT_SAND_1', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'LANDFRAC_PFT', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_2', 'PCT_SAND_7', 'PCT_NAT_PFT_9', 'PCT_CLAY_7', 'PCT_NAT_PFT_6', 'GPP', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_CLAY_5', 'H2OSOI_10CM', 'SCALARAVG_vr_2', 'Longitude', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_5', 'SCALARAVG_vr_1', 'LABILE_P', 'SOIL_ORDER']
2025-06-28 08:18:50,429 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:18:50,429 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_GPP', 'Y_AR', 'Y_HR']
2025-06-28 08:18:50,430 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:18:50,433 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:18:50,436 - __main__ - INFO - Splitting data...
2025-06-28 08:18:50,436 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:18:50,436 - __main__ - INFO - Creating model...
2025-06-28 08:18:50,436 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:18:50,436 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:18:50,436 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:18:50,436 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:18:50,436 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:18:50,436 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:18:50,436 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:18:50,436 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:18:50,461 - models.combined_model - INFO - Model initialized with 625708 parameters
2025-06-28 08:18:50,461 - __main__ - INFO - Initializing trainer...
2025-06-28 08:18:50,767 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:18:52,113 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,113 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:18:52,113 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:18:52,113 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:18:52,113 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:18:52,114 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,114 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:18:52,114 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:18:52,907 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,907 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:52,908 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,920 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,972 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:52,984 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,014 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,272 - training.trainer - INFO - Epoch [1/2] - Train Loss: 1.6170, Val Loss: 0.6321, Time: 1.16s
2025-06-28 08:18:53,272 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,273 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:53,438 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,439 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:53,439 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,455 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,466 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,477 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,490 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,778 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.6155, Val Loss: 0.3205, Time: 0.51s
2025-06-28 08:18:53,832 - training.trainer - INFO - Training completed
2025-06-28 08:18:53,832 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:18:53,832 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:18:53,832 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:18:54,053 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 08:18:54,060 - training.trainer - ERROR - Training pipeline failed: index 1 is out of bounds for dimension 1 with size 1
2025-06-28 08:18:54,060 - __main__ - ERROR - Training failed: index 1 is out of bounds for dimension 1 with size 1
2025-06-28 08:19:43,680 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:19:43,681 - __main__ - INFO - Initializing data loader...
2025-06-28 08:19:43,681 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:19:43,681 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:19:43,681 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:19:43,681 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:19:43,681 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:19:43,681 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:19:50,881 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:19:50,882 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:19:50,884 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:19:50,886 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:19:50,886 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:19:50,915 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:19:50,949 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:19:50,951 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:19:51,333 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_3', 'PCT_CLAY_1', 'SCALARAVG_vr_11', 'PCT_SAND_6', 'APATITE_P', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'abm', 'PCT_NAT_PFT_13', 'Latitude', 'SOIL_COLOR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_SAND_2', 'AR', 'PCT_CLAY_9', 'PCT_NAT_PFT_16', 'Y_HR', 'PCT_SAND_7', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'Y_AR', 'Y_NPP', 'SNOWDP', 'PCT_CLAY_0', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'PCT_SAND_4', 'SCALARAVG_vr_3', 'OCCLUDED_P', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'Longitude', 'NPP', 'PCT_NAT_PFT_4', 'LABILE_P', 'PCT_NAT_PFT_14', 'Y_GPP', 'GPP', 'SCALARAVG_vr_12', 'PCT_NATVEG', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'AREA', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_8', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_6', 'PCT_SAND_0', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SECONDARY_P', 'landfrac', 'PCT_SAND_9', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NAT_PFT_10', 'HR', 'LANDFRAC_PFT', 'SCALARAVG_vr_4', 'SCALARAVG_vr_14']
2025-06-28 08:19:51,333 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:19:51,333 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_3', 'PCT_CLAY_1', 'SCALARAVG_vr_11', 'PCT_SAND_6', 'APATITE_P', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'abm', 'PCT_NAT_PFT_13', 'Latitude', 'SOIL_COLOR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_SAND_2', 'AR', 'PCT_CLAY_9', 'PCT_NAT_PFT_16', 'Y_HR', 'PCT_SAND_7', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'Y_AR', 'Y_NPP', 'SNOWDP', 'PCT_CLAY_0', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'PCT_SAND_4', 'SCALARAVG_vr_3', 'OCCLUDED_P', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'Longitude', 'NPP', 'PCT_NAT_PFT_4', 'LABILE_P', 'PCT_NAT_PFT_14', 'Y_GPP', 'GPP', 'SCALARAVG_vr_12', 'PCT_NATVEG', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'AREA', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_8', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_6', 'PCT_SAND_0', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SECONDARY_P', 'landfrac', 'PCT_SAND_9', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NAT_PFT_10', 'HR', 'LANDFRAC_PFT', 'SCALARAVG_vr_4', 'SCALARAVG_vr_14'], 'target_columns': ['Y_HR', 'Y_NPP', 'Y_GPP', 'Y_AR', 'Y_COL_FIRE_CLOSS'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:19:51,335 - __main__ - INFO - Normalizing data...
2025-06-28 08:19:51,335 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:19:51,341 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_3', 'PCT_CLAY_1', 'SCALARAVG_vr_11', 'PCT_SAND_6', 'APATITE_P', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'abm', 'PCT_NAT_PFT_13', 'Latitude', 'SOIL_COLOR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_SAND_2', 'AR', 'PCT_CLAY_9', 'PCT_NAT_PFT_16', 'Y_HR', 'PCT_SAND_7', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'Y_AR', 'Y_NPP', 'SNOWDP', 'PCT_CLAY_0', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'PCT_SAND_4', 'SCALARAVG_vr_3', 'OCCLUDED_P', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'Longitude', 'NPP', 'PCT_NAT_PFT_4', 'LABILE_P', 'PCT_NAT_PFT_14', 'Y_GPP', 'GPP', 'SCALARAVG_vr_12', 'PCT_NATVEG', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'AREA', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_8', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_6', 'PCT_SAND_0', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SECONDARY_P', 'landfrac', 'PCT_SAND_9', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NAT_PFT_10', 'HR', 'LANDFRAC_PFT', 'SCALARAVG_vr_4', 'SCALARAVG_vr_14']
2025-06-28 08:19:51,341 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:19:51,341 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:19:51,375 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:19:51,381 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_3', 'PCT_CLAY_1', 'SCALARAVG_vr_11', 'PCT_SAND_6', 'APATITE_P', 'PCT_SAND_5', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_SAND_8', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'abm', 'PCT_NAT_PFT_13', 'Latitude', 'SOIL_COLOR', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_SAND_2', 'AR', 'PCT_CLAY_9', 'PCT_NAT_PFT_16', 'Y_HR', 'PCT_SAND_7', 'peatf', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'Y_AR', 'Y_NPP', 'SNOWDP', 'PCT_CLAY_0', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_0', 'PCT_SAND_4', 'SCALARAVG_vr_3', 'OCCLUDED_P', 'SCALARAVG_vr_2', 'SCALARAVG_vr_10', 'Longitude', 'NPP', 'PCT_NAT_PFT_4', 'LABILE_P', 'PCT_NAT_PFT_14', 'Y_GPP', 'GPP', 'SCALARAVG_vr_12', 'PCT_NATVEG', 'PCT_NAT_PFT_6', 'PCT_CLAY_4', 'AREA', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_12', 'PCT_CLAY_7', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_8', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'PCT_SAND_1', 'PCT_NAT_PFT_15', 'H2OSOI_10CM', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_6', 'PCT_SAND_0', 'PCT_CLAY_8', 'PCT_CLAY_6', 'SECONDARY_P', 'landfrac', 'PCT_SAND_9', 'SCALARAVG_vr_1', 'PCT_SAND_3', 'PCT_NAT_PFT_10', 'HR', 'LANDFRAC_PFT', 'SCALARAVG_vr_4', 'SCALARAVG_vr_14']
2025-06-28 08:19:51,382 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:19:51,382 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_NPP', 'Y_GPP', 'Y_AR', 'Y_COL_FIRE_CLOSS']
2025-06-28 08:19:51,383 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:19:51,386 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:19:51,390 - __main__ - INFO - Splitting data...
2025-06-28 08:19:51,390 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:19:51,390 - __main__ - INFO - Creating model...
2025-06-28 08:19:51,390 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:19:51,390 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:19:51,390 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:19:51,390 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:19:51,390 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:19:51,390 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:19:51,390 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:19:51,390 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:19:51,409 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 08:19:51,409 - __main__ - INFO - Initializing trainer...
2025-06-28 08:19:51,718 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:19:53,051 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,051 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:19:53,051 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:19:53,051 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:19:53,051 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:19:53,052 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,052 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:19:53,052 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:19:53,885 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,885 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:19:53,885 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,900 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,953 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:53,970 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,003 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,292 - training.trainer - INFO - Epoch [1/2] - Train Loss: 1.4199, Val Loss: 0.5204, Time: 1.24s
2025-06-28 08:19:54,293 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,293 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:19:54,477 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,477 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:19:54,477 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,489 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,502 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,514 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,528 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,802 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.4076, Val Loss: 0.2273, Time: 0.51s
2025-06-28 08:19:54,802 - training.trainer - INFO - Training completed
2025-06-28 08:19:54,802 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:19:54,803 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:19:54,803 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:19:55,022 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 08:19:55,059 - training.trainer - INFO - All predictions saved successfully
2025-06-28 08:19:55,071 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 08:19:55,072 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 08:19:55,072 - __main__ - INFO - Training completed successfully!
2025-06-28 08:19:55,072 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.30729624642445413), 'scalar_mse': 0.09443098306655884, 'vector_rmse': np.float64(0.31431013611750186), 'vector_mse': 0.09879086166620255, 'matrix_rmse': np.float64(0.5027868568040924), 'matrix_mse': 0.25279462337493896}
2025-06-28 08:22:10,955 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:22:10,955 - __main__ - INFO - Initializing data loader...
2025-06-28 08:22:10,955 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:22:10,955 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:22:10,955 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:22:10,956 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:22:10,956 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:22:10,956 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:22:18,967 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:22:18,967 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:22:18,969 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:22:18,970 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:22:18,970 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:22:19,000 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:22:19,033 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:22:19,036 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:22:19,415 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_NAT_PFT_8', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SNOWDP', 'Y_AR', 'Y_HR', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'SECONDARY_P', 'PCT_CLAY_2', 'PCT_SAND_4', 'PCT_SAND_7', 'abm', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'Longitude', 'PCT_CLAY_7', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_2', 'NPP', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'AREA', 'Latitude', 'PCT_CLAY_8', 'PCT_NAT_PFT_1', 'Y_COL_FIRE_CLOSS', 'APATITE_P', 'H2OSOI_10CM', 'peatf', 'GPP', 'SCALARAVG_vr_12', 'PCT_SAND_6', 'OCCLUDED_P', 'SOIL_ORDER', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_2', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_12', 'PCT_CLAY_9', 'Y_GPP', 'AR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'COL_FIRE_CLOSS', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_3', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_4', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_SAND_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'landfrac', 'SCALARAVG_vr_7', 'HR']
2025-06-28 08:22:19,415 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:22:19,415 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_NAT_PFT_8', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SNOWDP', 'Y_AR', 'Y_HR', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'SECONDARY_P', 'PCT_CLAY_2', 'PCT_SAND_4', 'PCT_SAND_7', 'abm', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'Longitude', 'PCT_CLAY_7', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_2', 'NPP', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'AREA', 'Latitude', 'PCT_CLAY_8', 'PCT_NAT_PFT_1', 'Y_COL_FIRE_CLOSS', 'APATITE_P', 'H2OSOI_10CM', 'peatf', 'GPP', 'SCALARAVG_vr_12', 'PCT_SAND_6', 'OCCLUDED_P', 'SOIL_ORDER', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_2', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_12', 'PCT_CLAY_9', 'Y_GPP', 'AR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'COL_FIRE_CLOSS', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_3', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_4', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_SAND_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'landfrac', 'SCALARAVG_vr_7', 'HR'], 'target_columns': ['Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:22:19,416 - __main__ - INFO - Normalizing data...
2025-06-28 08:22:19,416 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:22:19,421 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_NAT_PFT_8', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SNOWDP', 'Y_AR', 'Y_HR', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'SECONDARY_P', 'PCT_CLAY_2', 'PCT_SAND_4', 'PCT_SAND_7', 'abm', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'Longitude', 'PCT_CLAY_7', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_2', 'NPP', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'AREA', 'Latitude', 'PCT_CLAY_8', 'PCT_NAT_PFT_1', 'Y_COL_FIRE_CLOSS', 'APATITE_P', 'H2OSOI_10CM', 'peatf', 'GPP', 'SCALARAVG_vr_12', 'PCT_SAND_6', 'OCCLUDED_P', 'SOIL_ORDER', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_2', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_12', 'PCT_CLAY_9', 'Y_GPP', 'AR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'COL_FIRE_CLOSS', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_3', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_4', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_SAND_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'landfrac', 'SCALARAVG_vr_7', 'HR']
2025-06-28 08:22:19,422 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:22:19,422 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:22:19,451 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:22:19,458 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_5', 'PCT_CLAY_6', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_11', 'PCT_SAND_3', 'PCT_NAT_PFT_8', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SCALARAVG_vr_2', 'SNOWDP', 'Y_AR', 'Y_HR', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_13', 'SECONDARY_P', 'PCT_CLAY_2', 'PCT_SAND_4', 'PCT_SAND_7', 'abm', 'SCALARAVG_vr_0', 'SOIL_COLOR', 'Longitude', 'PCT_CLAY_7', 'SCALARAVG_vr_14', 'LANDFRAC_PFT', 'PCT_SAND_2', 'NPP', 'PCT_SAND_9', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'AREA', 'Latitude', 'PCT_CLAY_8', 'PCT_NAT_PFT_1', 'Y_COL_FIRE_CLOSS', 'APATITE_P', 'H2OSOI_10CM', 'peatf', 'GPP', 'SCALARAVG_vr_12', 'PCT_SAND_6', 'OCCLUDED_P', 'SOIL_ORDER', 'PCT_CLAY_1', 'PCT_NAT_PFT_7', 'Y_NPP', 'PCT_SAND_8', 'PCT_SAND_0', 'PCT_CLAY_5', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_2', 'PCT_NATVEG', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_12', 'PCT_CLAY_9', 'Y_GPP', 'AR', 'PCT_NAT_PFT_15', 'SCALARAVG_vr_11', 'SCALARAVG_vr_6', 'COL_FIRE_CLOSS', 'PCT_SAND_1', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_3', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_4', 'LABILE_P', 'SCALARAVG_vr_10', 'PCT_SAND_5', 'PCT_CLAY_4', 'PCT_NAT_PFT_9', 'landfrac', 'SCALARAVG_vr_7', 'HR']
2025-06-28 08:22:19,459 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:22:19,459 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_HR', 'Y_NPP']
2025-06-28 08:22:19,460 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:22:19,463 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:22:19,466 - __main__ - INFO - Splitting data...
2025-06-28 08:22:19,466 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:22:19,467 - __main__ - INFO - Creating model...
2025-06-28 08:22:19,467 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:22:19,467 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:22:19,467 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:22:19,467 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:22:19,467 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:22:19,467 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:22:19,467 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:22:19,467 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:22:19,484 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 08:22:19,484 - __main__ - INFO - Initializing trainer...
2025-06-28 08:22:20,841 - training.trainer - INFO - Trainer initialized on device: cpu
2025-06-28 08:22:20,841 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:22:20,841 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:22:20,841 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:22:20,842 - training.trainer - ERROR - Training pipeline failed: prefetch_factor option could only be specified in multiprocessing.let num_workers > 0 to enable multiprocessing, otherwise set prefetch_factor to None.
2025-06-28 08:22:20,842 - __main__ - ERROR - Training failed: prefetch_factor option could only be specified in multiprocessing.let num_workers > 0 to enable multiprocessing, otherwise set prefetch_factor to None.
2025-06-28 08:22:35,751 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:22:35,752 - __main__ - INFO - Initializing data loader...
2025-06-28 08:22:35,752 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:22:35,752 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:22:35,752 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:22:35,752 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:22:35,753 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:22:35,753 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:22:42,468 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:22:42,469 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:22:42,471 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:22:42,473 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:22:42,473 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:22:42,502 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:22:42,535 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:22:42,538 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:22:42,907 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_CLAY_2', 'PCT_CLAY_1', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'SOIL_COLOR', 'PCT_SAND_3', 'HR', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_CLAY_6', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'AR', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_12', 'Latitude', 'LABILE_P', 'SCALARAVG_vr_0', 'peatf', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_1', 'SNOWDP', 'SCALARAVG_vr_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_13', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_8', 'SECONDARY_P', 'PCT_SAND_8', 'Y_AR', 'SCALARAVG_vr_14', 'PCT_CLAY_4', 'PCT_NAT_PFT_11', 'PCT_SAND_2', 'abm', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_6', 'NPP', 'PCT_SAND_9', 'landfrac', 'PCT_NATVEG', 'PCT_NAT_PFT_7', 'PCT_SAND_6', 'PCT_NAT_PFT_10', 'PCT_SAND_7', 'PCT_SAND_1', 'SCALARAVG_vr_5', 'GPP', 'PCT_SAND_5']
2025-06-28 08:22:42,907 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:22:42,907 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['COL_FIRE_CLOSS', 'PCT_CLAY_2', 'PCT_CLAY_1', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'SOIL_COLOR', 'PCT_SAND_3', 'HR', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_CLAY_6', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'AR', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_12', 'Latitude', 'LABILE_P', 'SCALARAVG_vr_0', 'peatf', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_1', 'SNOWDP', 'SCALARAVG_vr_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_13', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_8', 'SECONDARY_P', 'PCT_SAND_8', 'Y_AR', 'SCALARAVG_vr_14', 'PCT_CLAY_4', 'PCT_NAT_PFT_11', 'PCT_SAND_2', 'abm', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_6', 'NPP', 'PCT_SAND_9', 'landfrac', 'PCT_NATVEG', 'PCT_NAT_PFT_7', 'PCT_SAND_6', 'PCT_NAT_PFT_10', 'PCT_SAND_7', 'PCT_SAND_1', 'SCALARAVG_vr_5', 'GPP', 'PCT_SAND_5'], 'target_columns': ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_HR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:22:42,907 - __main__ - INFO - Normalizing data...
2025-06-28 08:22:42,907 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:22:42,913 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_CLAY_2', 'PCT_CLAY_1', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'SOIL_COLOR', 'PCT_SAND_3', 'HR', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_CLAY_6', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'AR', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_12', 'Latitude', 'LABILE_P', 'SCALARAVG_vr_0', 'peatf', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_1', 'SNOWDP', 'SCALARAVG_vr_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_13', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_8', 'SECONDARY_P', 'PCT_SAND_8', 'Y_AR', 'SCALARAVG_vr_14', 'PCT_CLAY_4', 'PCT_NAT_PFT_11', 'PCT_SAND_2', 'abm', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_6', 'NPP', 'PCT_SAND_9', 'landfrac', 'PCT_NATVEG', 'PCT_NAT_PFT_7', 'PCT_SAND_6', 'PCT_NAT_PFT_10', 'PCT_SAND_7', 'PCT_SAND_1', 'SCALARAVG_vr_5', 'GPP', 'PCT_SAND_5']
2025-06-28 08:22:42,913 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:22:42,913 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:22:42,939 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:22:42,945 - data.data_loader - INFO - Normalizing 78 static columns: ['COL_FIRE_CLOSS', 'PCT_CLAY_2', 'PCT_CLAY_1', 'SCALARAVG_vr_3', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_13', 'OCCLUDED_P', 'SOIL_COLOR', 'PCT_SAND_3', 'HR', 'PCT_NAT_PFT_12', 'PCT_SAND_4', 'PCT_CLAY_9', 'SCALARAVG_vr_4', 'SCALARAVG_vr_9', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_2', 'PCT_CLAY_3', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_CLAY_5', 'SOIL_ORDER', 'PCT_CLAY_6', 'SCALARAVG_vr_10', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_CLAY_0', 'SCALARAVG_vr_1', 'AR', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_12', 'Latitude', 'LABILE_P', 'SCALARAVG_vr_0', 'peatf', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_1', 'SNOWDP', 'SCALARAVG_vr_7', 'AREA', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_13', 'Longitude', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_7', 'Y_GPP', 'PCT_CLAY_8', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_8', 'SECONDARY_P', 'PCT_SAND_8', 'Y_AR', 'SCALARAVG_vr_14', 'PCT_CLAY_4', 'PCT_NAT_PFT_11', 'PCT_SAND_2', 'abm', 'Y_HR', 'Y_NPP', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_6', 'SCALARAVG_vr_6', 'NPP', 'PCT_SAND_9', 'landfrac', 'PCT_NATVEG', 'PCT_NAT_PFT_7', 'PCT_SAND_6', 'PCT_NAT_PFT_10', 'PCT_SAND_7', 'PCT_SAND_1', 'SCALARAVG_vr_5', 'GPP', 'PCT_SAND_5']
2025-06-28 08:22:42,946 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:22:42,947 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_HR', 'Y_NPP']
2025-06-28 08:22:42,947 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:22:42,951 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:22:42,953 - __main__ - INFO - Splitting data...
2025-06-28 08:22:42,954 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:22:42,954 - __main__ - INFO - Creating model...
2025-06-28 08:22:42,954 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:22:42,954 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:22:42,954 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:22:42,954 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:22:42,954 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:22:42,954 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:22:42,954 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:22:42,954 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:22:42,975 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 08:22:42,975 - __main__ - INFO - Initializing trainer...
2025-06-28 08:22:44,338 - training.trainer - INFO - Trainer initialized on device: cpu
2025-06-28 08:22:44,338 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:22:44,338 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:22:44,338 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:22:46,428 - training.trainer - INFO - Epoch [1/2] - Train Loss: 1.9329, Val Loss: 0.7407, Time: 2.09s
2025-06-28 08:22:47,347 - training.trainer - INFO - Epoch [2/2] - Train Loss: 0.5904, Val Loss: 0.2694, Time: 0.92s
2025-06-28 08:22:47,347 - training.trainer - INFO - Training completed
2025-06-28 08:22:47,348 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:22:47,435 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 08:22:47,468 - training.trainer - INFO - All predictions saved successfully
2025-06-28 08:22:47,475 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 08:22:47,476 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 08:22:47,477 - __main__ - INFO - Training completed successfully!
2025-06-28 08:22:47,477 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.12819084417834425), 'scalar_mse': 0.01643289253115654, 'vector_rmse': np.float64(0.34515564881769323), 'vector_mse': 0.11913242191076279, 'matrix_rmse': np.float64(0.37696431197727637), 'matrix_mse': 0.14210209250450134}
2025-06-28 08:23:04,659 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:23:04,659 - __main__ - INFO - Initializing data loader...
2025-06-28 08:23:04,659 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:23:04,659 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:23:04,660 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:23:04,660 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:23:04,660 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:23:04,660 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:23:11,417 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:23:11,418 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:23:11,420 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:23:11,422 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:23:11,422 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:23:11,448 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:23:11,483 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:23:11,485 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:23:11,901 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_8', 'SCALARAVG_vr_1', 'PCT_CLAY_4', 'Y_COL_FIRE_CLOSS', 'HR', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_6', 'LABILE_P', 'PCT_NAT_PFT_12', 'Y_NPP', 'abm', 'PCT_CLAY_8', 'PCT_CLAY_3', 'SCALARAVG_vr_14', 'Y_HR', 'SCALARAVG_vr_12', 'AREA', 'PCT_SAND_3', 'SECONDARY_P', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_CLAY_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'PCT_CLAY_0', 'PCT_SAND_2', 'SOIL_COLOR', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_NAT_PFT_9', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'SNOWDP', 'NPP', 'PCT_NAT_PFT_14', 'PCT_SAND_8', 'landfrac', 'SCALARAVG_vr_2', 'Latitude', 'PCT_SAND_4', 'GPP', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'PCT_CLAY_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_9', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'Y_GPP', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_13', 'PCT_SAND_7', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_SAND_0', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'AR', 'PCT_CLAY_7', 'APATITE_P']
2025-06-28 08:23:11,902 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:23:11,902 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_8', 'SCALARAVG_vr_1', 'PCT_CLAY_4', 'Y_COL_FIRE_CLOSS', 'HR', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_6', 'LABILE_P', 'PCT_NAT_PFT_12', 'Y_NPP', 'abm', 'PCT_CLAY_8', 'PCT_CLAY_3', 'SCALARAVG_vr_14', 'Y_HR', 'SCALARAVG_vr_12', 'AREA', 'PCT_SAND_3', 'SECONDARY_P', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_CLAY_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'PCT_CLAY_0', 'PCT_SAND_2', 'SOIL_COLOR', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_NAT_PFT_9', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'SNOWDP', 'NPP', 'PCT_NAT_PFT_14', 'PCT_SAND_8', 'landfrac', 'SCALARAVG_vr_2', 'Latitude', 'PCT_SAND_4', 'GPP', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'PCT_CLAY_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_9', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'Y_GPP', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_13', 'PCT_SAND_7', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_SAND_0', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'AR', 'PCT_CLAY_7', 'APATITE_P'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR', 'Y_HR', 'Y_GPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:23:11,902 - __main__ - INFO - Normalizing data...
2025-06-28 08:23:11,902 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:23:11,907 - data.data_loader - INFO - Found 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_8', 'SCALARAVG_vr_1', 'PCT_CLAY_4', 'Y_COL_FIRE_CLOSS', 'HR', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_6', 'LABILE_P', 'PCT_NAT_PFT_12', 'Y_NPP', 'abm', 'PCT_CLAY_8', 'PCT_CLAY_3', 'SCALARAVG_vr_14', 'Y_HR', 'SCALARAVG_vr_12', 'AREA', 'PCT_SAND_3', 'SECONDARY_P', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_CLAY_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'PCT_CLAY_0', 'PCT_SAND_2', 'SOIL_COLOR', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_NAT_PFT_9', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'SNOWDP', 'NPP', 'PCT_NAT_PFT_14', 'PCT_SAND_8', 'landfrac', 'SCALARAVG_vr_2', 'Latitude', 'PCT_SAND_4', 'GPP', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'PCT_CLAY_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_9', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'Y_GPP', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_13', 'PCT_SAND_7', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_SAND_0', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'AR', 'PCT_CLAY_7', 'APATITE_P']
2025-06-28 08:23:11,908 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:23:11,908 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:23:11,940 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:23:11,946 - data.data_loader - INFO - Normalizing 78 static columns: ['COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'Y_AR', 'PCT_NAT_PFT_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_8', 'SCALARAVG_vr_1', 'PCT_CLAY_4', 'Y_COL_FIRE_CLOSS', 'HR', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_15', 'PCT_SAND_5', 'peatf', 'H2OSOI_10CM', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_6', 'LABILE_P', 'PCT_NAT_PFT_12', 'Y_NPP', 'abm', 'PCT_CLAY_8', 'PCT_CLAY_3', 'SCALARAVG_vr_14', 'Y_HR', 'SCALARAVG_vr_12', 'AREA', 'PCT_SAND_3', 'SECONDARY_P', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1', 'PCT_CLAY_2', 'SCALARAVG_vr_10', 'SCALARAVG_vr_5', 'PCT_CLAY_0', 'PCT_SAND_2', 'SOIL_COLOR', 'LANDFRAC_PFT', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_3', 'SOIL_ORDER', 'PCT_NAT_PFT_9', 'PCT_SAND_9', 'PCT_NAT_PFT_6', 'SNOWDP', 'NPP', 'PCT_NAT_PFT_14', 'PCT_SAND_8', 'landfrac', 'SCALARAVG_vr_2', 'Latitude', 'PCT_SAND_4', 'GPP', 'SCALARAVG_vr_0', 'PCT_NATVEG', 'PCT_CLAY_6', 'PCT_CLAY_1', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_16', 'PCT_CLAY_9', 'PCT_SAND_6', 'SCALARAVG_vr_4', 'Y_GPP', 'SCALARAVG_vr_11', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_13', 'PCT_SAND_7', 'PCT_CLAY_5', 'OCCLUDED_P', 'PCT_SAND_0', 'PCT_SAND_1', 'SCALARAVG_vr_7', 'AR', 'PCT_CLAY_7', 'APATITE_P']
2025-06-28 08:23:11,948 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:23:11,948 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_AR', 'Y_HR', 'Y_GPP']
2025-06-28 08:23:11,949 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:23:11,953 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:23:11,956 - __main__ - INFO - Splitting data...
2025-06-28 08:23:11,956 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:23:11,957 - __main__ - INFO - Creating model...
2025-06-28 08:23:11,957 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:23:11,957 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:23:11,957 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:23:11,957 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:23:11,957 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:23:11,957 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:23:11,957 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:23:11,957 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:23:11,972 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 08:23:11,972 - __main__ - INFO - Initializing trainer...
2025-06-28 08:23:12,293 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:23:13,652 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:23:13,652 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:23:13,652 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:23:13,652 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:23:13,652 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:23:13,652 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:23:13,653 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:23:13,653 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:23:13,653 - training.trainer - ERROR - Training pipeline failed: prefetch_factor option could only be specified in multiprocessing.let num_workers > 0 to enable multiprocessing, otherwise set prefetch_factor to None.
2025-06-28 08:23:13,653 - __main__ - ERROR - Training failed: prefetch_factor option could only be specified in multiprocessing.let num_workers > 0 to enable multiprocessing, otherwise set prefetch_factor to None.
2025-06-28 08:24:05,937 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 08:24:05,938 - __main__ - INFO - Initializing data loader...
2025-06-28 08:24:05,938 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 08:24:05,938 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 08:24:05,938 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 08:24:05,938 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 08:24:05,938 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 08:24:05,938 - data.data_loader - INFO - Total files to load: 3
2025-06-28 08:24:13,349 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 08:24:13,349 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 08:24:13,351 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 08:24:13,353 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 08:24:13,353 - data.data_loader - INFO - Processing time series data...
2025-06-28 08:24:13,387 - data.data_loader - INFO - Processing list columns...
2025-06-28 08:24:13,420 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 08:24:13,422 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 08:24:13,872 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_9', 'LANDFRAC_PFT', 'landfrac', 'SCALARAVG_vr_7', 'PCT_CLAY_0', 'GPP', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'H2OSOI_10CM', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_6', 'Y_COL_FIRE_CLOSS', 'SOIL_ORDER', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'PCT_NAT_PFT_1', 'Y_AR', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'PCT_SAND_0', 'PCT_CLAY_7', 'peatf', 'SNOWDP', 'PCT_SAND_5', 'PCT_NAT_PFT_0', 'HR', 'PCT_NAT_PFT_4', 'APATITE_P', 'Latitude', 'Y_GPP', 'SCALARAVG_vr_9', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'AR', 'PCT_SAND_4', 'PCT_NAT_PFT_2', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'Y_HR', 'PCT_CLAY_6', 'SCALARAVG_vr_0', 'SECONDARY_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_14', 'abm', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'Y_NPP', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_8', 'OCCLUDED_P']
2025-06-28 08:24:13,872 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:24:13,872 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_9', 'LANDFRAC_PFT', 'landfrac', 'SCALARAVG_vr_7', 'PCT_CLAY_0', 'GPP', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'H2OSOI_10CM', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_6', 'Y_COL_FIRE_CLOSS', 'SOIL_ORDER', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'PCT_NAT_PFT_1', 'Y_AR', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'PCT_SAND_0', 'PCT_CLAY_7', 'peatf', 'SNOWDP', 'PCT_SAND_5', 'PCT_NAT_PFT_0', 'HR', 'PCT_NAT_PFT_4', 'APATITE_P', 'Latitude', 'Y_GPP', 'SCALARAVG_vr_9', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'AR', 'PCT_SAND_4', 'PCT_NAT_PFT_2', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'Y_HR', 'PCT_CLAY_6', 'SCALARAVG_vr_0', 'SECONDARY_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_14', 'abm', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'Y_NPP', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_8', 'OCCLUDED_P'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP', 'Y_HR', 'Y_NPP'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 08:24:13,872 - __main__ - INFO - Normalizing data...
2025-06-28 08:24:13,874 - data.data_loader - INFO - Normalizing data...
2025-06-28 08:24:13,879 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_9', 'LANDFRAC_PFT', 'landfrac', 'SCALARAVG_vr_7', 'PCT_CLAY_0', 'GPP', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'H2OSOI_10CM', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_6', 'Y_COL_FIRE_CLOSS', 'SOIL_ORDER', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'PCT_NAT_PFT_1', 'Y_AR', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'PCT_SAND_0', 'PCT_CLAY_7', 'peatf', 'SNOWDP', 'PCT_SAND_5', 'PCT_NAT_PFT_0', 'HR', 'PCT_NAT_PFT_4', 'APATITE_P', 'Latitude', 'Y_GPP', 'SCALARAVG_vr_9', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'AR', 'PCT_SAND_4', 'PCT_NAT_PFT_2', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'Y_HR', 'PCT_CLAY_6', 'SCALARAVG_vr_0', 'SECONDARY_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_14', 'abm', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'Y_NPP', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_8', 'OCCLUDED_P']
2025-06-28 08:24:13,880 - data.data_loader - INFO - Found 5 target columns
2025-06-28 08:24:13,880 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 08:24:13,914 - data.data_loader - INFO - Normalizing static data...
2025-06-28 08:24:13,925 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_9', 'LANDFRAC_PFT', 'landfrac', 'SCALARAVG_vr_7', 'PCT_CLAY_0', 'GPP', 'PCT_NAT_PFT_16', 'SOIL_COLOR', 'H2OSOI_10CM', 'PCT_SAND_8', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_4', 'PCT_NAT_PFT_6', 'Y_COL_FIRE_CLOSS', 'SOIL_ORDER', 'SCALARAVG_vr_8', 'PCT_SAND_1', 'PCT_NAT_PFT_1', 'Y_AR', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_13', 'PCT_SAND_0', 'PCT_CLAY_7', 'peatf', 'SNOWDP', 'PCT_SAND_5', 'PCT_NAT_PFT_0', 'HR', 'PCT_NAT_PFT_4', 'APATITE_P', 'Latitude', 'Y_GPP', 'SCALARAVG_vr_9', 'SCALARAVG_vr_11', 'AREA', 'PCT_NAT_PFT_12', 'COL_FIRE_CLOSS', 'PCT_NAT_PFT_11', 'PCT_CLAY_5', 'NPP', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_7', 'Longitude', 'AR', 'PCT_SAND_4', 'PCT_NAT_PFT_2', 'PCT_CLAY_2', 'SCALARAVG_vr_12', 'SCALARAVG_vr_5', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'Y_HR', 'PCT_CLAY_6', 'SCALARAVG_vr_0', 'SECONDARY_P', 'SCALARAVG_vr_6', 'SCALARAVG_vr_14', 'abm', 'PCT_SAND_6', 'PCT_SAND_7', 'SCALARAVG_vr_2', 'PCT_NAT_PFT_15', 'PCT_CLAY_9', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_NATVEG', 'PCT_NAT_PFT_10', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_8', 'PCT_CLAY_1', 'PCT_SAND_2', 'PCT_NAT_PFT_3', 'Y_NPP', 'SCALARAVG_vr_3', 'PCT_SAND_9', 'PCT_CLAY_8', 'OCCLUDED_P']
2025-06-28 08:24:13,928 - data.data_loader - INFO - Normalizing target data...
2025-06-28 08:24:13,928 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_AR', 'Y_GPP', 'Y_HR', 'Y_NPP']
2025-06-28 08:24:13,929 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 08:24:13,932 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 08:24:13,935 - __main__ - INFO - Splitting data...
2025-06-28 08:24:13,936 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 08:24:13,936 - __main__ - INFO - Creating model...
2025-06-28 08:24:13,936 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 08:24:13,936 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 08:24:13,936 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 08:24:13,936 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 08:24:13,936 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 08:24:13,936 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 08:24:13,936 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 08:24:13,936 - models.combined_model - INFO - Vector length config: 16
2025-06-28 08:24:13,956 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 08:24:13,956 - __main__ - INFO - Initializing trainer...
2025-06-28 08:24:14,298 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 08:24:15,688 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:15,689 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:24:15,689 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 08:24:15,689 - __main__ - INFO - Starting training pipeline...
2025-06-28 08:24:15,689 - training.trainer - INFO - Starting training pipeline...
2025-06-28 08:24:15,689 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:15,689 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 08:24:15,689 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 08:24:16,200 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,200 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:24:16,200 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,213 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,226 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,237 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,307 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,323 - training.trainer - INFO - Epoch [1/2] - Train Loss: 4.8485, Val Loss: 1.8140, Time: 0.63s
2025-06-28 08:24:16,324 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,324 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:24:16,343 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,344 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:24:16,344 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,357 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,370 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,383 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,394 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,403 - training.trainer - INFO - Epoch [2/2] - Train Loss: 1.1653, Val Loss: 0.6113, Time: 0.08s
2025-06-28 08:24:16,403 - training.trainer - INFO - Training completed
2025-06-28 08:24:16,403 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 08:24:16,403 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 08:24:16,403 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 08:24:16,417 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 08:24:16,448 - training.trainer - INFO - All predictions saved successfully
2025-06-28 08:24:16,458 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 08:24:16,459 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 08:24:16,459 - __main__ - INFO - Training completed successfully!
2025-06-28 08:24:16,459 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.2737916560246809), 'scalar_mse': 0.07496187090873718, 'vector_rmse': np.float64(0.4350342577839946), 'vector_mse': 0.18925480544567108, 'matrix_rmse': np.float64(0.5985847441399835), 'matrix_mse': 0.3583036959171295}
2025-06-28 09:01:47,467 - __main__ - INFO - Starting training with configuration: full_model_test
2025-06-28 09:01:47,486 - __main__ - INFO - Initializing data loader...
2025-06-28 09:01:47,486 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 09:01:47,486 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 09:01:47,506 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 09:01:47,539 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 09:01:47,539 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 09:01:47,539 - data.data_loader - INFO - Total files to load: 3
2025-06-28 09:01:54,655 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 09:01:54,655 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 09:01:54,657 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 09:01:54,659 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 09:01:54,659 - data.data_loader - INFO - Processing time series data...
2025-06-28 09:01:54,687 - data.data_loader - INFO - Processing list columns...
2025-06-28 09:01:54,719 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 09:01:54,722 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 09:01:55,098 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_16', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_0', 'Y_HR', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_CLAY_6', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'HR', 'PCT_CLAY_0', 'Y_NPP', 'AREA', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_2', 'landfrac', 'PCT_NAT_PFT_1', 'Y_GPP', 'PCT_CLAY_1', 'H2OSOI_10CM', 'SECONDARY_P', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_CLAY_8', 'SOIL_ORDER', 'peatf', 'Latitude', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_CLAY_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_4', 'abm', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_7', 'PCT_SAND_7', 'PCT_SAND_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'OCCLUDED_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'NPP', 'PCT_NATVEG', 'PCT_SAND_9', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_11', 'PCT_CLAY_7', 'AR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_5', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'GPP']
2025-06-28 09:01:55,099 - data.data_loader - INFO - Found 5 target columns
2025-06-28 09:01:55,099 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_2', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_16', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_0', 'Y_HR', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_CLAY_6', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'HR', 'PCT_CLAY_0', 'Y_NPP', 'AREA', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_2', 'landfrac', 'PCT_NAT_PFT_1', 'Y_GPP', 'PCT_CLAY_1', 'H2OSOI_10CM', 'SECONDARY_P', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_CLAY_8', 'SOIL_ORDER', 'peatf', 'Latitude', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_CLAY_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_4', 'abm', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_7', 'PCT_SAND_7', 'PCT_SAND_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'OCCLUDED_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'NPP', 'PCT_NATVEG', 'PCT_SAND_9', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_11', 'PCT_CLAY_7', 'AR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_5', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'GPP'], 'target_columns': ['Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 09:01:55,099 - __main__ - INFO - Normalizing data...
2025-06-28 09:01:55,099 - data.data_loader - INFO - Normalizing data...
2025-06-28 09:01:55,104 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_16', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_0', 'Y_HR', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_CLAY_6', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'HR', 'PCT_CLAY_0', 'Y_NPP', 'AREA', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_2', 'landfrac', 'PCT_NAT_PFT_1', 'Y_GPP', 'PCT_CLAY_1', 'H2OSOI_10CM', 'SECONDARY_P', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_CLAY_8', 'SOIL_ORDER', 'peatf', 'Latitude', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_CLAY_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_4', 'abm', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_7', 'PCT_SAND_7', 'PCT_SAND_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'OCCLUDED_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'NPP', 'PCT_NATVEG', 'PCT_SAND_9', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_11', 'PCT_CLAY_7', 'AR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_5', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'GPP']
2025-06-28 09:01:55,105 - data.data_loader - INFO - Found 5 target columns
2025-06-28 09:01:55,105 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 09:01:55,136 - data.data_loader - INFO - Normalizing static data...
2025-06-28 09:01:55,142 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_2', 'APATITE_P', 'SCALARAVG_vr_7', 'PCT_NAT_PFT_16', 'LABILE_P', 'SCALARAVG_vr_10', 'SCALARAVG_vr_0', 'Y_HR', 'SOIL_COLOR', 'PCT_NAT_PFT_13', 'PCT_CLAY_9', 'PCT_CLAY_6', 'LANDFRAC_PFT', 'PCT_SAND_3', 'PCT_NAT_PFT_14', 'HR', 'PCT_CLAY_0', 'Y_NPP', 'AREA', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_2', 'landfrac', 'PCT_NAT_PFT_1', 'Y_GPP', 'PCT_CLAY_1', 'H2OSOI_10CM', 'SECONDARY_P', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_15', 'PCT_CLAY_8', 'SOIL_ORDER', 'peatf', 'Latitude', 'Y_COL_FIRE_CLOSS', 'SNOWDP', 'PCT_NAT_PFT_12', 'PCT_SAND_5', 'PCT_CLAY_5', 'SCALARAVG_vr_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_4', 'abm', 'Longitude', 'PCT_SAND_1', 'SCALARAVG_vr_9', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_7', 'PCT_SAND_7', 'PCT_SAND_4', 'PCT_CLAY_4', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'OCCLUDED_P', 'PCT_NAT_PFT_5', 'SCALARAVG_vr_8', 'PCT_CLAY_3', 'PCT_SAND_8', 'COL_FIRE_CLOSS', 'NPP', 'PCT_NATVEG', 'PCT_SAND_9', 'SCALARAVG_vr_12', 'PCT_NAT_PFT_11', 'PCT_CLAY_7', 'AR', 'SCALARAVG_vr_3', 'SCALARAVG_vr_5', 'Y_AR', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'PCT_NAT_PFT_6', 'PCT_SAND_6', 'GPP']
2025-06-28 09:01:55,162 - data.data_loader - INFO - Normalizing target data...
2025-06-28 09:01:55,162 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_HR', 'Y_NPP', 'Y_COL_FIRE_CLOSS', 'Y_GPP', 'Y_AR']
2025-06-28 09:01:55,163 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 09:01:55,167 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 09:01:55,170 - __main__ - INFO - Splitting data...
2025-06-28 09:01:55,170 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 09:01:55,170 - __main__ - INFO - Creating model...
2025-06-28 09:01:55,171 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 09:01:55,171 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 09:01:55,171 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 09:01:55,171 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 09:01:55,171 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 09:01:55,171 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 09:01:55,171 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 09:01:55,171 - models.combined_model - INFO - Vector length config: 16
2025-06-28 09:01:55,321 - models.combined_model - INFO - Model initialized with 2283156 parameters
2025-06-28 09:01:55,321 - __main__ - INFO - Initializing trainer...
2025-06-28 09:01:55,900 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 09:02:06,178 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:06,179 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.01GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 09:02:06,179 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 09:02:06,179 - __main__ - INFO - Starting training pipeline...
2025-06-28 09:02:06,179 - training.trainer - INFO - Starting training pipeline...
2025-06-28 09:02:06,179 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:06,179 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.01GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 09:02:06,179 - training.trainer - INFO - Starting training for 10 epochs...
2025-06-28 09:02:07,714 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,714 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:07,715 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,775 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,846 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,869 - training.trainer - INFO - Epoch [1/10] - Train Loss: 3.8656, Val Loss: 3.7436, Time: 1.69s
2025-06-28 09:02:07,869 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,870 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:07,906 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,906 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:07,906 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,970 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:07,993 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,003 - training.trainer - INFO - Epoch [2/10] - Train Loss: 4.1944, Val Loss: 5.6416, Time: 0.13s
2025-06-28 09:02:08,025 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,025 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,026 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,077 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,098 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,108 - training.trainer - INFO - Epoch [3/10] - Train Loss: 3.7456, Val Loss: 0.8403, Time: 0.10s
2025-06-28 09:02:08,136 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,136 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,136 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,161 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,181 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,197 - training.trainer - INFO - Epoch [4/10] - Train Loss: 0.8746, Val Loss: 0.6416, Time: 0.09s
2025-06-28 09:02:08,225 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,225 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,225 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,251 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,271 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,281 - training.trainer - INFO - Epoch [5/10] - Train Loss: 0.4573, Val Loss: 0.2813, Time: 0.08s
2025-06-28 09:02:08,303 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,303 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,303 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,329 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,348 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,362 - training.trainer - INFO - Epoch [6/10] - Train Loss: 0.3284, Val Loss: 0.1247, Time: 0.08s
2025-06-28 09:02:08,362 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,362 - utils.gpu_monitor - INFO - Epoch 6 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,392 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,392 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,393 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,417 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,439 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,452 - training.trainer - INFO - Epoch [7/10] - Train Loss: 0.1111, Val Loss: 0.0771, Time: 0.09s
2025-06-28 09:02:08,508 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,508 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,508 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,540 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,562 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,570 - training.trainer - INFO - Epoch [8/10] - Train Loss: 0.1259, Val Loss: 0.0689, Time: 0.12s
2025-06-28 09:02:08,594 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,594 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,594 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,616 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,639 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,649 - training.trainer - INFO - Epoch [9/10] - Train Loss: 0.0735, Val Loss: 0.0521, Time: 0.08s
2025-06-28 09:02:08,671 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,671 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,672 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,710 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,733 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,742 - training.trainer - INFO - Epoch [10/10] - Train Loss: 0.0885, Val Loss: 0.0209, Time: 0.09s
2025-06-28 09:02:08,820 - training.trainer - INFO - Training completed
2025-06-28 09:02:08,820 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 09:02:08,820 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.05GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 09:02:08,820 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 09:02:08,879 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 09:02:09,004 - training.trainer - INFO - All predictions saved successfully
2025-06-28 09:02:09,041 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 09:02:09,067 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 09:02:09,067 - __main__ - INFO - Training completed successfully!
2025-06-28 09:02:09,067 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.14344533660981545), 'scalar_mse': 0.020576564595103264, 'vector_rmse': np.float64(0.009728951062139111), 'vector_mse': 9.465248876949772e-05, 'matrix_rmse': np.float64(0.014004012926113025), 'matrix_mse': 0.00019611237803474069}
2025-06-28 15:28:14,344 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 15:28:14,360 - __main__ - INFO - Initializing data loader...
2025-06-28 15:28:14,360 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 15:28:14,360 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 15:28:14,373 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 15:28:14,398 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 15:28:14,398 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 15:28:14,398 - data.data_loader - INFO - Total files to load: 3
2025-06-28 15:28:21,455 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 15:28:21,456 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 15:28:21,458 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 15:28:21,460 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 15:28:21,460 - data.data_loader - INFO - Processing time series data...
2025-06-28 15:28:21,488 - data.data_loader - INFO - Processing list columns...
2025-06-28 15:28:21,522 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 15:28:21,525 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 15:28:21,935 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_3', 'LABILE_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'Y_AR', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_SAND_5', 'COL_FIRE_CLOSS', 'Y_NPP', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'Y_HR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_12', 'landfrac', 'PCT_SAND_1', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SECONDARY_P', 'NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_6', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'AREA', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_NAT_PFT_10', 'PCT_CLAY_7', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NATVEG', 'PCT_CLAY_3', 'LANDFRAC_PFT', 'SNOWDP', 'PCT_NAT_PFT_15', 'Y_GPP', 'peatf', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'SOIL_ORDER', 'PCT_SAND_7', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'abm', 'SCALARAVG_vr_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'AR', 'HR', 'GPP', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'SCALARAVG_vr_0', 'PCT_CLAY_9', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'PCT_SAND_9', 'PCT_SAND_3', 'Latitude', 'SCALARAVG_vr_6', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_14']
2025-06-28 15:28:21,935 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:28:21,936 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['SCALARAVG_vr_3', 'LABILE_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'Y_AR', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_SAND_5', 'COL_FIRE_CLOSS', 'Y_NPP', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'Y_HR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_12', 'landfrac', 'PCT_SAND_1', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SECONDARY_P', 'NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_6', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'AREA', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_NAT_PFT_10', 'PCT_CLAY_7', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NATVEG', 'PCT_CLAY_3', 'LANDFRAC_PFT', 'SNOWDP', 'PCT_NAT_PFT_15', 'Y_GPP', 'peatf', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'SOIL_ORDER', 'PCT_SAND_7', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'abm', 'SCALARAVG_vr_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'AR', 'HR', 'GPP', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'SCALARAVG_vr_0', 'PCT_CLAY_9', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'PCT_SAND_9', 'PCT_SAND_3', 'Latitude', 'SCALARAVG_vr_6', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_14'], 'target_columns': ['Y_AR', 'Y_NPP', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_HR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 15:28:22,005 - __main__ - INFO - Normalizing data...
2025-06-28 15:28:22,005 - data.data_loader - INFO - Normalizing data...
2025-06-28 15:28:22,011 - data.data_loader - INFO - Found 78 static columns: ['SCALARAVG_vr_3', 'LABILE_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'Y_AR', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_SAND_5', 'COL_FIRE_CLOSS', 'Y_NPP', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'Y_HR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_12', 'landfrac', 'PCT_SAND_1', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SECONDARY_P', 'NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_6', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'AREA', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_NAT_PFT_10', 'PCT_CLAY_7', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NATVEG', 'PCT_CLAY_3', 'LANDFRAC_PFT', 'SNOWDP', 'PCT_NAT_PFT_15', 'Y_GPP', 'peatf', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'SOIL_ORDER', 'PCT_SAND_7', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'abm', 'SCALARAVG_vr_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'AR', 'HR', 'GPP', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'SCALARAVG_vr_0', 'PCT_CLAY_9', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'PCT_SAND_9', 'PCT_SAND_3', 'Latitude', 'SCALARAVG_vr_6', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_14']
2025-06-28 15:28:22,011 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:28:22,011 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 15:28:22,084 - data.data_loader - INFO - Normalizing static data...
2025-06-28 15:28:22,091 - data.data_loader - INFO - Normalizing 78 static columns: ['SCALARAVG_vr_3', 'LABILE_P', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_4', 'PCT_SAND_0', 'Y_AR', 'PCT_CLAY_1', 'PCT_NAT_PFT_11', 'PCT_SAND_5', 'COL_FIRE_CLOSS', 'Y_NPP', 'SOIL_COLOR', 'PCT_NAT_PFT_5', 'PCT_CLAY_2', 'Y_HR', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_12', 'landfrac', 'PCT_SAND_1', 'SCALARAVG_vr_12', 'SCALARAVG_vr_4', 'SECONDARY_P', 'NPP', 'PCT_NAT_PFT_16', 'PCT_SAND_6', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_1', 'AREA', 'PCT_NAT_PFT_9', 'SCALARAVG_vr_7', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_NAT_PFT_10', 'PCT_CLAY_7', 'H2OSOI_10CM', 'PCT_NAT_PFT_3', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NATVEG', 'PCT_CLAY_3', 'LANDFRAC_PFT', 'SNOWDP', 'PCT_NAT_PFT_15', 'Y_GPP', 'peatf', 'PCT_CLAY_5', 'PCT_NAT_PFT_7', 'SOIL_ORDER', 'PCT_SAND_7', 'OCCLUDED_P', 'SCALARAVG_vr_11', 'abm', 'SCALARAVG_vr_1', 'Y_COL_FIRE_CLOSS', 'PCT_NAT_PFT_8', 'AR', 'HR', 'GPP', 'SCALARAVG_vr_13', 'PCT_CLAY_4', 'SCALARAVG_vr_2', 'PCT_SAND_2', 'SCALARAVG_vr_0', 'PCT_CLAY_9', 'PCT_SAND_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_10', 'PCT_SAND_9', 'PCT_SAND_3', 'Latitude', 'SCALARAVG_vr_6', 'PCT_CLAY_8', 'PCT_CLAY_6', 'PCT_SAND_8', 'SCALARAVG_vr_9', 'Longitude', 'PCT_NAT_PFT_14']
2025-06-28 15:28:22,093 - data.data_loader - INFO - Normalizing target data...
2025-06-28 15:28:22,094 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_AR', 'Y_NPP', 'Y_GPP', 'Y_COL_FIRE_CLOSS', 'Y_HR']
2025-06-28 15:28:22,095 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 15:28:22,099 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 15:28:22,103 - __main__ - INFO - Splitting data...
2025-06-28 15:28:22,104 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 15:28:22,104 - __main__ - INFO - Creating model...
2025-06-28 15:28:22,104 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 15:28:22,104 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 15:28:22,105 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 15:28:22,105 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 15:28:22,105 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 15:28:22,105 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 15:28:22,105 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 15:28:22,105 - models.combined_model - INFO - Vector length config: 16
2025-06-28 15:28:22,129 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 15:28:22,130 - __main__ - INFO - Initializing trainer...
2025-06-28 15:28:22,207 - training.trainer - INFO - Random seed set to 42
2025-06-28 15:28:22,208 - training.trainer - INFO - Deterministic behavior enabled
2025-06-28 15:28:22,951 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 15:28:38,238 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:28:38,238 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:28:38,239 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 15:28:38,239 - __main__ - INFO - Starting training pipeline...
2025-06-28 15:28:38,239 - training.trainer - INFO - Starting training pipeline...
2025-06-28 15:28:38,239 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:28:38,239 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:28:38,239 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 15:28:40,252 - training.trainer - ERROR - Training pipeline failed: tuple indices must be integers or slices, not str
2025-06-28 15:28:40,253 - __main__ - ERROR - Training failed: tuple indices must be integers or slices, not str
2025-06-28 15:30:07,111 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 15:30:07,112 - __main__ - INFO - Initializing data loader...
2025-06-28 15:30:07,112 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 15:30:07,112 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 15:30:07,112 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 15:30:07,112 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 15:30:07,112 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 15:30:07,112 - data.data_loader - INFO - Total files to load: 3
2025-06-28 15:30:14,127 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 15:30:14,128 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 15:30:14,130 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 15:30:14,132 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 15:30:14,132 - data.data_loader - INFO - Processing time series data...
2025-06-28 15:30:14,160 - data.data_loader - INFO - Processing list columns...
2025-06-28 15:30:14,198 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 15:30:14,202 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 15:30:14,607 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_7', 'PCT_SAND_5', 'landfrac', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'APATITE_P', 'Y_NPP', 'GPP', 'AREA', 'NPP', 'Y_GPP', 'SCALARAVG_vr_12', 'SNOWDP', 'SCALARAVG_vr_7', 'PCT_SAND_7', 'Y_AR', 'Latitude', 'SOIL_ORDER', 'HR', 'SCALARAVG_vr_2', 'SOIL_COLOR', 'OCCLUDED_P', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_1', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'AR', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'SCALARAVG_vr_5', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_SAND_8', 'abm', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'COL_FIRE_CLOSS', 'PCT_SAND_0', 'Longitude', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_0', 'PCT_CLAY_5', 'PCT_SAND_3', 'PCT_SAND_4', 'peatf', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'LABILE_P', 'PCT_NAT_PFT_11', 'SECONDARY_P', 'PCT_CLAY_9', 'PCT_CLAY_4', 'PCT_CLAY_6', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1']
2025-06-28 15:30:14,607 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:30:14,607 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_NAT_PFT_7', 'PCT_SAND_5', 'landfrac', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'APATITE_P', 'Y_NPP', 'GPP', 'AREA', 'NPP', 'Y_GPP', 'SCALARAVG_vr_12', 'SNOWDP', 'SCALARAVG_vr_7', 'PCT_SAND_7', 'Y_AR', 'Latitude', 'SOIL_ORDER', 'HR', 'SCALARAVG_vr_2', 'SOIL_COLOR', 'OCCLUDED_P', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_1', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'AR', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'SCALARAVG_vr_5', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_SAND_8', 'abm', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'COL_FIRE_CLOSS', 'PCT_SAND_0', 'Longitude', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_0', 'PCT_CLAY_5', 'PCT_SAND_3', 'PCT_SAND_4', 'peatf', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'LABILE_P', 'PCT_NAT_PFT_11', 'SECONDARY_P', 'PCT_CLAY_9', 'PCT_CLAY_4', 'PCT_CLAY_6', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_NPP', 'Y_GPP', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 15:30:14,607 - __main__ - INFO - Normalizing data...
2025-06-28 15:30:14,608 - data.data_loader - INFO - Normalizing data...
2025-06-28 15:30:14,613 - data.data_loader - INFO - Found 78 static columns: ['PCT_NAT_PFT_7', 'PCT_SAND_5', 'landfrac', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'APATITE_P', 'Y_NPP', 'GPP', 'AREA', 'NPP', 'Y_GPP', 'SCALARAVG_vr_12', 'SNOWDP', 'SCALARAVG_vr_7', 'PCT_SAND_7', 'Y_AR', 'Latitude', 'SOIL_ORDER', 'HR', 'SCALARAVG_vr_2', 'SOIL_COLOR', 'OCCLUDED_P', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_1', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'AR', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'SCALARAVG_vr_5', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_SAND_8', 'abm', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'COL_FIRE_CLOSS', 'PCT_SAND_0', 'Longitude', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_0', 'PCT_CLAY_5', 'PCT_SAND_3', 'PCT_SAND_4', 'peatf', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'LABILE_P', 'PCT_NAT_PFT_11', 'SECONDARY_P', 'PCT_CLAY_9', 'PCT_CLAY_4', 'PCT_CLAY_6', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1']
2025-06-28 15:30:14,614 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:30:14,614 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 15:30:14,660 - data.data_loader - INFO - Normalizing static data...
2025-06-28 15:30:14,667 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_NAT_PFT_7', 'PCT_SAND_5', 'landfrac', 'PCT_NAT_PFT_14', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'PCT_NAT_PFT_8', 'LANDFRAC_PFT', 'SCALARAVG_vr_3', 'PCT_SAND_6', 'SCALARAVG_vr_6', 'APATITE_P', 'Y_NPP', 'GPP', 'AREA', 'NPP', 'Y_GPP', 'SCALARAVG_vr_12', 'SNOWDP', 'SCALARAVG_vr_7', 'PCT_SAND_7', 'Y_AR', 'Latitude', 'SOIL_ORDER', 'HR', 'SCALARAVG_vr_2', 'SOIL_COLOR', 'OCCLUDED_P', 'H2OSOI_10CM', 'PCT_CLAY_3', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_10', 'PCT_SAND_9', 'Y_COL_FIRE_CLOSS', 'PCT_CLAY_1', 'PCT_NAT_PFT_16', 'PCT_NAT_PFT_3', 'Y_HR', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_6', 'PCT_NATVEG', 'AR', 'PCT_CLAY_7', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'PCT_CLAY_8', 'SCALARAVG_vr_5', 'SCALARAVG_vr_9', 'PCT_SAND_1', 'PCT_CLAY_2', 'PCT_SAND_8', 'abm', 'PCT_SAND_2', 'SCALARAVG_vr_4', 'COL_FIRE_CLOSS', 'PCT_SAND_0', 'Longitude', 'PCT_NAT_PFT_4', 'SCALARAVG_vr_8', 'SCALARAVG_vr_0', 'PCT_CLAY_5', 'PCT_SAND_3', 'PCT_SAND_4', 'peatf', 'PCT_CLAY_0', 'PCT_NAT_PFT_5', 'LABILE_P', 'PCT_NAT_PFT_11', 'SECONDARY_P', 'PCT_CLAY_9', 'PCT_CLAY_4', 'PCT_CLAY_6', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_1']
2025-06-28 15:30:14,670 - data.data_loader - INFO - Normalizing target data...
2025-06-28 15:30:14,671 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_HR', 'Y_NPP', 'Y_GPP', 'Y_AR']
2025-06-28 15:30:14,672 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 15:30:14,675 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 15:30:14,678 - __main__ - INFO - Splitting data...
2025-06-28 15:30:14,678 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 15:30:14,679 - __main__ - INFO - Creating model...
2025-06-28 15:30:14,679 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 15:30:14,679 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 15:30:14,679 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 15:30:14,679 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 15:30:14,679 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 15:30:14,679 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 15:30:14,679 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 15:30:14,680 - models.combined_model - INFO - Vector length config: 16
2025-06-28 15:30:14,744 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 15:30:14,745 - __main__ - INFO - Initializing trainer...
2025-06-28 15:30:14,748 - training.trainer - INFO - Random seed set to 42
2025-06-28 15:30:14,748 - training.trainer - INFO - Deterministic behavior enabled
2025-06-28 15:30:15,121 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 15:30:17,369 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:17,370 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:30:17,370 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 15:30:17,370 - __main__ - INFO - Starting training pipeline...
2025-06-28 15:30:17,370 - training.trainer - INFO - Starting training pipeline...
2025-06-28 15:30:17,370 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:17,370 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:30:17,370 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 15:30:19,243 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,244 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 15:30:19,244 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,265 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,278 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,386 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,444 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:19,454 - training.trainer - ERROR - Training pipeline failed: cannot access local variable 'loss' where it is not associated with a value
2025-06-28 15:30:19,454 - __main__ - ERROR - Training failed: cannot access local variable 'loss' where it is not associated with a value
2025-06-28 15:30:43,957 - __main__ - INFO - Starting training with configuration: minimal
2025-06-28 15:30:43,957 - __main__ - INFO - Initializing data loader...
2025-06-28 15:30:43,957 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 15:30:43,957 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 15:30:43,958 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 15:30:43,958 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 15:30:43,958 - data.data_loader - INFO - Limited to 3 files for testing
2025-06-28 15:30:43,958 - data.data_loader - INFO - Total files to load: 3
2025-06-28 15:30:50,718 - data.data_loader - INFO - Successfully loaded 3000 samples
2025-06-28 15:30:50,718 - data.data_loader - INFO - Starting data preprocessing...
2025-06-28 15:30:50,720 - data.data_loader - INFO - Dropped columns: ['Y_OCCLUDED_P', 'Y_SECONDARY_P', 'Y_LABILE_P', 'Y_APATITE_P']
2025-06-28 15:30:50,722 - data.data_loader - INFO - Filtered data: 3000 -> 168 samples
2025-06-28 15:30:50,722 - data.data_loader - INFO - Processing time series data...
2025-06-28 15:30:50,750 - data.data_loader - INFO - Processing list columns...
2025-06-28 15:30:50,782 - data.data_loader - INFO - Shuffling dataset...
2025-06-28 15:30:50,785 - data.data_loader - INFO - Data preprocessing completed
2025-06-28 15:30:51,111 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'PCT_NAT_PFT_5', 'SNOWDP', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_9', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_8', 'SCALARAVG_vr_4', 'landfrac', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_10', 'GPP', 'HR', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'Latitude', 'COL_FIRE_CLOSS', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_8', 'PCT_SAND_1', 'PCT_CLAY_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_SAND_9', 'PCT_NATVEG', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_11', 'PCT_CLAY_9', 'AR', 'SCALARAVG_vr_6', 'PCT_SAND_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'NPP', 'SCALARAVG_vr_7', 'H2OSOI_10CM', 'PCT_SAND_2', 'Y_NPP', 'APATITE_P', 'SOIL_ORDER', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_3', 'AREA', 'PCT_SAND_7', 'Y_AR', 'PCT_NAT_PFT_16', 'PCT_CLAY_6', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'Y_GPP', 'PCT_CLAY_7', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'abm', 'LABILE_P', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_SAND_3', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_10']
2025-06-28 15:30:51,111 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:30:51,111 - __main__ - INFO - Data info: {'total_samples': 168, 'time_series_columns': ['FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT'], 'static_columns': ['PCT_CLAY_2', 'PCT_NAT_PFT_5', 'SNOWDP', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_9', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_8', 'SCALARAVG_vr_4', 'landfrac', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_10', 'GPP', 'HR', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'Latitude', 'COL_FIRE_CLOSS', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_8', 'PCT_SAND_1', 'PCT_CLAY_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_SAND_9', 'PCT_NATVEG', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_11', 'PCT_CLAY_9', 'AR', 'SCALARAVG_vr_6', 'PCT_SAND_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'NPP', 'SCALARAVG_vr_7', 'H2OSOI_10CM', 'PCT_SAND_2', 'Y_NPP', 'APATITE_P', 'SOIL_ORDER', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_3', 'AREA', 'PCT_SAND_7', 'Y_AR', 'PCT_NAT_PFT_16', 'PCT_CLAY_6', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'Y_GPP', 'PCT_CLAY_7', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'abm', 'LABILE_P', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_SAND_3', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_10'], 'target_columns': ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_GPP', 'Y_HR', 'Y_AR'], 'x_list_columns_1d': ['deadcrootc', 'deadstemc', 'tlai'], 'y_list_columns_1d': ['Y_deadcrootc', 'Y_deadstemc', 'Y_tlai'], 'x_list_columns_2d': ['soil3c_vr', 'soil4c_vr', 'cwdc_vr'], 'y_list_columns_2d': ['Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr'], 'available_columns': ['landfrac', 'Latitude', 'Longitude', 'FLDS', 'PSRF', 'FSDS', 'QBOT', 'PRECTmms', 'TBOT', 'LANDFRAC_PFT', 'PCT_NATVEG', 'AREA', 'peatf', 'abm', 'SOIL_COLOR', 'SOIL_ORDER', 'soil3c_vr', 'soil4c_vr', 'cwdc_vr', 'deadcrootc', 'deadstemc', 'tlai', 'GPP', 'SNOWDP', 'H2OSOI_10CM', 'HR', 'AR', 'NPP', 'COL_FIRE_CLOSS', 'OCCLUDED_P', 'SECONDARY_P', 'LABILE_P', 'APATITE_P', 'PCT_NAT_PFT_0', 'PCT_NAT_PFT_1', 'PCT_NAT_PFT_2', 'PCT_NAT_PFT_3', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_5', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_7', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_9', 'PCT_NAT_PFT_10', 'PCT_NAT_PFT_11', 'PCT_NAT_PFT_12', 'PCT_NAT_PFT_13', 'PCT_NAT_PFT_14', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_16', 'PCT_SAND_0', 'PCT_SAND_1', 'PCT_SAND_2', 'PCT_SAND_3', 'PCT_SAND_4', 'PCT_SAND_5', 'PCT_SAND_6', 'PCT_SAND_7', 'PCT_SAND_8', 'PCT_SAND_9', 'SCALARAVG_vr_0', 'SCALARAVG_vr_1', 'SCALARAVG_vr_2', 'SCALARAVG_vr_3', 'SCALARAVG_vr_4', 'SCALARAVG_vr_5', 'SCALARAVG_vr_6', 'SCALARAVG_vr_7', 'SCALARAVG_vr_8', 'SCALARAVG_vr_9', 'SCALARAVG_vr_10', 'SCALARAVG_vr_11', 'SCALARAVG_vr_12', 'SCALARAVG_vr_13', 'SCALARAVG_vr_14', 'PCT_CLAY_0', 'PCT_CLAY_1', 'PCT_CLAY_2', 'PCT_CLAY_3', 'PCT_CLAY_4', 'PCT_CLAY_5', 'PCT_CLAY_6', 'PCT_CLAY_7', 'PCT_CLAY_8', 'PCT_CLAY_9', 'Y_soil3c_vr', 'Y_soil4c_vr', 'Y_cwdc_vr', 'Y_deadcrootc', 'Y_deadstemc', 'Y_tlai', 'Y_GPP', 'Y_HR', 'Y_AR', 'Y_NPP', 'Y_COL_FIRE_CLOSS'], 'matrix_rows': 18, 'matrix_cols': 10}
2025-06-28 15:30:51,112 - __main__ - INFO - Normalizing data...
2025-06-28 15:30:51,112 - data.data_loader - INFO - Normalizing data...
2025-06-28 15:30:51,117 - data.data_loader - INFO - Found 78 static columns: ['PCT_CLAY_2', 'PCT_NAT_PFT_5', 'SNOWDP', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_9', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_8', 'SCALARAVG_vr_4', 'landfrac', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_10', 'GPP', 'HR', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'Latitude', 'COL_FIRE_CLOSS', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_8', 'PCT_SAND_1', 'PCT_CLAY_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_SAND_9', 'PCT_NATVEG', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_11', 'PCT_CLAY_9', 'AR', 'SCALARAVG_vr_6', 'PCT_SAND_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'NPP', 'SCALARAVG_vr_7', 'H2OSOI_10CM', 'PCT_SAND_2', 'Y_NPP', 'APATITE_P', 'SOIL_ORDER', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_3', 'AREA', 'PCT_SAND_7', 'Y_AR', 'PCT_NAT_PFT_16', 'PCT_CLAY_6', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'Y_GPP', 'PCT_CLAY_7', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'abm', 'LABILE_P', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_SAND_3', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_10']
2025-06-28 15:30:51,117 - data.data_loader - INFO - Found 5 target columns
2025-06-28 15:30:51,118 - data.data_loader - INFO - Normalizing time series data...
2025-06-28 15:30:51,147 - data.data_loader - INFO - Normalizing static data...
2025-06-28 15:30:51,153 - data.data_loader - INFO - Normalizing 78 static columns: ['PCT_CLAY_2', 'PCT_NAT_PFT_5', 'SNOWDP', 'PCT_NAT_PFT_1', 'SCALARAVG_vr_13', 'PCT_NAT_PFT_15', 'PCT_NAT_PFT_9', 'PCT_CLAY_5', 'Y_HR', 'PCT_CLAY_8', 'SCALARAVG_vr_4', 'landfrac', 'PCT_SAND_5', 'LANDFRAC_PFT', 'PCT_NAT_PFT_13', 'SCALARAVG_vr_10', 'GPP', 'HR', 'Longitude', 'PCT_SAND_6', 'SCALARAVG_vr_9', 'OCCLUDED_P', 'Latitude', 'COL_FIRE_CLOSS', 'Y_COL_FIRE_CLOSS', 'PCT_SAND_8', 'PCT_SAND_1', 'PCT_CLAY_4', 'PCT_NAT_PFT_7', 'SCALARAVG_vr_11', 'SECONDARY_P', 'PCT_SAND_9', 'PCT_NATVEG', 'peatf', 'SCALARAVG_vr_8', 'PCT_NAT_PFT_11', 'PCT_CLAY_9', 'AR', 'SCALARAVG_vr_6', 'PCT_SAND_4', 'PCT_NAT_PFT_4', 'PCT_NAT_PFT_14', 'NPP', 'SCALARAVG_vr_7', 'H2OSOI_10CM', 'PCT_SAND_2', 'Y_NPP', 'APATITE_P', 'SOIL_ORDER', 'PCT_NAT_PFT_6', 'PCT_NAT_PFT_12', 'SCALARAVG_vr_3', 'AREA', 'PCT_SAND_7', 'Y_AR', 'PCT_NAT_PFT_16', 'PCT_CLAY_6', 'PCT_CLAY_1', 'SCALARAVG_vr_14', 'SCALARAVG_vr_1', 'SCALARAVG_vr_0', 'SCALARAVG_vr_2', 'Y_GPP', 'PCT_CLAY_7', 'PCT_CLAY_0', 'PCT_NAT_PFT_3', 'SOIL_COLOR', 'abm', 'LABILE_P', 'SCALARAVG_vr_12', 'PCT_SAND_0', 'PCT_NAT_PFT_2', 'PCT_SAND_3', 'PCT_CLAY_3', 'PCT_NAT_PFT_0', 'SCALARAVG_vr_5', 'PCT_NAT_PFT_8', 'PCT_NAT_PFT_10']
2025-06-28 15:30:51,155 - data.data_loader - INFO - Normalizing target data...
2025-06-28 15:30:51,155 - data.data_loader - INFO - Normalizing 5 target columns: ['Y_COL_FIRE_CLOSS', 'Y_NPP', 'Y_GPP', 'Y_HR', 'Y_AR']
2025-06-28 15:30:51,156 - data.data_loader - INFO - Normalizing 1D list data...
2025-06-28 15:30:51,159 - data.data_loader - INFO - Normalizing 2D list data...
2025-06-28 15:30:51,162 - __main__ - INFO - Splitting data...
2025-06-28 15:30:51,162 - data.data_loader - INFO - Splitting data into train/test sets...
2025-06-28 15:30:51,162 - __main__ - INFO - Creating model...
2025-06-28 15:30:51,162 - __main__ - INFO - Detected actual 1D input size: 48
2025-06-28 15:30:51,162 - __main__ - INFO - Detected actual 2D channels: 3
2025-06-28 15:30:51,162 - models.combined_model - INFO - Using actual 1D input size: 48
2025-06-28 15:30:51,163 - models.combined_model - INFO - Using actual 2D channels: 3
2025-06-28 15:30:51,163 - models.combined_model - INFO - Input dimensions - LSTM: 6, Static: 78, 1D: 48, 2D: 540 (channels: 3)
2025-06-28 15:30:51,163 - models.combined_model - INFO - 1D columns: ['deadcrootc', 'deadstemc', 'tlai']
2025-06-28 15:30:51,163 - models.combined_model - INFO - 2D columns: ['soil3c_vr', 'soil4c_vr', 'cwdc_vr']
2025-06-28 15:30:51,163 - models.combined_model - INFO - Vector length config: 16
2025-06-28 15:30:51,179 - models.combined_model - INFO - Model initialized with 672148 parameters
2025-06-28 15:30:51,179 - __main__ - INFO - Initializing trainer...
2025-06-28 15:30:51,181 - training.trainer - INFO - Random seed set to 42
2025-06-28 15:30:51,181 - training.trainer - INFO - Deterministic behavior enabled
2025-06-28 15:30:51,522 - training.trainer - INFO - Automatic Mixed Precision (AMP) enabled
2025-06-28 15:30:52,889 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:52,889 - utils.gpu_monitor - INFO - Initial GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:30:52,889 - training.trainer - INFO - Trainer initialized on device: cuda
2025-06-28 15:30:52,889 - __main__ - INFO - Starting training pipeline...
2025-06-28 15:30:52,889 - training.trainer - INFO - Starting training pipeline...
2025-06-28 15:30:52,890 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:52,890 - utils.gpu_monitor - INFO - Training start - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.0GB/39.38GB (0.0%) | Util: 0.0%
2025-06-28 15:30:52,890 - training.trainer - INFO - Starting training for 2 epochs...
2025-06-28 15:30:53,433 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,433 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.02GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 15:30:53,435 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,450 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,460 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,516 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,546 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,563 - training.trainer - INFO - Epoch [1/2] - Train Loss: 2.9229, Val Loss: 4.1032, Time: 0.67s
2025-06-28 15:30:53,563 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,563 - utils.gpu_monitor - INFO - Epoch 1 - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 15:30:53,576 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,576 - utils.gpu_monitor - INFO - Batch 0 GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 15:30:53,577 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,590 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,601 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,613 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,627 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,636 - training.trainer - INFO - Epoch [2/2] - Train Loss: 1.6874, Val Loss: 0.7597, Time: 0.07s
2025-06-28 15:30:53,636 - training.trainer - INFO - Training completed
2025-06-28 15:30:53,636 - utils.gpu_monitor - WARNING - Failed to get GPU utilization: 'NoneType' object cannot be interpreted as an integer
2025-06-28 15:30:53,636 - utils.gpu_monitor - INFO - Training end - GPU: NVIDIA A100-PCIE-40GB | Memory: 0.03GB/39.38GB (0.1%) | Util: 0.0%
2025-06-28 15:30:53,636 - training.trainer - INFO - Evaluating model on test data...
2025-06-28 15:30:53,684 - training.trainer - INFO - Losses saved to training_validation_losses.csv
2025-06-28 15:30:53,720 - training.trainer - INFO - All predictions saved successfully
2025-06-28 15:30:53,736 - training.trainer - INFO - Model saved to predictions/model.pth
2025-06-28 15:30:53,737 - training.trainer - INFO - Metrics saved to predictions/test_metrics.csv
2025-06-28 15:30:53,737 - __main__ - INFO - Training completed successfully!
2025-06-28 15:30:53,737 - __main__ - INFO - Final metrics: {'scalar_rmse': np.float64(0.36432616382576066), 'scalar_mse': 0.132733553647995, 'vector_rmse': np.float64(0.5277238112041079), 'vector_mse': 0.27849242091178894, 'matrix_rmse': np.float64(0.5950684214769035), 'matrix_mse': 0.35410642623901367}
2025-06-28 15:31:01,912 - __main__ - INFO - Starting training with configuration: full_dataset
2025-06-28 15:31:01,912 - __main__ - INFO - Initializing data loader...
2025-06-28 15:31:01,912 - __main__ - INFO - Loading and preprocessing data...
2025-06-28 15:31:01,912 - data.data_loader - INFO - Loading data from multiple paths...
2025-06-28 15:31:01,913 - data.data_loader - INFO - Found 21 files in /global/cfs/cdirs/m4814/daweigao/0_trendy_case/dataset
2025-06-28 15:31:01,913 - data.data_loader - INFO - Found 63 files in /global/cfs/cdirs/m4814/daweigao/1_0.5_degree/dataset
2025-06-28 15:31:01,913 - data.data_loader - INFO - Total files to load: 84
